{"Derby": {"5": {"ground_truth": "0", "bug_report": "Network Server Protocol error when select fails and 'order by' is specified\nReporting for Army  filed on derby-dev list.If  when using the Network Server  one tries to execute a select statement that fails because of an SQL exception (ex. divide-by-zero)  and if an 'order by' clause is specified as part of the select  the server will throw a distributed protocol exception  instead of the appropriate error.Repro (using the 'ij' utility)ij&gt; connect 'jdbc:derby:net://localhost:1527/myDB:user=u;password=p;';ij&gt; create table t1 (i int  j int);0 rows inserted/updated/deletedij&gt; insert into t1 values (2 0);1 row inserted/updated/deleted&#8211; Without an 'order by' it's fine...&#8211; (22012 ==&gt; 'Attempt to divide by zero.'  which is fine)ij&gt; select {fn mod(i j)} from t1;1-----------ERROR 22012: DB2 SQL error: SQLCODE: -1  SQLSTATE: 22012  SQLERRMC: 22012&#8211; With an order by  it dies...ij&gt; select {fn mod(i j)} from t1 order by 1;ERROR 58009: Execution failed due to a distribution protocol error that caused deallocation of the conversation. A DRDA Data Stream Syntax Error was detected. Reason: 0x13NOTES:The problem is in the DRDAConnThread.java file  'processCommands(...)' method  in the 'case CodePoint.OPNQRY' block of code. In the case of an SQL exception  there's a call to 'writer.clearBuffer()' that is used to ensure that only an OPNQFLRM is sent back to the client  not the OPNQRYRM and/or QRYDSC that may have been written to buffer before the OPNQFLRM. That call to 'clearBuffer' has to be replaced with something smarter  so that instead of doing a full clear (which causes the problem shown above)  it only backs out the buffer writes that it has made since beginning the 'case CodePoint.OPNQRY' block...", "id": "5"}, "19": {"ground_truth": "0", "bug_report": "NPE when trying to create a database at a directory that is not allowed\nOpening this bug on behalf of Daniel Debrunner--------------------------------------------------------------This bug occurs in embedded Derby and Derby Network Server. In Derby Network Server  it might be best for a security exception to be thrown when trying to create a database at a disallowed directory (SQLSTATE 38000).This bug can be reproduced in IJ like so:(if your 'D' drive is an inaccessible disk. e.g. your CD-ROM)ij&gt; connect 'jdbc:derby:d:/wombat2;create=true';ERROR XJ041: Failed to create database 'd:/wombat2'", "id": "19"}, "38": {"ground_truth": "0", "bug_report": "Make LOCKS as non-reserved keyword in Derby since it is not a reserved keyword in the SQL standards\nSince LOCKS is not a reserved keyword in SQL standards  Derby should not make LOCKS as reserved keyword.", "id": "38"}, "42": {"ground_truth": "1", "bug_report": "When using encryption  do not store the length information about the external key in service.properties\nWhen using derby database encryption there is a provision to provide the key to be used for encryption as an external key. In this case the key is not stored in the database for added security. There should not be any useful information about the external key that was used for encrypting the database in the service.properties.Right now  key length is stored in service.properties. This should not be stored in service.properties.", "id": "42"}, "44": {"ground_truth": "0", "bug_report": "Support for like ? Escape ?\nRequest to have support forSelect * from foo where like ? escape ?This functionality works with other JDBC/RDBMS combos including DB2/DB2 universal driver.This functionality is beneficial for tools as well as appservers for generating the SQL from EJBQL", "id": "44"}, "45": {"ground_truth": "0", "bug_report": "Request support for CAST() in Like clause\nRequest support for CAST() in like clause for example:select t0.ID  t0.QUANTITY  t0.NAME  t0.PRICE  t0.PNUM from PRODUCTEJB_TABLE t0 where t0.NAME like CAST (? AS VARCHAR(32672))This is supported by DB2 and will ease migration between DB2 and Derby", "id": "45"}, "85": {"ground_truth": "1", "bug_report": "NPE when creating a trigger on a table and default schema doesn't exist.\nBACKGROUND:When connecting to a Derby db with a user id and password  the default schema is USER. For example  if I connect with:ij&gt; connect 'jdbc:derby:myDB;user=someUser;password=somePwd';then the default schema is 'SOMEUSER'.PROBLEM:It turns out that if a table t1 exists in a non-default schema and the default schema (in this case  'SOMEUSER') doesn't exist yet (because no objects have been created in that schema)  then attempts to create a trigger on t1 using its qualified name will lead to a null pointer exception in the Derby engine.REPRO:In ij:&#8211; Create database with default schema 'SOMEUSER'.ij&gt; connect 'jdbc:derby:myDB;create=true;user=someUser;password=somePwd';&#8211; Create table t1 in a non-default schema; in this case  call it 'ITKO'.ij&gt; create table itko.t1 (i int);0 rows inserted/updated/deleted&#8211; Now schema ITKO exists  and T1 exists in schema ITKO  but default schema SOMEUSER does NOT exist  because we haven't created any objects in that schema yet.&#8211; So now we try to create a trigger in the ITKO (i.e. the non-default) schema...ij&gt; create trigger trig1 after update on itko.t1 for each row mode db2sql select * from sys.systables;ERROR XJ001: Java exception: ': java.lang.NullPointerException'.A look at the derby.log file shows the stack trace given below. In a word  it looks like the 'compilation schema' field of SYS.SYSTRIGGERS isn't getting set  and so it ends up being null. That causes the NPE in subsequent processing...java.lang.NullPointerException at org.apache.derby.impl.sql.catalog.SYSSTATEMENTSRowFactory.makeSYSSTATEMENTSrow(SYSSTATEMENTSRowFactory.java:200) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addSPSDescriptor(DataDictionaryImpl.java:2890) at org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.createSPS(CreateTriggerConstantAction.java:354) at org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.executeConstantAction(CreateTriggerConstantAction.java:258) at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:56) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:366) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1100) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:509) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:467) at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:299) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:433) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:310) at org.apache.derby.impl.tools.ij.Main.go(Main.java:210) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:176) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:56) at org.apache.derby.tools.ij.main(ij.java:60)", "id": "85"}, "88": {"ground_truth": "0", "bug_report": "RunSuite summary rounds incorrectly\nExample output from RunSuite in the report file203 Tests Run100% Pass (202 tests passed) 0% Fail (1 tests failed)A single failure should not lead to 0% fail and 100% pass.Should round down on pass percentage and round up on fail percentage.", "id": "88"}, "90": {"ground_truth": "0", "bug_report": "dblook displays message keys instead of their associated text\nUsing Derby version 10.0.2.1 - (106978)  when I execute java org.apache.derby.tools.dblookinstead of getting the usage message  I get CSLOOK_UsageSimilarly  when using dblook to generate database schema  the output text contains keys such as the one above  instead of their associated text. e.g.&#8211; CSLOOK_Timestamp  &lt;2004-12-04 19:22:57.038&gt;&#8211; CSLOOK_DBName  &lt;sample&gt;&#8211; CSLOOK_DBUrl  &lt;jdbc:derby:sample&gt;&#8211; appendLogs: false&#8211; ----------------------------------------------&#8211; CSLOOK_SchemasHeader&#8211; ----------------------------------------------CREATE SCHEMA 'SAMP';&#8211; ----------------------------------------------&#8211; CSLOOK_TablesHeader&#8211; ----------------------------------------------CREATE TABLE 'SAMP'.'IN_TRAY' ('RECEIVED' TIMESTAMP  'SOURCE' CHAR(8)  'SUBJECT' CHAR(64)  'NOTE_TEXT' VARCHAR(3000));", "id": "90"}, "94": {"ground_truth": "0", "bug_report": "Lock not being released properly  possibly related to occurence of lock escalation\nIn the following scenario: &lt;code snippet&gt; String sel = 'select * from t1 FOR UPDATE of i2'; PreparedStatement ps1 = conn.prepareStatement (sel); int val = 300; ps1.setMaxRows(val); ResultSet rs = ps1.executeQuery(); String ins = 'Update t1 set i2=? WHERE CURRENT OF '+rs.getCursorName() ; PreparedStatement ps2 = conn.prepareStatement(ins); ps2.setInt(1 iteration); while(rs.next()) { ps2.executeUpdate(); }; // print lock table information System.out.println('Lock Table before commit transaction'); printLockTable(conn); conn.commit();&lt;end code snippet&gt;Running the above transaction twice causes a lock timeout the second time.It seems like locks are not being released properly on the table even after the transaction commits and the connection is closed. Also  this condition seems to happen only when lock escalation to table lock occurs. By increasing lock escalation threshold to prevent lock escalation and with only row level locking  the locks are released properly.I printed out the locks information and see a U row level lock on the table   and also a table level lock as a result of lock escalation. After commit  and resultset being closed  the U row level lock is not released. Thus in the second iteration of the test  the unreleased U row level lock causes a lock timeout to happen. In case of the second iteration of the test  the lock table shows the previous U row lock with a null transaction id. This is not right. The transactions are running at the default isolation level ( read committed).By default  the lock escalation threshold is set to 5000http://incubator.apache.org/derby/manuals/tuning/perf80.html#IDX547I will be attaching the program for reproduction. To reproduce the problem with less number of rows in the table  please run the program with the following derby properties set derby.locks.deadlockTrace=truederby.locks.escalationThreshold=110", "id": "94"}, "100": {"ground_truth": "0", "bug_report": "Add support for insert functionality using JDBC 2.0 updatable resultset apis\nThe JDBC 2.0 API introduced the ability to update/delete/insert rows from a resultset using methods in the Java programming language rather than having to send an SQL command. This Jira entry is to track the insert rows functionality using JDBC 2.0 apis.", "id": "100"}, "117": {"ground_truth": "0", "bug_report": "[PATCH] Improvements on the NetServlet\nHi all I did some minor enhancements on the Net Servlet: changed Cloudscape to Derby in the i18n bundles added pt_BT to know languages (the bundle was already there  but the language was not set at the .java)  improved use of tracingDirectory: init-parameter is now used (it was documented but not used before) current value is shown when the user try to change it improved function that handles the request locale (for instance  mozilla uses a - instead of _ to separate the country from language) shows on the screen which port the server is running on added a new SRV_POrtNumber message key for such infoSo  I'm sending a trunk patch with such changes.&#8211; Felipe", "id": "117"}, "122": {"ground_truth": "0", "bug_report": "Suite jdk14 is skipped incorrectly with J2SE 5.0\nSince J2SE 5.0 is a super set of JDK 1.4  and JDK1.4 tests should run in J2SE5.0", "id": "122"}, "123": {"ground_truth": "0", "bug_report": "Derby incorrectly rounds double values down during insert into NUMERIC\nWhen inserting a double value into a field defined as NUMERIC(a b) using PreparedStatement.setDouble()  Derby may incorrectly round the number down. For example  a NUMERIC(5 2) field with a double = 4.64 ends up with a value of 4.63 in the database. This works fine in Oracle and other databases.The problem occurs because double cannot represent 4.64 exactly  so the actual value is 4.6399999... SQLDecimal.setCoreValue uses BigDecimal(double) which constructs a BigDecimal of 4.6399999... and then SQLDecimal.setWidth uses value.setScale(desiredScale  BigDecimal.ROUND_DOWN); Note that BigDecimal javadoc recommends that the double constructor be avoided for this reason.One fix appears to be to change SQLDecimal.setCoreValue(double) to avoid using the double constructor of BigDecimal. Using Double.toString() and BigDecimal(String) looks as if it would work as expected  because Double.toString() has 'special rounding abilities' and converts 4.639999... back to 4.64.", "id": "123"}, "127": {"ground_truth": "0", "bug_report": "Aliased Columns not recognized after 'group by... order by' combination\nI've been doing work to try and integrate Derby with the Mondrian ROLAP engine  which has uncovered a bug in Derby when a query involves column aliasing  a group by clause  and an order by clause.For example: Mondrian will generate the following query:select STORE.STORE_COUNTRY as c0  STORE.STORE_STATE as c1  STORE.STORE_CITY as c2  STORE.STORE_NAME as c3  STORE.STORE_TYPE as c4  STORE.STORE_MANAGER as c5  STORE.STORE_SQFT as c6  STORE.GROCERY_SQFT as c7  STORE.FROZEN_SQFT as c8  STORE.MEAT_SQFT as c9  STORE.COFFEE_BAR as c10  STORE.STORE_STREET_ADDRESS as c11 from STORE as STORE group by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAME  STORE.STORE_TYPE  STORE.STORE_MANAGER  STORE.STORE_SQFT  STORE.GROCERY_SQFT  STORE.FROZEN_SQFT  STORE.MEAT_SQFT  STORE.COFFEE_BAR  STORE.STORE_STREET_ADDRESS order by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAMEwhich should be valid SQL. I have tested this query outside of the Mondrian environment and still receive the same error which is:'Column 'STORE.STORE_COUNTRY' is not in any table in the FROM list or it appears within a join specification and is outside the scope of the join specification or it appears in a HAVING clause and is not in the GROUP BY list.SQL State: 42x04Error Code: 30000However  if I remove any one of the three elements (aliasing  group by  order by) or if the order by uses the aliased names  the query works. It is only the combination of all 3 elements that is causing a problem.&#91;ie. all of the following queries work correctly&#93;select STORE.STORE_COUNTRY   STORE.STORE_STATE   STORE.STORE_CITY   STORE.STORE_NAME   STORE.STORE_TYPE   STORE.STORE_MANAGER   STORE.STORE_SQFT   STORE.GROCERY_SQFT   STORE.FROZEN_SQFT   STORE.MEAT_SQFT   STORE.COFFEE_BAR   STORE.STORE_STREET_ADDRESS from STORE as STORE group by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAME  STORE.STORE_TYPE  STORE.STORE_MANAGER  STORE.STORE_SQFT  STORE.GROCERY_SQFT  STORE.FROZEN_SQFT  STORE.MEAT_SQFT  STORE.COFFEE_BAR  STORE.STORE_STREET_ADDRESS order by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAMEselect STORE.STORE_COUNTRY as c0  STORE.STORE_STATE as c1  STORE.STORE_CITY as c2  STORE.STORE_NAME as c3  STORE.STORE_TYPE as c4  STORE.STORE_MANAGER as c5  STORE.STORE_SQFT as c6  STORE.GROCERY_SQFT as c7  STORE.FROZEN_SQFT as c8  STORE.MEAT_SQFT as c9  STORE.COFFEE_BAR as c10  STORE.STORE_STREET_ADDRESS as c11 from STORE as STORE group by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAME  STORE.STORE_TYPE  STORE.STORE_MANAGER  STORE.STORE_SQFT  STORE.GROCERY_SQFT  STORE.FROZEN_SQFT  STORE.MEAT_SQFT  STORE.COFFEE_BAR  STORE.STORE_STREET_ADDRESSselect STORE.STORE_COUNTRY as c0  STORE.STORE_STATE as c1  STORE.STORE_CITY as c2  STORE.STORE_NAME as c3  STORE.STORE_TYPE as c4  STORE.STORE_MANAGER as c5  STORE.STORE_SQFT as c6  STORE.GROCERY_SQFT as c7  STORE.FROZEN_SQFT as c8  STORE.MEAT_SQFT as c9  STORE.COFFEE_BAR as c10  STORE.STORE_STREET_ADDRESS as c11 from STORE as STORE order by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAMEselect STORE.STORE_COUNTRY as c0  STORE.STORE_STATE as c1  STORE.STORE_CITY as c2  STORE.STORE_NAME as c3  STORE.STORE_TYPE as c4  STORE.STORE_MANAGER as c5  STORE.STORE_SQFT as c6  STORE.GROCERY_SQFT as c7  STORE.FROZEN_SQFT as c8  STORE.MEAT_SQFT as c9  STORE.COFFEE_BAR as c10  STORE.STORE_STREET_ADDRESS as c11 from STORE as STORE group by STORE.STORE_COUNTRY  STORE.STORE_STATE  STORE.STORE_CITY  STORE.STORE_NAME  STORE.STORE_TYPE  STORE.STORE_MANAGER  STORE.STORE_SQFT  STORE.GROCERY_SQFT  STORE.FROZEN_SQFT  STORE.MEAT_SQFT  STORE.COFFEE_BAR  STORE.STORE_STREET_ADDRESS order by c0 c1 c2 c3", "id": "127"}, "128": {"ground_truth": "1", "bug_report": "Network Server Gives NPE if SQLException has null arguments   (e.g. for ERROR XBM0H)\nNetwork server  Network Server throws an NPE because one of the arguments of the SQLException is null. It shouldn't do so.To reproduce try to create a database in the root directory on Linux. Do not run in security manager. The trace below came from an extra '/' in the url in NSinSameJVM.javaThe issues are:1) Network Server throws an NPE because one of the arguments of the SQLException is null in this code. It shouldn't do so.// arguments are variable part of a message Object[] args = ce.getArguments(); for (int i = 0; args != null &amp;&amp; i &lt; args.length; i++) sqlerrmc += args&#91;i&#93;.toString() + separator;2) This exception seems to have null arguments which doesn't seem right. ERROR XBM0H: Directory /NSinSameJVMTestDB cannot be created.ERROR XBM0H: Directory /NSinSameJVMTestDB cannot be created. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:322) at org.apache.derby.impl.services.monitor.PersistentServiceImpl$8.run(PersistentServiceImpl.java:668) at java.security.AccessController.doPrivileged(Native Method) at org.apache.derby.impl.services.monitor.PersistentServiceImpl.createServiceRoot(PersistentServiceImpl.java:632) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1756) at org.apache.derby.impl.services.monitor.BaseMonitor.createPersistentService(BaseMonitor.java:1018) at org.apache.derby.iapi.services.monitor.Monitor.createPersistentService(Monitor.java:578) at org.apache.derby.impl.jdbc.EmbedConnection.createDatabase(EmbedConnection.java:1504) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:215) at org.apache.derby.impl.jdbc.EmbedConnection20.&lt;init&gt;(EmbedConnection20.java:56) at org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:72) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:73) at org.apache.derby.jdbc.Driver169.connect(Driver169.java:175) at org.apache.derby.impl.drda.Database.makeConnection(Database.java:245) at org.apache.derby.impl.drda.DRDAConnThread.getConnFromDatabaseName(DRDAConnThread.java:1160) at org.apache.derby.impl.drda.DRDAConnThread.verifyUserIdPassword(DRDAConnThread.java:1138) at org.apache.derby.impl.drda.DRDAConnThread.parseSECCHK(DRDAConnThread.java:2613) at org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(DRDAConnThread.java:1001) at org.apache.derby.impl.drda.DRDAConnThread.exchangeServerAttributes(DRDAConnThread.java:950) at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(DRDAConnThread.java:563) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:219)Cleanup action completed2005-01-21 01:12:12.794 GMT Thread&#91;DRDAConnThread_2 5 derby.daemons&#93; (DATABASE = /NSinSameJVMTestDB)  (DRDAID = {2})  Failed to create database '/NSinSameJVMTestDB'  see the next exception for details.2005-01-21 01:12:12.795 GMT Thread&#91;DRDAConnThread_2 5 derby.daemons&#93; (DATABASE = /NSinSameJVMTestDB)  (DRDAID = {2})  Directory /NSinSameJVMTestDB cannot be created.2005-01-21 01:12:12.816 GMT Thread&#91;DRDAConnThread_2 5 derby.daemons&#93; (DATABASE = /NSinSameJVMTestDB)  (DRDAID = NF000001.A9FB-4124733202448020360{2})  Failed to create database '/NSinSameJVMTestDB'  see the next exception for details.2005-01-21 01:12:12.816 GMT Thread&#91;DRDAConnThread_2 5 derby.daemons&#93; (DATABASE = /NSinSameJVMTestDB)  (DRDAID = NF000001.A9FB-4124733202448020360{2})  nullnulljava.lang.NullPointerException at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCAGRP(DRDAConnThread.java:5076) at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARD(DRDAConnThread.java:4882) at org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(DRDAConnThread.java:1042) at org.apache.derby.impl.drda.DRDAConnThread.exchangeServerAttributes(DRDAConnThread.java:950) at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(DRDAConnThread.java:563) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:219)nulljava.lang.NullPointerException at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCAGRP(DRDAConnThread.java:5076) at org.apache.derby.impl.drda.DRDAConnThread.writeSQLCARD(DRDAConnThread.java:4882) at org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(DRDAConnThread.java:1042) at org.apache.derby.impl.drda.DRDAConnThread.exchangeServerAttributes(DRDAConnThread.java:950) at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(DRDAConnThread.java:563) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:219)", "id": "128"}, "129": {"ground_truth": "0", "bug_report": "Derby should throw a truncation error or warning when CASTing a parameter/constant to char or char for bit datatypes and the data is too large for the datatype.\nDerby doesn't throw a truncation exception/warning when data is too large during casting of constants or parameters to character string or bit string data types. Following is ij example for constants which is too big for the datatype it is getting cast toij&gt; values (cast ('hello' as char(3)));1hel1 row selectedij&gt; values (cast (X'0102' as char(1) for bit data));1011 row selectedFollowing code snippet is when using parameters through a JDBC program s.executeUpdate('create table ct (c CLOB(100K))'); //the following Formatters just loads cData with 32700 'c' characters String cData = org.apache.derbyTesting.functionTests.util.Formatters.repeatChar('c' 32700); //notice that ? in the preared statement below is bound to length 32672 pSt = con.prepareStatement('insert into ct values (cast (? as varchar(32672)))'); pSt.setString(1  cData); //Derby doesn't throw an exception at ps.execute time for 32700 characters into 32672 parameter. It silently truncates it to 32672 pSt.execute();", "id": "129"}, "132": {"ground_truth": "0", "bug_report": "in place table/index compress which returns space to OS\nEach derby table or index is stored in a separate file. Space fromdeleted rows is eventually reclaimed within the file as is used forsubsequent inserts into the same file. That space is not returned tothe OS unless the user calls the SYSCS_UTIL.SYSCS_COMPRESS_TABLEsystem procedure. That procedure will return the unused space inthe tables and indexes to the OS. It gets an exclusive lock on thetable  copies all rows in the indexes and the base table into newcompressed files and delete the old files. Prior to jdk 1.4 this wasthe only way to return space from a file to the OS.In jdk 1.4 RandomAccessFile was enhanced to allow the truncation of afile  which would return the space at the 'end' of the file back tothe OS. In order to take advantage of this new feature a newcompress feature is needed in derby.The assumption is that this work will be used in future work which willautomatically schedule this job and others in background  with nointeraction needed from the dba. The 1st phase of this work willsimply build a procedure that will do the work. The 2nd phase willbe to look into scheduling the procedure automatically as part ofthe current background post commit processing. Longer term it wouldbe best if this fit into a new background task monitor  which couldschedule larger background tasks balanced against the other prioritiesof the system. These tasks might include: this new online compress automatic statistics gathering  more proactive deleted row reclamation  ....The proposed feature will reorganize base tables and indexes  movingempty pages to the 'end'. It will release space back to the operatingsystem when it has created a chunk of empty pages at the end of thefile. It will be designed to run in background  and will lock resourcesof the table for as short a time as possible so that it can iterativelyprocess the table.To reclaim space in the heap  it will scan the heap in page reverse order.It will get a short term table lock  process all the rows on a page  andthen commit that transaction releasing the lock. The commit will beoptimized like other internal transactions  and will not need to waitfor a synchonized write. Each row moved  will require all the indexentries for that row to also be updated. While doing the processing itwill also take care of processing committed deleted rows. When spaceis free at the end of the table it will be freed back to the operatingsystem  using the RandomAccessFile.setLength() interface.To reclaim space in the btree  data on pages will be moved rather thanrows. Data from pages at the end of the file will be moved to freesmaller numbered pages. Again short term table locks will be required and the operation will look similar to the current btree merge operationsalready implemented. Again when a chunk of pages is free at the end ofthe file  they will be returned to the OS using the same mechanism asthe heap.", "id": "132"}, "153": {"ground_truth": "0", "bug_report": "Bad Eclipse plugin version specification\nIn the plugin.xml of the Derby Eclipse plugin  the version specification reads '10.1.0.0 (124830)'  which Eclipse complains about as being illegal. In consequence  the plugin is not loaded.The Eclipse docs have the following to say about the version specification: 'Plug-in version format is major.minor.service.qualifier'.Stripping the '(1234830)'  whatever that is anyway  solves the problem.", "id": "153"}, "167": {"ground_truth": "0", "bug_report": "Inserting values in an identity column\nIt is not possible to insert a specific value in a column defined as identity. This makes it very hard to migrate from other RDBMSs or to import data dumped from other databases. For example  an autoincrement column in MySQL should be an identity column. The problem is that when the data is dumped from MySQL to a file  it generates inserts with values. These values cant be inserted in the Derby table. Posible solutions: 1. being able to 'generate by default as identity' 2. being able to disable the 'identity' feature for a column 3. being able to generate a column as non identity and after data is populated  alter table to add the 'identity' to the column.", "id": "167"}, "173": {"ground_truth": "0", "bug_report": "For the concurrency of ResultSet  Network Server should not send the concurrency of Statement.\nI am working on getting updatable resulset functionality to work under Network Server. One issue that I found is Network Server sends the concurrency of the Statement object when it really needs to send the concurrency of the Resultset. This was ok in the past because CONCUR_READ_ONLY was the only concurreny supported by Derby. But  now with the support of CONCUR_UPDATABLE  it is possible that the concurrency of ResultSet might not be same as the Statement object. Hence  Network Server should send the concurrency of the ResultSet object if that is what the protocol calls for.The fix for this is localized in java/drda/org/apache/derby/impl/drda/DRDAConnThread.java.", "id": "173"}, "174": {"ground_truth": "0", "bug_report": "setNull does not work with java.sql.Types.TIMESTAMP\nCalling setNull(x java.sql.Types.TIMESTAMP) throws an exception with the following message.( x is the column number)Message is: ' An attempt was made to get a data value of type 'TIMESTAMP' from a data value of type 'null''.", "id": "174"}, "183": {"ground_truth": "0", "bug_report": "Parameter names required in CREATE FUNCTION\nA statement like create function s2.f2( char(8)  integer) returns int language java parameter style java external name 'myclass.mymethod'fails with the message ERROR 42X01: Syntax error: Encountered 'char' at line 1  column 24However create function s2.f2( p1 char(8)  p2 integer) returns int language java parameter style java external name 'myclass.mymethod'is accepted.The Derby documentation (at http://incubator.apache.org/derby/manuals/reference/sqlj27.html#CREATE+PROCEDURE+Statement)  the SQL2003 standard  and DB2 all agree that the parameter name is optional.", "id": "183"}, "184": {"ground_truth": "0", "bug_report": "List of jar files in tools/java incorrect in BUILDING.txt\nSection 2 of BUILDING.txt describes how to obtain JDK 1.4  JDK 1.3  JDBC 2.0 extensions  JCE  OSGI. But then it says you should have the following jars:${derby.source}/tools/java/javacc.jar${derby.source}/tools/java/jakarta-oro-2.0.8.jar${derby.source}/tools/java/jce1_2_2.jar${derby.source}/tools/java/jdbc2_0-stdext.jar${derby.source}/tools/java/jta-1_0_1B-classes.zip${derby.source}/tools/java/servlet.jar${derby.source}/tools/java/osgi.jarActually  what you have is the following:empty.jargeronimo-spec-jta-1.0.1B-rc4.jargeronimo-spec-servlet-2.4-rc4.jarjakarta-oro-2.0.8.jarjavacc.jarjce1_2_2.jarjdbc2_0-stdext.jarosgi.jarI am providing a patch with this correction.", "id": "184"}, "186": {"ground_truth": "0", "bug_report": "isFirst() returns true when relative(x) goes beyond result set\nBizarre error. Not sure if this is a JDBC  Derby  or Java issue.An opened result set has 4 records. A call to relative(3) while on row 3 should result in isAfterLast=true  and isFirst  isBeforeFirst  and IsLast set to false. However  the result is isAfterLast=True and isFirst=True.ij connect 'IsAfter;create=true';create table x (a char(1)); insert into x values '1' '2' '3' '4';quit;import java.sql.*; public class ErrIsFirst { public static void main(String argv[]) throws SQLException { Connection conn = null; Statement s = null; ResultSet rs = null; String DerbyDriver = 'org.apache.derby.jdbc.EmbeddedDriver'; String returnValue; try { Class.forName(DerbyDriver).newInstance(); } catch (Exception NoDriver) { System.out.println('Derby driver not found: ' + DerbyDriver); NoDriver.printStackTrace(); System.exit(1); } try { conn = DriverManager.getConnection('jdbc:derby:IsAfter'); s = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE ResultSet.CONCUR_READ_ONLY); rs = s.executeQuery( 'SELECT A FROM X'); rs.next(); // First Record returnValue = rs.getString('A'); System.out.println('Value='+returnValue); rs.relative(2); System.out.println('isFirst=' + rs.isFirst() + ' isLast=' + rs.isLast() + ' isAfterLast=' + rs.isAfterLast()); returnValue = rs.getString('A'); System.out.println('Value='+returnValue); rs.relative(-2); returnValue = rs.getString('A'); System.out.println('Value='+returnValue); rs.relative(10); System.out.println('isFirst=' + rs.isFirst() + ' isLast=' + rs.isLast() + ' isAfterLast=' + rs.isAfterLast()); returnValue = rs.getString('A'); System.out.println('Value='+returnValue); rs.close(); s.close(); } catch (SQLException se) { String SQLState = se.getSQLState(); String SQLMessage = se.getMessage(); System.out.println('Error = '+SQLState); System.out.println(SQLMessage); } }}The results on my system are:Value=1isFirst=false isLast=false isAfterLast=falseValue=3Value=1isFirst=true isLast=false isAfterLast=trueError = 24000Invalid cursor state - no current row.If you eliminate the first println call to isFirst() you get the following (correct) results.Value=1Value=3Value=1isFirst=false isLast=false isAfterLast=trueError = 24000Invalid cursor state - no current row.Okay  so where did we go wrong?", "id": "186"}, "198": {"ground_truth": "1", "bug_report": "Add Support for network Server USRIDONL security\nCurrently Network Server supports only two security mechanisms.User ID and password (usridpwd)User ID and encrypted password (eusridpwd)It would be good to add support for User ID Only security so that it could more closely match the embedded driver and not always require a password.See details of security mechanism implementations in section 4.4.2.1 of DRDA V3 Vol. 1: Distributed Relational Database Architecture http://www.opengroup.org/dbiop/", "id": "198"}, "203": {"ground_truth": "0", "bug_report": "setNull(x JDBCType.DATE) does not work when batching is turned on\nTrying to execute batch on which setNull(x DATE) was called gives the following exception:SQL Exception: An attempt was made to get a data value of type 'DATE' from a data value of type 'null'. at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java) at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(EmbedConnection.java) at org.apache.derby.impl.jdbc.ConnectionChild.newSQLException(ConnectionChild.java) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.dataTypeConversion(EmbedPreparedStatement.java) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.setObject(EmbedPreparedStatement.java) at org.apache.derby.iapi.types.DataType.setInto(DataType.java) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(EmbedPreparedStatement.java) at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(EmbedStatement.java) at net.sf.hibernate.impl.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:54)DATE column is nullable in db schema  so it should pass there ok. I believe the problem is in org.apache.derby.iapi.types.SQLDate  which does not implement setInto method  so DataType.setInto method is executed  calling setObject(x null). setObject thinks this is JDBC spec violation and fails on exception.Problem exists in both 10.0.2.1 and 10.0.2.0", "id": "203"}, "212": {"ground_truth": "0", "bug_report": "Optimize some specific methods in Network Server to improve performance\nIn reviewing the Network Server Code and profiling there were several areas that showed potential for providing performance improvement.Functions that need optimizing to prevent unneeded object creation and excessive decodingparsePKGNAMCSN()parseSQLDTA_work()buildDB2CursorName()In DDMWriter and DDMReader  use System Routines in java.util.Arrays and System.arrayCopy instead of writing code to do functions like copy arrays and pad strings.", "id": "212"}, "220": {"ground_truth": "0", "bug_report": "Javadoc build should include a timestamp and/or the svn revision number in a visible location.\nIn order to easily identify when a specific set of javadoc was built  and from what source  it would be useful to include a timestamp and/or the svn revision number at the time the javadoc is built. The footer is an excellent location to place this information  as it is visible on every generated page.", "id": "220"}, "229": {"ground_truth": "0", "bug_report": "Column names on ResultSet.updateXXX and getXXX methods are handled incorrectly\nSections 14.2.3 and &#91;14.2.3&#93; of JDBC 3.0 spec sayColumn names supplied to getter &#91;updater&#93; methods are case insensitive. If a select listcontains the same column more than once  the first instance of the column will bereturned &#91;updated&#93;.Derby returns or updates the last column in the select list  not the first. With the attached Java class I seePRE-UPDATE1 100POST-UPDATE1 500POST-UPDATE getXXX(name)AB:500 ab500", "id": "229"}, "230": {"ground_truth": "0", "bug_report": "'Schema already exists' when creating a table\nWhen running a multithreaded program where several threads in parallell create tables in a schema that is not explicitly created  one often get the following exception:ERROR X0Y68: Schema 'TESTSCHEMA' already exists. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:322) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.duplicateDescriptorException(DataDictionaryImpl.java:1512) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptorNow(DataDictionaryImpl.java:1496) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptor(DataDictionaryImpl.java:1478) at org.apache.derby.impl.sql.execute.CreateSchemaConstantAction.executeConstantAction(CreateSchemaConstantAction.java:147) at org.apache.derby.impl.sql.execute.DDLConstantAction.getSchemaDescriptorForCreate(Unknown Source) at org.apache.derby.impl.sql.execute.CreateTableConstantAction.executeConstantAction(CreateTableConstantAction.java:213) at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:56) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:366) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1108) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:475) at derbytest.Main$CreateTable.run(Main.java:42) at java.lang.Thread.run(Thread.java:595)A program that reproduces this bug will be attached.", "id": "230"}, "231": {"ground_truth": "0", "bug_report": "'FOR UPDATE' required for updatable result set to work\nTo get an updatable result set  the JDBC 3.0 spec  section 14.2.4 'Modifying ResultSet Objects' states:  'ResultSet objects with concurrency CONCUR_UPDATABLE can be updated using ResultSet objects'.In addition  Derby requires the SQL SELECT statement to have a 'FORUPDATE' clause for updates to be allowed. This may be a usability issue  asmany examples  e.g. in 'JDBC API tutorial and reference and reference'book and the JDBC 3.0 Specification (14.2.4.1) do not include a 'FORUPDATE' clause in the SQL SELECT.Mamta Satoor says:'Derby implements the JDBC updatable resultset by using the existing updatable cursor implementation. And in order to do that  it requires that the SELECT statement should include the FOR UPDATE clause. One can change the Derby implementation so that it does not require FOR UPDATE clause to piggyback on updatable cursor implementation.'Dan DeBrunner says:'Technically I wonder if this is covered by the JDBC standard  I see nothing in the JDBC 3.0 that states any requirements for the SQL statement for an updateable result set. I know the JDBC tutorial book has some guidelines as to what will typically work  but isn't it up to the database engine to define what works here? Having said that I think that not requiring the FOR UPDATE would be a useful improvement.'", "id": "231"}, "233": {"ground_truth": "0", "bug_report": "Fix copyright notices and other IBM/Cloudscape references in java/demo/*\nAssigning this issue to 'Documentation' component  as there is not a Demos component.", "id": "233"}, "238": {"ground_truth": "1", "bug_report": "Testharness: testEncryptionAlgorithm property is not being picked up correctly for some encryption suites\nIt looks like the encryption.properties - testEncryptionAlgorithm=DESede/CBC/NoPadding is not being picked up for the encryption run of stress.multi test. But the test uses a database with the default encryption algorithm - DES/CBC/NoPadding", "id": "238"}, "239": {"ground_truth": "0", "bug_report": "Need a online backup feature  that does not block update operations   when online backup is in progress.\nCurrently Derby allows users to perfoms online backups using SYSCS_UTIL.SYSCS_BACKUP_DATABASE() procedure  but while the backup is in progress  update operations are temporarily blocked  but read operations can still proceed.Blocking update operations can be real issue specifically in client server environments  because user requests will be blocked for a long time if a backup is in the progress on the server.", "id": "239"}, "243": {"ground_truth": "0", "bug_report": "connection toString should uniquely identify the connection\nThe toString() on the Derby connection doesn't print unique information.for example System.out.println(conn) prints:EmbedConnection in the case of derby embeddedIt would be great if the toString() method for connections could be used to differentiate one connection from another.", "id": "243"}, "247": {"ground_truth": "0", "bug_report": "Network Server demo program should support Derby network client driver\nCurrently  the Network Server demo programs require the IBM Universal JDBC Driver (JCC) for client functionality. The demo should be enhanced to also support using the Derby client driver.", "id": "247"}, "249": {"ground_truth": "1", "bug_report": "Builds fail during splitmessages step if path contains spaces\nIf the path to the Derby source files contains a space  for example /opt/My Local Drive/derbysource  then the build will fail at the splitmessages step with the following error: &#91;java&#93; Exception in thread 'main' java.lang.StringIndexOutOfBoundsException: String index out of range: -1 &#91;java&#93; at java.lang.String.substring(String.java:1444) &#91;java&#93; at org.apache.derbyBuild.splitmessages.main(splitmessages.java:44)splitmessages should be improved to handle spaces in the path to the message files.", "id": "249"}, "266": {"ground_truth": "0", "bug_report": "test tools/dblook_test.java fails if run in a directory having '*derby/*' in its path\nSYMPTOM: The test 'tools/dblook_test' will fail. The diff looks similar to this:     Start: dblook_test jdk1.4.2_02 derbyall:derbytools 2005-05-06 22:37:37 ***4861d4860&lt; java.io.FileNotFoundException: &lt;filePath&gt;Test Failed. End: dblook_test jdk1.4.2_02 derbyall:derbytools 2005-05-06 22:37:53 ***    cf mail thread:http://mail-archives.apache.org/mod_mbox/db-derby-dev/200505.mbox/%3c20050507140048.GB690@ac30.fr34.2y.net%3eANALYSIS: The problem lies with the sedfunctionality in the test harness  which delete certain lines beforecomparing with the master file.Sed.java in the harness removes lines containing derby/ in the path viz: deleteLines.addElement('^.derby/.//&lt;.//&gt;//(.).*$');  deleteLines.addElement('^.derby/.//(.).$'); so if your tests are running in a directory containing this pattern  aline too much is deleted from dblook_test.tmp  thereby giving acomparison failure like you describe.I don't know the reason for this deletion yet  so I can't say how tofix it  but the work-around is obvious: Run test in a directory whosename does not contain this pattern", "id": "266"}, "269": {"ground_truth": "0", "bug_report": "Provide some way to update index cardinality statistics (e.g. reimplement update statistics)\nPerformance problems are being reported that can be resolved by updating the cardinality statistics used by the optimizer. Currently the only time the statistics are guaranteed to be an up-to-date is when the index is first created on a fully populated table. This is most easily accomplished on an existing table by using the command:  alter table &lt;table-name&gt; compress &#91;sequential&#93; Compress table is an I/O intensive task. A better way to achieve this would be to re-enable parser support for the 'update statistics' command or re-implement the update in some other fashion.", "id": "269"}, "313": {"ground_truth": "0", "bug_report": "testing/README.htm property descriptions: testSpecialProps wrongly named; useprocess omitted\nIn section 4.12 in ../testing/README.htm  the property  TestSpecialFlags is described for specifying additional properties to RunTest. I could notfind any evidence of this in RunTest or elsewhere. However  the property testSpecialPropsis supported by RunTest.java. I found this to work. This propertyalso has a syntax for specifying more than one property using a '^'delimiter between properties  i.e. testSpecialProps=&lt;prop-1&gt;=&lt;value-1&gt;^ ... ^&lt;prop-n&gt;=&lt;value-n&gt;Also I noticed the property 'useprocess' (default=true) for controllingwhether RunTest runs the test in a separate vm or a thread in currentvm isn't documented in README.htm. I suggest it be included  sinceit's potentially useful for debugging tests. I could include it in thepatch for derby-313 (I don't think anybody committed it yet) or file anew JIRA issue.Looking at RunTest reveals that unit tests are not (yet) runnable with'useprocess=false'  though.", "id": "313"}, "318": {"ground_truth": "1", "bug_report": "SYS.SYSCOLUMN problem with 'GENERATED BY DEFAULT' column w/ Network Server\nWhen connected to the Derby Network Server  if one has a table with a column defined as 'GENERATED BY DEFAULT' and then one tries to select the 'COLUMNDEFAULT' field from SYS.SYSCOLUMNS  the result is an NPE in the server code that leads to connection deallocation.I don't know if this is a problem with the 'GENERATED BY DEFAULT' feature or if it's a problem with Network Server--more investigation is required.To reproduce  use ij to connect to a database using Network Server  and then:ij&gt; create table t1 (i int generated by default as identity);0 rows inserted/updated/deletedij&gt; select columndefault from sys.syscolumns;COLUMNDEFAULT--------------------------------------------------------------------------------------------------------------------------------nulljava.lang.NullPointerException at org.apache.derby.impl.drda.DRDAConnThread.writeFdocaVal(DRDAConnThread.java:6550) at org.apache.derby.impl.drda.DRDAConnThread.writeFDODTA(DRDAConnThread.java:5973) at org.apache.derby.impl.drda.DRDAConnThread.writeQRYDTA(DRDAConnThread.java:5796) at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:595) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:226)agentThread&#91;DRDAConnThread_2 5 main&#93;ERROR 58009: Execution failed due to a distribution protocol error that caused deallocation of the conversation. A DRDA Data Stream Syntax Error was detected. Reason: 0x3", "id": "318"}, "322": {"ground_truth": "0", "bug_report": "Remove resultSetHoldability property from ClientDataSource\nClientDataSource (through ClientBaseDataSource) implements a Java Bean property resultSetHoldability which is not documented in the functional spec at.http://incubator.apache.org/derby/papers/DerbyClientSpec.htmlJDBC provides standard ways to set the holdability of ResultSets  so a non-standard separate mechanism is not required. The property and associated code needs to be removed.", "id": "322"}, "324": {"ground_truth": "1", "bug_report": "AES encryption test fails on Solaris 10\nThe store/aes.sql test on Solaris 10 produces the following diff report:     Start: aes jdk1.4.2_02 2005-05-30 12:13:17 ***206 del&lt; ERROR XJ001: Java exception: 'Wrong keysize: must be equal to 128  192 or 256: java.security.InvalidParameterException'.206a206&gt; ERROR XJ001: Java exception: 'AES key length must be 128  192  or 256 bits: java.security.InvalidParameterException'.Test Failed. End: aes jdk1.4.2_02 2005-05-30 12:14:06 ***    The cause of this problem is that on most OSs  the java.security.InvalidParameterException thrown by the JVM when an invalid encryption key length is requested contains a message with the following text: Wrong keysize: must be equal to 128  192 or 256while on Solaris 10 the message contained in the exception has been changed to: AES key length must be 128  192  or 256 bitsThe reason for this is most likely that a different encryption library is included in Solaris 10 comparedto the other OSs  either as part of the JVM or as a native library.The problem occurs on Solaris 10 running on both x86 and Sparc processors. It occurs both with jdk 1.4 and jdk 1.5.", "id": "324"}, "330": {"ground_truth": "0", "bug_report": "Many files do not have correct svn-properties\nThere are two problems with svn properties in Derby:1) A number of non-binary files do not have the svn:eol-style=native property set. Some of these currently has CRLF (Windows-style) line terminators  Example:dt136804@atum10~/local/DERBY/d_rby-138$ file ./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/popup/actions/RemoveDerbyNature.java./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/popup/actions/RemoveDerbyNature.java: ASCII C program text  with CRLF line terminatorsdt136804@atum10~/local/DERBY/d_rby-138$ svn proplist -v ./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/popup/actions/RemoveDerbyNature.javawhereas others have LF(Unix-style). Example:dt136804@atum10~/local/DERBY/d_rby-138$ file ./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/actions/SysInfoAction.java./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/actions/SysInfoAction.java: ASCII C program textdt136804@atum10~/local/DERBY/d_rby-138$ svn proplist -v ./plugins/eclipse/org.apache.derby.ui/src/org/apache/derby/ui/actions/SysInfoAction.javaSome of the files that don't have this property do instead have a property called 'snv:eol-style'. I'm guessing this is a typo.Example:dt136804@atum10~/local/DERBY/d_rby-138$ svn proplist -v java/testing/org/apache/derbyTesting/unitTests/crypto/T_CipherOFB.javaProperties on 'java/testing/org/apache/derbyTesting/unitTests/crypto/T_CipherOFB.java': snv:eol-style : native2) A seemingly arbitrary collection of files have the svn:executable property set. To my knowledge  the only files in the Derby respository that should have this property are the *.ksh and perhaps the *.bat scripts  (I don't know if Windows cares about this property when the file has the .bat suffix). Currently none of the *.ksh scripts have this property  but a number of java source files (not all) have it. (If there is some reason to have this property on other files  it should at least be done consistently throughout the repository).Example:dt136804@atum10~/local/DERBY/d_rby-138$ svn proplist -v java/drda/org/apache/derby/drda/NetworkServerControl.javaProperties on 'java/drda/org/apache/derby/drda/NetworkServerControl.java': svn:executable : svn:eol-style : nativedt136804@atum10~/local/DERBY/d_rby-138$ svn proplist -v java/testing/org/apache/derbyTesting/unitTests/crypto/T_CipherOFB.javaProperties on 'java/testing/org/apache/derbyTesting/unitTests/crypto/T_CipherOFB.java': snv:eol-style : nativeIf I understand correctly it is not possible to create a patchfile that contains property changes  so I guess a committer will have to do this. I'm willing to create a script file containing all the svn commands that must be run  as a 'pseudo patch'.", "id": "330"}, "339": {"ground_truth": "0", "bug_report": "Network client XA should only keep XA state for transaction branch association  to track whether to send commit in autocommit mode.  All other state and state related decisions should be deferred to the server.\nNetwork client XA should only keep XA state for transaction branch association  to track whether to send commit in autocommit mode. All other state and state related decisions should be defered to the server.The client tries to track XA state to make decisions based on current XA state. Most of this state handling was removed with DERBY246  but it still was not being handled properly. This is evidenced by multiple failures in xaSimplePostive that now that it gets past DERBY-246.This fix will have the client track only branch association as outlined in the XA+ specification. Table 6-2  State Table for Transaction Branch Association. The client will track onlyXA_TO_NOT_ASSOCIATEDXA_T1_ASSOCIATEDAssociation Suspended (T2) will map to XA_TO_NOT_ASSOCIATED for the client's pupurposes.The client commit in autocommit mode only for XA_TO_NOT_ASSOCIATED.", "id": "339"}, "348": {"ground_truth": "0", "bug_report": "example.html file for the SimpleApp does not describe the arguments accepted by the program\nThe SimpleApp.java demo program supplied with Derby currently accepts two arguments and will soon (see JIRA entry: DERBY-247) accept a third that allows the application to run as a client to Network Server. Only 'embedded' is documented in the ${DERBY_INSTALL}/demo/simple/example.html file. The others should be added. The current undocumented argument is:'jccjdbcclient' - will use the JCC client driver to access Network ServerThe new argument might be:'derbyclient' - will use the Net client driver to access Network ServerThis brief description of the program using the derby client might help in this update:To use the SimpleApp in client mode only the directory containing the SimpleApp and the netclient.jar file are needed in the CLASSPATH. By passing in 'derbyclient' as an argument the program will load the client driver rather than start the Derby engine. The parseArguments() method (line 230) changes two key strings. The variables 'driver' and 'protocol' are set to the client driver values. With these new definitions the go() method loads the client driver at line 73 and creates the client URL at lines 93-94. With the variables expanded these lines will look like this:line 76: Class.forName('org.apache.derby.jdbc.ClientDriver')line 93-94: conn = DriverManager.getConnection('jdbc:derby://localhost:1527/' + 'derbyDB;create=true'  props); As in the embedded example the connection will create the database if it does not exist and boot derbyDB if it has not already been loaded by the Network Server. Note that the application is well behaved and does not shutdown the database when operating as a client.", "id": "348"}, "349": {"ground_truth": "0", "bug_report": "setByte() with executeBatch causes hang with client if mapping is invalid  e.g. setByte to DATE\nsetByte() followed by an addBatch() and then an executeBatch causes a hang.May apply to any setXXX call that will result in any invalid conversion  possibly only those conversions handled by the client.See the test jdbcapi/parameterMapping  look for this bug number in the code  to see the cases disabled when running with the client.", "id": "349"}, "353": {"ground_truth": "0", "bug_report": "It is desirable to have IDENTITY_VAL_LOCAL() function return last recent user specified value or system generated value for BY DEFAULT identity columns.\nDerby was recently enhanced to support BY DEFAULT identity column. While the behavior of this feature is not documented yet  I think  it is desirable for IDENTITY_VAL_LOCAL() function  that is used to retrieve last single statement insert value for identity column  to return user specified value for the default column.For GENERATED ALWAYS identity columns  this issue doesn't apply  since users can't provide a value. But for GENERATED BY DEFAULT identity columns  users can optionally specify a value. IDENTITY_VAL_LOCAL() function should return this value. Derby currently doesn't support this behavior.ij&gt; create table tauto ( i int generated by default as identity  j int  k int);0 rows inserted/updated/deletedij&gt; insert into tauto (j k) values (1 1);1 row inserted/updated/deletedij&gt; values identity_val_local();1-------------------------------11 row selectedij&gt; insert into tauto (j k) values (1 1);1 row inserted/updated/deletedij&gt; values identity_val_local();1-------------------------------21 row selectedij&gt; insert into tauto values (5 1 1);1 row inserted/updated/deletedij&gt; values identity_val_local();1-------------------------------2 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;============= This needs be '5'1 row selectedij&gt; select * from tauto;I |J |K-----------------------------------1 |1 |12 |1 |15 |1 |13 rows selected", "id": "353"}, "361": {"ground_truth": "0", "bug_report": "Unknown page format  error  while doing recovery after a  a crash while doing  in place compress.\nCrash was done manually when compress was almost in the end. Log trace before the crash:DEBUG LogTrace OUTPUT: Write log record: tranId=14527 instant: (23 6270154) length: 20BeginXact null transactionStatus 0DEBUG LogTrace OUTPUT: Write log record: tranId=14527 instant: (23 6270190) length: 25Page Operation: Page(0 Container(0  768)) pageVersion 9567 : CompressSpaceOperation: newHighestPage = 0;num_pages_truncated = 956 to Page(0 Container(0  768))DEBUG LogTrace OUTPUT: Flush log to 1350071DEBUG LogTrace OUTPUT: Write log record: tranId=Null instant: (23 6251544) length: 21Checksum Operation algorithm = 1 value = 3588488 data length= 18650DEBUG LogTrace OUTPUT: Begin log sync...DEBUG LogTrace OUTPUT: end log sync.DEBUG LogTrace OUTPUT: Flush log to 6270235DEBUG LogTrace OUTPUT: Begin log sync...DEBUG LogTrace OUTPUT: end log sync.DEBUG LogTrace OUTPUT: Write log record: tranId=14527 instant: (24 61) length: 17EndXact null Committed : transactionStatus = Committed&#8212;C:/suresht/databases&gt;java -Dij.protocol=jdbc:derby: org.apache.derby.tools.ijij version 10.1ij&gt; call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'   'T1'   1   1  1) ;IJ ERROR: Unable to establish connectionij&gt; connect 'jdbc:derby:wombat';ERROR XJ040: Failed to start database 'wombat'  see the next exception for details.ERROR XSDB1: Unknown page format at page Page(102 Container(0  768))ij&gt;What was done on the DB :$ rm -rf wombat$ ijC:/suresht/databases&gt;rem set DERBY_INSTALL=C:/suresht/databases&gt;java -Dij.protocol=jdbc:derby: org.apache.derby.tools.ijij version 10.1ij&gt; Terminate batch job (Y/N)? ^C$ ijC:/suresht/databases&gt;rem set DERBY_INSTALL=C:/suresht/databases&gt;java -Dij.protocol=jdbc:derby: org.apache.derby.tools.ijij version 10.1ij&gt; connect 'jdbc:derby:wombat;create=true';ij&gt; create table t1(a int ) ;0 rows inserted/updated/deletedij&gt; insert into t1 values(1) ;1 row inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;1 row inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;2 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;4 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;8 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;16 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;32 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;64 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;128 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;256 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;512 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;1024 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;2048 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;4096 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;8192 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;16384 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;32768 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;65536 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;131072 rows inserted/updated/deletedij&gt; insert into t1 select a + 1 from t1 ;262144 rows inserted/updated/deletedij&gt; commit ;ij&gt; delete from t1 ;524288 rows inserted/updated/deletedij&gt; select * from new org.apache.derby.diag.SpaceTable('T1') ;ERROR 42X01: Syntax error: Encountered '&lt;EOF&gt;' at line 1  column 57.ij&gt; select * from new org.apache.derby.diag.SpaceTable('T1') t ;CONGLOMERATENAMEISIND&amp;NUMALLOCATEDPAGES NUMFREEPAGES NUMUNFILLEDPAGES PAGESIZE ESTIMSPACESAVING---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------T10 1 3826 1 4096 156712961 row selectedij&gt; select NUMALLOCATEDPAGES from new org.apache.derby.diag.SpaceTable('T1') t ;NUMALLOCATEDPAGES--------------------11 row selectedij&gt; select NUMAFREEPAGES from new org.apache.derby.diag.SpaceTable('T1') t ;ERROR 42X04: Column 'NUMAFREEPAGES' is either not in any table in the FROM listor appears within a join specification and is outside the scope of the join specification or appears in a HAVING clause and is not in the GROUP BY list. If this is a CREATE or ALTER TABLE statement then 'NUMAFREEPAGES' is not a column in the target table.ij&gt; select NUMFREEPAGES from new org.apache.derby.diag.SpaceTable('T1') t ;NUMFREEPAGES--------------------38261 row selectedij&gt; call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'   'T1'   1   1  1) ;0 rows inserted/updated/deletedij&gt; select NUMFREEPAGES from new org.apache.derby.diag.SpaceTable('T1') t ;NUMFREEPAGES--------------------01 row selectedij&gt; select * from new org.apache.derby.diag.SpaceTable('T1') t ;CONGLOMERATENAMEISIND&amp;NUMALLOCATEDPAGES NUMFREEPAGES NUMUNFILLEDPAGES PAGESIZE ESTIMSPACESAVING---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------T10 1 01 4096 01 row selectedij&gt; ^CTerminate batch job (Y/N)? ^C$ ij/&gt;$ ijC:/suresht/databases&gt;rem set DERBY_INSTALL=C:/suresht/databases&gt;java -Dij.protocol=jdbc:derby: org.apache.derby.tools.ijij version 10.1ij&gt; connect 'jdbc:derby:wombat';ij&gt; select * from t1 ;A-----------0 rows selectedij&gt; insert into t1 values(1) ;1 row inserted/updated/deletedij&gt; insert into t1 select * from t1 ;1 row inserted/updated/deletedij&gt; insert into t1 select * from t1 ;2 rows inserted/updated/deletedij&gt; insert into t1 select * from t1 ;4 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;8 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;16 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;32 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;64 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;128 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;256 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;512 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;1024 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;2048 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;4096 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;8192 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;16384 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;32768 rows inserted/updated/deletedij&gt; insert into t1 select a+1 from t1 ;65536 rows inserted/updated/deletedij&gt; delete from t1 ;131072 rows inserted/updated/deletedij&gt; select * from new org.apache.derby.diag.SpaceTable('T1') t ;CONGLOMERATENAMEISIND&amp;NUMALLOCATEDPAGES NUMFREEPAGES NUMUNFILLEDPAGES PAGESIZE ESTIMSPACESAVING---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------T10 1 9560 4096 39157761 row selectedij&gt; call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'   'T1'   1   1  1) ;0 rows inserted/updated/deletedij&gt; Terminate batch job (Y/N)? ^C$ ijC:/suresht/databases&gt;rem set DERBY_INSTALL=C:/suresht/databases&gt;java -Dij.protocol=jdbc:derby: org.apache.derby.tools.ijij version 10.1ij&gt; call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'   'T1'   1   1  1) ;IJ ERROR: Unable to establish connectionij&gt; connect 'jdbc:derby:wombat';ERROR XJ040: Failed to start database 'wombat'  see the next exception for details.ERROR XSDB1: Unknown page format at page Page(102 Container(0  768))ij&gt;Stacks: pageVersion 8611 : Change page allocation status of 102 to 1(undo 0) instant = (23 6494) logEnd = (23 6536) logIn at 22 available 4DEBUG LogTrace OUTPUT: scanned 12606 : Page Operation: Page(102 Container(0  768)) pageVersion 412 : Invalidate Page - it has been deallocated instant = (23 6536) logEnd = (23 6574) logIn at 18 available 4------------ BEGIN SHUTDOWN ERROR STACK -------------ERROR XSLA7: Cannot redo operation Page Operation: Page(102 Container(0  768)) pageVersion 412 : Invalidate Page - it has been deallocated in the log. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:315) at org.apache.derby.impl.store.raw.log.FileLogger.redo(FileLogger.java:1515) at org.apache.derby.impl.store.raw.log.LogToFile.recover(LogToFile.java:798) at org.apache.derby.impl.store.raw.RawStore.boot(RawStore.java:323) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.store.access.RAMAccessManager.boot(RAMAccessManager.java:994) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.db.BasicDatabase.bootStore(BasicDatabase.java:757) at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:178) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1832) at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1698) at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1577) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:996) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:988) at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:533) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:1551) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:196) at org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:72) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:73) at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:183) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:140) at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:836) at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:698) at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:528) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:289) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)============= begin nested exception  level (1) ===========ERROR XSDB1: Unknown page format at page Page(102 Container(0  768)) at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:315) at org.apache.derby.impl.store.raw.data.CachedPage.changeInstanceTo(CachedPage.java:315) at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:195) at org.apache.derby.impl.services.cache.CachedItem.takeOnIdentity(CachedItem.java:235) at org.apache.derby.impl.services.cache.Clock.addEntry(Clock.java:798) at org.apache.derby.impl.services.cache.Clock.find(Clock.java:303) at org.apache.derby.impl.store.raw.data.FileContainer.getAnyPage(FileContainer.java:2430) at org.apache.derby.impl.store.raw.data.BaseContainer.getAnyPage(BaseContainer.java:473) at org.apache.derby.impl.store.raw.data.BaseContainerHandle.getAnyPage(BaseContainerHandle.java:590) at org.apache.derby.impl.store.raw.data.PageBasicOperation.findpage(PageBasicOperation.java:303) at org.apache.derby.impl.store.raw.data.PageBasicOperation.needsRedo(PageBasicOperation.java:159) at org.apache.derby.impl.store.raw.log.FileLogger.redo(FileLogger.java:1394) at org.apache.derby.impl.store.raw.log.LogToFile.recover(LogToFile.java:798) at org.apache.derby.impl.store.raw.RawStore.boot(RawStore.java:323) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.store.access.RAMAccessManager.boot(RAMAccessManager.java:994) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.db.BasicDatabase.bootStore(BasicDatabase.java:757) at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:178) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1832) at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1698) at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1577) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:996) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:988) at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:533) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:1551) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:196) at org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:72) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:73) at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:183) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:140) at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:836) at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:698) at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:528) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:289) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)============= end nested exception  level (1) ======================== begin nested exception  level (2) ===========ERROR XBM0U: No class was registered for identifier 0. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:311) at org.apache.derby.impl.services.monitor.BaseMonitor.classFromIdentifier(BaseMonitor.java:648) at org.apache.derby.impl.services.monitor.BaseMonitor.newInstanceFromIdentifier(BaseMonitor.java:661) at org.apache.derby.iapi.services.monitor.Monitor.newInstanceFromIdentifier(Monitor.java:618) at org.apache.derby.impl.store.raw.data.CachedPage.changeInstanceTo(CachedPage.java:303) at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:195) at org.apache.derby.impl.services.cache.CachedItem.takeOnIdentity(CachedItem.java:235) at org.apache.derby.impl.services.cache.Clock.addEntry(Clock.java:798) at org.apache.derby.impl.services.cache.Clock.find(Clock.java:303)-More- at org.apache.derby.impl.store.raw.data.FileContainer.getAnyPage(FileContainer.java:2430) at org.apache.derby.impl.store.raw.data.BaseContainer.getAnyPage(BaseContainer.java:473) at org.apache.derby.impl.store.raw.data.BaseContainerHandle.getAnyPage(BaseContainerHandle.java:590) at org.apache.derby.impl.store.raw.data.PageBasicOperation.findpage(PageBasicOperation.java:303) at org.apache.derby.impl.store.raw.data.PageBasicOperation.needsRedo(PageBasicOperation.java:159) at org.apache.derby.impl.store.raw.log.FileLogger.redo(FileLogger.java:1394) at org.apache.derby.impl.store.raw.log.LogToFile.recover(LogToFile.java:798) at org.apache.derby.impl.store.raw.RawStore.boot(RawStore.java:323) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.store.access.RAMAccessManager.boot(RAMAccessManager.java:994) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:539) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.db.BasicDatabase.bootStore(BasicDatabase.java:757) at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:178) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1985) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1832) at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1698) at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1577) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:996) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:988) at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:533) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:1551) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:196) at org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:72) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:73) at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:183) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:140) at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:836) at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:698) at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:528) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:289) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)============= end nested exception  level (2) ===========-More-", "id": "361"}, "375": {"ground_truth": "1", "bug_report": "Specification of incomplete server properties on command line causes NPE with NetworkServerControl when starting the server.\nWhen using the command line to start the Network Server  there a couple of cases where if a property is specified on the command line but no value is given (ex. '-Dderby.drda.maxThreads' instead of '-Dderby.drda.maxThreads=3')  a Null Pointer Exception will result  when the correct behavior should be to use some kind of default.For example:&gt; java -Dderby.drda.maxThreads org.apache.derby.drda.NetworkServerControl start -p 1528java.lang.NullPointerException at org.apache.derby.impl.drda.NetworkServerControlImpl.localizeMessage(NetworkServerControlImpl.java) at org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessageWork(NetworkServerControlImpl.java) at org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessage(NetworkServerControlImpl.java) at org.apache.derby.impl.drda.NetworkServerControlImpl.getIntPropVal(NetworkServerControlImpl.java) at org.apache.derby.impl.drda.NetworkServerControlImpl.getPropertyInfo(NetworkServerControlImpl.java) at org.apache.derby.impl.drda.NetworkServerControlImpl.&lt;init&gt;(NetworkServerControlImpl.java) at org.apache.derby.drda.NetworkServerControl.main(NetworkServerControl.java)Note that even though we see this NPE  it appears that the server still starts up  although the startup may not be complete (subsequent attempts to connect might lead to errors like 'Invalid reply from network server: Insufficient data.').For other properties  this will just result in the default value being used  which is the correct behavior. For example:&gt; java -Dderby.drda.host org.apache.derby.drda.NetworkServerControl start -p 1528Server is ready to accept connections on port 1528.", "id": "375"}, "385": {"ground_truth": "0", "bug_report": "servlet Back to Main Page link points to csnet instead of derbynet\nThe link at the top of the servlet java/drda/org/apache/derby/drda/NetServlet.java links to csnet (because of the static String SERVLET_ADDRESS). However  the servlet address is now derbynet.", "id": "385"}, "387": {"ground_truth": "0", "bug_report": "SimpleNetworkClientSample.java network server example has an error which causes it to fail\nThe file SimpleNetworkClientSample.java under the demo/nserverdemo has an error which preventsit from completing successfully.The one line that is a problem is this: private static final String DERBY_CLIENT_URL= 'jdbc:derby://localhost:'+ NETWORKSERVER_PORT+'/NSSampledb;create=true';The one line fix is this: private static final String DERBY_CLIENT_URL= 'jdbc:derby://localhost:'+ NETWORKSERVER_PORT+'/' DBNAME';create=true';", "id": "387"}, "389": {"ground_truth": "0", "bug_report": "With Network Server Database hangs after some time with many connections executing prepareStatement()\nRajesh found this issue in running Network Server system tests for the 10.1 release candidateWhile running the Network Server system test with 210 clients  the Network Server and all the clients hangs after some time. A Ctrl+/ on the Network Server shows that upto 180 threads waiting on the PreparedStatements to compile and comes from the embedded engine. The following is the stack trace from the java dump.3XMTHREADINFO 'DRDAConnThread_181' (TID:1007C998  sys_thread_t:85C4478  state:CW  native ID:4575ABB0) prio=54XESTACKTRACE at java.lang.Object.wait(Native Method)4XESTACKTRACE at java.lang.Object.wait(Object.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java)4XESTACKTRACE at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java)4XESTACKTRACE at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&lt;init&gt;(EmbedPreparedStatement.java)4XESTACKTRACE at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&lt;init&gt;(EmbedPreparedStatement20.java)4XESTACKTRACE at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&lt;init&gt;(EmbedPreparedStatement30.java)4XESTACKTRACE at org.apache.derby.jdbc.Driver30.newEmbedPreparedStatement(Driver30.java)4XESTACKTRACE at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java)4XESTACKTRACE at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java)4XESTACKTRACE at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)4XESTACKTRACE at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java(Compiled Code))4XESTACKTRACE at java.lang.reflect.Method.invoke(Method.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.drda.DRDAStatement.prepareStatementJDBC3(DRDAStatement.java)4XESTACKTRACE at org.apache.derby.impl.drda.DRDAStatement.prepare(DRDAStatement.java)4XESTACKTRACE at org.apache.derby.impl.drda.DRDAStatement.explicitPrepare(DRDAStatement.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.drda.DRDAConnThread.parsePRPSQLSTT(DRDAConnThread.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java(Compiled Code))4XESTACKTRACE at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java)", "id": "389"}, "392": {"ground_truth": "0", "bug_report": "Disable creating indexes on long varchar for bit data. Long varchar column doesn't allow creating indexes already.\nI guess I did not articulate my reasons for suggesting removal of index support for 'long varchar for bit data' completely. 1) Long varchar types are not comparable... If they are not comparable  it should not be possible to use them in GROUP BY  ORDER BY or allow regular B-Tree indexes. 2) Also  long varchar types tend to be long in size and hence the regular B-Tree mechanism is not a suitable way to index them. Dan also mentioned they become ineffective for keys longer than half a page size.It should not be possible to create an index on 'long varchar for bit data' datatypes. Derby currently doesn't allow creating indexes on 'long varchar' datatypes and the same should apply for it's bit data equivalent too.ij&gt; create table longchar ( i int  c long varchar);0 rows inserted/updated/deletedij&gt; create index longIdx on longchar(c);ERROR X0X67: Columns of type 'LONG VARCHAR' may not be used in CREATE INDEX  ORDER BY  GROUP BY  UNION  INTERSECT  EXCEPT or DISTINCT statements because comparisons are not supported for that type.ij&gt; create table longcharBitData ( i int  c long varchar for bit data);0 rows inserted/updated/deletedij&gt; create index longIdx on longcharBitData(c);0 rows inserted/updated/deletedDerby also seems to allow GROUP BY and/or ORDER BY on LONG VARCHAR FOR BIT DATA types. I believe this is incorrect too.select c from longcharBitData group by c;C--------------------------------------------------------------------------------------------------------------------------------0 rows selectedij&gt; select c from longcharBitData group by c order by c;C--------------------------------------------------------------------------------------------------------------------------------0 rows selected", "id": "392"}, "400": {"ground_truth": "0", "bug_report": "Network client message strings not internationalized\nIn investigating DERBY-254  I discovered that all SQLExceptions are thrown with hardcoded English error messages. This needs to be modified to use message string resource bundles similar to the embedded code.", "id": "400"}, "406": {"ground_truth": "0", "bug_report": "Client DataSource should not require user property to be set\nClientDataSource should not require user to be set. It should default to user APP as described in:http://incubator.apache.org/derby/docs/adminguide/cadminappsclient.htmlThis all seems to work ok for for DriverManager connections but fails for ClientDataSource run the attached repro $ java DataSourceNoUserembedded no userid/passwordclient userid/password setclient no passwordclient no userid/no passwordorg.apache.derby.client.am.SqlException: null userid not supported at org.apache.derby.client.net.NetConnection.checkUser(NetConnection.java:998) at org.apache.derby.client.net.NetConnection.flowConnect(NetConnection.java:380) at org.apache.derby.client.net.NetConnection.initialize(NetConnection.java:233) at org.apache.derby.client.net.NetConnection.&lt;init&gt;(NetConnection.java:201) at org.apache.derby.jdbc.ClientDataSource.getConnection(ClientDataSource.java:156) at org.apache.derby.jdbc.ClientDataSource.getConnection(ClientDataSource.java:135) at DataSourceNoUser.main(DataSourceNoUser.java:42)", "id": "406"}, "415": {"ground_truth": "0", "bug_report": "sysinfo with -cp client option should not print error saying DB2 jar file and driver class are missing\nIf you run java org.apache.derby.tools.sysinfo -cp client SimpleApp.classyou getFOUND IN CLASS PATH: Derby Client libraries (derbyclient.jar) user-specified class (SimpleApp)NOT FOUND IN CLASS PATH: Derby Client libraries (db2jcc.jar) (com.ibm.db2.jcc.DB2Driver not found.)The 'NOT FOUND IN CLASSPATH' output is confusing and invalid because we're testing the network client  not the DB2 JCC client.", "id": "415"}, "422": {"ground_truth": "0", "bug_report": "Create a new sample database for use in examples in the manuals\nThe Derby manuals still refer to Cloudscape example databases that were unable to be contributed to Derby. A new sample database should be created which is complex enough to serve as the basis for examples in the various manuals.", "id": "422"}, "424": {"ground_truth": "0", "bug_report": "Queryplan for a query using SESSION schema view is incorrectly put in statement cache. This could cause incorrect plan getting executed later if a temp. table is created with that name.\nSee DERBY-405 for some discussion related this issue. I suspect this is because of statement caching. Derby doesn't seem to recognise we have a temporary table that just overloaded an existing physical table. It would have been good to avoid permanent tables/views/synonyms in SESSION schema. Not sure what we should do now about this  though. ij&gt; create view session.st1 as select * from t; 0 rows inserted/updated/deleted ij&gt; select * from session.st1; I |J |K ----------------------------------- 1 |1 |NULL 2 |2 |NULL 3 |3 |NULL 4 |4 |NULL 4 rows selected ij&gt; select * from t; I |J |K ----------------------------------- 1 |1 |NULL 2 |2 |NULL 3 |3 |NULL 4 |4 |NULL 4 rows selected ij&gt; declare global temporary table st1(c11 int  c12 int) on commit preserve rows  not logged; 0 rows inserted/updated/deleted ij&gt; select * from session.st1; I |J |K ----------------------------------- 1 |1 |NULL 2 |2 |NULL 3 |3 |NULL 4 |4 |NULL 4 rows selected ij&gt; select * from session.st1; &lt;==== This statement has an extra space between FROM and session.st1 C11 |C12 ----------------------- 0 rows selected", "id": "424"}, "479": {"ground_truth": "0", "bug_report": "Passing the return of  a RETURN NULL ON NULL INPUT function to another function call throws linkage error.\nError in ij (RN_RADIANS is a function declared as returns null on null input)ij&gt; VALUES CAST( CALL_COS(RN_RADIANS(90.0)) AS DECIMAL(3 2));ERROR XBCM1: Java linkage error thrown during load of generated class org.apache.derby.exe.ace5214067x0105x5e41x7a46xffff855452e375.ERROR XJ001: Java exception: '(class: org/apache/derby/exe/ace5214067x0105x5e41x7a46xffff855452e375  method: e0 signature: ()Ljava/lang/Object Expecting to find double on stack: java.lang.VerifyError'.extract from derby.log2005-07-28 16:23:43.836 GMT Thread&#91;main 5 main&#93; Wrote class org.apache.derby.exe.ace5214067x0105x5e41x7a46xffff855452e375 to file C:&#95;work/svn_pb/trunk/systest/out/functions/ace5214067x0105x5e41x7a46xffff855452e375.class. Please provide support with the file and the following exception information: java.lang.VerifyError: (class: org/apache/derby/exe/ace5214067x0105x5e41x7a46xffff855452e375  method: e0 signature: ()Ljava/lang/Object Expecting to find double on stackI will add a test case to lang/functions.sql commented with this bug number. Test casesthat fail will be commented out.", "id": "479"}, "483": {"ground_truth": "0", "bug_report": "Error message  X0X07  has incorrect property name  db2j.database.classpath instead of derby.database.classpath\nExample output is in the test lang/dcl.sql  extracted here.ERROR X0X07: Cannot drop jar file ''EMC'.'MAIL_APP'' because its on your db2j.database.classpath ''EMC'.'MAIL_APP''.Also the its should be it's (it is).Might also make sense to change drop to remove  as the procedure is called remove_jar.", "id": "483"}, "485": {"ground_truth": "1", "bug_report": "SecurityException or LinkageException thrown during loading a class from a database jar incorrectly shuts the engine down.\nIn addiing test cases to lang/dcl.test for signed jar files stored in the database I found that if a jar is installed with a tampered class the resulting SecurityException shuts Derby down. Most likely the same would be true for an invalid class hacked into the jar.", "id": "485"}, "488": {"ground_truth": "0", "bug_report": "DatabaseMetaData.getColumns() fails on iSeries JDK 1.4 with verfier error on generated class.\nAnalysis shows that ----------------------------------------------------------------------The problem is occurring starting at offset 2007 in method e23. There is an invokeinterface to method setWidth(int  int  boolean) of class VariableSizeDataValue. This invoke returns a value of class DataValueDescriptor. That value is in turn stored in field e142 at offset 2015 in method e23. The problem is that field e142 is a NumberDataValue  and DataValueDescriptor is not a valid subclass of NumberDataValue. Thus the store is not allowed.----------------------------------------------------------------------Looking at the generated setWidth() calls I see one in BinaryOperatorNode where the return (DataValueDescriptor) is not cast to the type of the field it is stored in.", "id": "488"}, "498": {"ground_truth": "0", "bug_report": "Result set holdability defined inside stored procedures is ignored by server/client\nAssume I have a Java stored procedure that returns one or more result sets  and the holdability of those result sets is specified as part of the createStatement() method within the procedure definition (see below for an example).If I execute this procedure against Derby embedded  the holdability of each result set matches that of the statement-specific holdability that is defined within the stored procedure. However  if I run the procedure against the Network Server using the Derby client  the holdability of all result sets is the same  and it is based on the holdability of the statement that executed the procedure--i.e. the statement-specific holdability that is defined within the procedure is ignored.Ex: If I create a stored procedure that corresponds to the following method:public static void p2(ResultSet[] rs1  ResultSet[] rs2  ResultSet[] rs3) throws Exception{ Connection conn = DriverManager.getConnection( 'jdbc:default:connection'); Statement st1 = conn.createStatement( ResultSet.TYPE_FORWARD_ONLY  ResultSet.CONCUR_READ_ONLY  ResultSet.HOLD_CURSORS_OVER_COMMIT); rs1[0] = st1.executeQuery('select * from testtable1'); Statement st2 = conn.createStatement( ResultSet.TYPE_FORWARD_ONLY  ResultSet.CONCUR_READ_ONLY  ResultSet.CLOSE_CURSORS_AT_COMMIT); rs2[0] = st2.executeQuery('select * from testtable2'); Statement st3 = conn.createStatement( ResultSet.TYPE_FORWARD_ONLY  ResultSet.CONCUR_READ_ONLY  ResultSet.HOLD_CURSORS_OVER_COMMIT); rs3[0] = st3.executeQuery('select * from testtable3'); return; }}Then with Derby embedded  if I have a JDBC Statement that executes a call to this procedure  rs1 and rs3 will behave with HOLD_CURSORS holdability and rs2 will behave with CLOSE_CURSORS holdability--and that will be the case regardless of the holdability on the Statement that executed the call. That seems correct to me.But if I do the same thing with Network Server  all of the result sets (rs1  rs2  and rs3) will have the same holdability as the JDBC Statement that executed the call. It doesn't matter what the holdabilities used within the procedure definition are: they will all be over-ridden by the holdability of the Statement that made the call.", "id": "498"}, "499": {"ground_truth": "0", "bug_report": "Expose BOOLEAN datatype to end users\nVeaceslav Chicu started an email thread on 8 August 2005 titled 'boolean type'. He was disappointed that Derby doesn't support the ansi BOOLEAN datatype. On closer inspection  Derby does internally support this type but does not expose this support to end users.Derby should let users declare table columns of type BOOLEAN. This should be an indexable datatype.", "id": "499"}, "504": {"ground_truth": "0", "bug_report": "SELECT DISTINCT returns duplicates when selecting from subselects\nWhen one performs a select distinct on a table generated by a subselect  there sometimes are duplicates in the result. The following example shows the problem:ij&gt; CREATE TABLE names (id INT PRIMARY KEY  name VARCHAR(10));0 rows inserted/updated/deletedij&gt; INSERT INTO names (id  name) VALUES (1  'Anna')  (2  'Ben')  (3  'Carl')  (4  'Carl')  (5  'Ben')  (6  'Anna');6 rows inserted/updated/deletedij&gt; SELECT DISTINCT(name) FROM (SELECT name  id FROM names) AS n;NAME ----------Anna Ben Carl Carl Ben Anna Six names are returned  although only three names should have been returned.When the result is explicitly sorted (using ORDER BY) or the id column is removed from the subselect  the query returns three names as expected:ij&gt; SELECT DISTINCT(name) FROM (SELECT name  id FROM names) AS n ORDER BY name;NAME ----------Anna Ben Carl 3 rows selectedij&gt; SELECT DISTINCT(name) FROM (SELECT name FROM names) AS n;NAME ----------Anna Ben Carl 3 rows selected", "id": "504"}, "514": {"ground_truth": "0", "bug_report": "Integrate upgrade tests into test suite\nCurrently there are no upgrade tests in the derbyAll suite.The upgrade tests java/testing/org/apache/derbyTesting are run by script and require that the version to be tested by specified on the command line so that the classpath can be changed. runphases old_major old_minor old_engine new_engine# e.g.# runphases 10 0 c:/derby/10.0.2.1/lib c:/derby/trunk/jars/sanePerhaps this script can be rewritten in Java using class loaders and previous Derby verssions such as 10.0 and 10.1 be checked in so that this testing can be incorporated into the derbyAll test suite.", "id": "514"}, "525": {"ground_truth": "0", "bug_report": "getAsciiStreamshould replace non-ASCII characters with 0x3f  '?'  to match embedded\nWhen calling Clob.getAsciiStream or ResultSet.getAsciiStream if the column type is a character type or a CLOB  then any out of range character (to the ASCII set) needs to be replaced by 0x3f ('?'  question mark). ASCII is defined as 8 bit characters  thus Unicode Characters in the range 0x0000 to 0x00ff are mapped to ASCII characters 0x00 to 0xff  and Unicode characters in the range 0x0100 to 0xffff are mapped to 0x3fBy code inspection:client code in org.apache.derby.client.am.ResultSetembedded in org.apache.derby.impl.jdbc.ReaderToAscii", "id": "525"}, "527": {"ground_truth": "0", "bug_report": "Incorrect insane build on windows platform\nI've found that Derby will not build sane properly for me. I have isolated it to here: &lt;target name='evaluate.sane'&gt; &lt;condition property='generate.sane'&gt; &lt;equals arg1='${sane}' arg2='true'/&gt; &lt;/condition&gt; &lt;/target&gt;The scope of the generate.sane property is limited to this target (only tested in a Windows XP environment)  ergo it will always be an insane build. Patch to follow shortly.", "id": "527"}, "530": {"ground_truth": "0", "bug_report": "ClientDriver ignores Properties object in connect(String url  Properties connectionProperties) method\nIn contrast to EmbeddedDriver  a connection attribute create=true is not recognized when presented as a property in a Properties object. As a workaround I append the attributes from the Properties object to the url string before invoking the connect() method: then a new database is created and a connection is established.Next code fragment illustrates the bug and the workaround: private static final ClientDriver clientDriver = new ClientDriver(); private Connection getClientConnection(String database  Properties connectionProperties) throws SQLException { try { System.out.println('Try to connect with properties'); String connectionURL = 'jdbc:derby://127.0.0.1:1527/' + database; System.out.println('connectionURL: ' + connectionURL); Connection rv = clientDriver.connect(connectionURL  connectionProperties); System.out.println('Connection: ' + rv); return rv; } catch (SQLException e) { System.out.println('Try to connect with URL attributes'); StringBuffer sb = new StringBuffer(); for (Enumeration enu = connectionProperties.propertyNames(); enu .hasMoreElements() { String key = (String) enu.nextElement(); sb.append(';'); sb.append(key); sb.append('='); sb.append(connectionProperties.getProperty(key  '')); } String connectionURL = 'jdbc:derby://127.0.0.1:1527/' + database + sb.toString(); System.out.println('connectionURL: ' + connectionURL); Connection rv = clientDriver.connect(connectionURL  connectionProperties); System.out.println('Connection: ' + rv); System.out .println('!!!!!!!!!!! seems a bug: Properties argument in ClientDriver.connect(String  Properties) has not been used'); return rv; } }", "id": "530"}, "536": {"ground_truth": "0", "bug_report": "The current build.properties for the Derby Help Plug-in for Eclipse does not work for creating a deployable plug-in\nWhile updating the information for the web site about the Derby plug-ins I revised the instructions on how to create zip files for the plug-ins. The current build.properties file for the help plug-in did not work to create a deployable plug-in  without manual intervention. The attached patch for the build.properties file for the help plug-in should replace the existing one  which allows users to select Export &gt;&gt; Deployable plug-ins and fragments and then create a zip file which is suitable for deployment.svn stat output:M plugins/eclipse/org.apache.derby.plugin.doc/build.propertiesTests:I built a new doc zip file using the new build.properties file  unzipped it to another eclipse install in the ECLIPSE_HOME directory and made sure all of the files for the help were in the correct location and accessible.I'd appreciate it if someone could commit this.Thanks Susan", "id": "536"}, "540": {"ground_truth": "0", "bug_report": "Loading databases from jars in the classpath is broken  databases cannot be found.\nIn converting an old Cloudscape test to ensure changes made for DERBY-538 would not break loading from classes stored in the database when the database itself is in a jar  I discovered that a database cannot be found that is in a jar on the classpath.Discovered the reason is the StoreFactory implementation for classpath always prepends a leading foward slash to the database name  but this is incorrect (e.g. db7 to /db7). This causes the database not to be found when the classloader is URLClassLoader as the correct path for the service.properties file is db7/services.properties  not /db7/services.properties.Will add converted test (lang/dbjar.sql)", "id": "540"}, "541": {"ground_truth": "0", "bug_report": "Read-only databases fail to boot after soft upgrade. Raises error message:  40XD1: Container was opened in read-only mode.\nAttempting to boot a database that is created using Derby 10.0 fail in soft upgrade mode in Derby 10.1 or in trunk. (10.2) Boot fails with Error 40XD1: Container was opened in read-only mode.After debugging the problem a little  it seems soft upgrade code attempts do change a database property value and since the database is read-only  the error is raised. Here is what I tried:ij&gt; connect 'jdbc:derby:jar:(t10.jar)t10db';ERROR XJ040: Failed to start database 'jar:(t10.jar)t10db'  see the next exception for details.ERROR 40XD1: Container was opened in read-only mode.Here is the stack trace:ERROR 40XD1: Container was opened in read-only mode. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:301) at org.apache.derby.impl.store.raw.data.BaseContainer.use(BaseContainer.java:539) at org.apache.derby.impl.store.raw.data.BaseContainerHandle.useContainer(BaseContainerHandle.java:786) at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:633) at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:494) at org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1270) at org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:865) at org.apache.derby.impl.store.access.heap.Heap.openScan(Heap.java:675) at org.apache.derby.impl.store.access.RAMTransaction.openScan(RAMTransaction.java:530) at org.apache.derby.impl.store.access.RAMTransaction.openScan(RAMTransaction.java:1582) at org.apache.derby.impl.store.access.PropertyConglomerate.openScan(PropertyConglomerate.java:230) at org.apache.derby.impl.store.access.PropertyConglomerate.saveProperty(PropertyConglomerate.java:296) at org.apache.derby.impl.store.access.PropertyConglomerate.setProperty(PropertyConglomerate.java:535) at org.apache.derby.impl.store.access.RAMTransaction.setProperty(RAMTransaction.java:1787) at org.apache.derby.impl.sql.catalog.DD_Version.applySafeChanges(DD_Version.java:281) at org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:223) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:5826) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:629) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1996) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:542) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionFactory.bootDataDictionary(GenericLanguageConnectionFactory.java:355) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionFactory.boot(GenericLanguageConnectionFactory.java:328) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1996) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:542) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:418) at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:193) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1996) at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:290) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1834) at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1700) at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartServiceBaseMonitor.java:1528) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:998) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:990) at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:533) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:1551) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:196) at org.apache.derby.impl.jdbc.EmbedConnection30.&lt;init&gt;(EmbedConnection30.java:72) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:73) at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:183) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:140) at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:836) at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:698) at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:528) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:289) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)ij&gt;", "id": "541"}, "582": {"ground_truth": "0", "bug_report": "Dynamic parameter should be allowed to be the operand of unary operator '-'. Derby throws exception 42X36: The '-' operator is not allowed to take a ? parameter as an operand.'\nA simple test program which uses dynamic parameter for unary operator '-' fails with an exception. Following is the snippet of the code ps = con.prepareStatement('select * from t1 where c11 = -?'); ps.setInt(1 1); rs = ps.executeQuery();The prepareStatement call fails with following exceptionSQLSTATE(42X36):ERROR 42X36: The '-' operator is not allowed to take a ? parameter as an operand.", "id": "582"}, "595": {"ground_truth": "0", "bug_report": "Using derby.language.logStatementText=true can mask certain exceptions and lead to incorrect behavior in some cases\nUsing derby.language.logStatementText=true can mask certain exceptions and lead to incorrect behavior.I observed this with tests using streams  where if valid (expected) exceptions are raised when DVD.getString() is called  the exception gets eaten up when this property is set. See 1)in GenericParameter.toString()try{return value.getString();}catch (StandardException se){return 'unexpected exception from getString() - ' + se;}}2)in GenericPreparedStatement.execute()  where pvs.toString() is called for the parameters.________Reproduction: Run the test jdbcapi/resultsetStream.java   with derby.language.logStatementText=true and expected error exceptions wont be thrown for the error cases. I looked at the tests that use streams   only the store/streamingColumn.java uses derby.language.logStatementText=true. I'll file another bug to resolve this test.", "id": "595"}, "606": {"ground_truth": "1", "bug_report": "SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE fails on (very) large tables\nSYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE fails with one of the following error messages when applied to a very large table (&gt;2GB):Log operation null encounters error writing itself out to the log stream  this could be caused by an errant log operation or internal log buffer full due to excessively large log operation. SQLSTATE: XJ001: Java exception: ': java.io.IOException'.orThe exception 'java.lang.ArrayIndexOutOfBoundsException' was thrown while evaluating an expression. SQLSTATE: XJ001: Java exception: ': java.lang.ArrayIndexOutOfBoundsException'.In either case  no entry is written to the console log or to derby.log.", "id": "606"}, "618": {"ground_truth": "0", "bug_report": "Make the client driver connection URL work when spaces are in the URL.\nAt present  if I want to connect to a database on a Derby server which has a space in the path  there is no way to do it.This can be done with the embedded driver  and for consistency it would be good if it worked for the client driver in the same fashion.", "id": "618"}, "622": {"ground_truth": "1", "bug_report": "sysinfo incorrectly requires permission on Derby jar files\nRunning the test derbynet/sysinfo.java requires this permission in derby_tests.policy  in order to read the jar files.permission java.io.FilePermission '${csinfo.codedir}${/}*'  'read'But according to the Java security specs:'Note: code can always read a file from the same directory it's in (or a subdirectory of that directory); it does not need explicit permission to do so.'Probably means a privileged block is required when accessing the contents of the jar files in sysinfo", "id": "622"}, "623": {"ground_truth": "1", "bug_report": "Derby monitor accesses two system properties without using a privileged block when built sane=true\nWhen built with sane=true and testing with the jars these permissions are required to be granted all the way up the stack  currently this means for the tests granting them to the network server jar. permission java.util.PropertyPermission 'derby.monitor.verbose'  'read'; permission java.util.PropertyPermission 'derby.debug.*'  'read';The engine contains code to read system properties using privileged blocks  this should be used by the monitor.", "id": "623"}, "630": {"ground_truth": "1", "bug_report": "create trigger fails with null pointer exception\nWhen i create a brand new database  and execute the following statements all in one transaction or each of them in their own transaction  then it fails at trigger creation with null pointer exception. if i exclude the schema names from statement  then it runs fine. (If S1 is ommited from every statement then it runs fine). Once the version without the schema names run fine  i can run the version that has schema names  fine also. create schema S1;create table S1.PRODUCT( PRODUCT_ID VARCHAR(255) unique not null  VERSION BIGINT );create table S1.CATEGORY( CAT_ID VARCHAR(255)  NAME varchar(255) not null  VERSION BIGINT );create table S1.PROD_IN_CAT( CAT_ID VARCHAR(255) not null  PRODUCT_ID VARCHAR(255) not null  VERSION BIGINT );create trigger S1.product_v after update of version on S1.productreferencing new as nfor each rowmode db2sql update S1.prod_in_cat set version = n.version where S1.prod_in_cat.product_id=n.product_id;java.lang.NullPointerException at org.apache.derby.impl.sql.catalog.SYSSTATEMENTSRowFactory.makeSYSSTATEMENTSrow(Unknown Source) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addSPSDescriptor(Unknown Source) at org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.createSPS(Unknown Source) at org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.executeConstantAction(Unknown Source)Stopping progress indicator for: Executing SQL at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)", "id": "630"}, "634": {"ground_truth": "0", "bug_report": "Subquery materialization can cause stack overflow\nA performance optimization in subquery processing can cause a stack overflow.The optimization materializes a subquery ResultSet in memory where it thinks the rows will fit in memory. The materialization is done as a set of nested unions of constant rows (UnionResultSets and RowResultSets). If there are a lot of rows this can cause a stack overflow when fetching a row.The obvious fix is to make it use an iterative technique rather than a recursive one for storing and returning the rows. See the method BaseActivation.materializeResultSetIfPossible() in the language execution code.There are some other issues with this performance optimization that should be looked at:1) The optimization can backfire  making the query run much slower. For example  in the query: select * from one_row_table where column1 not in (select column2 from million_row_table)reading million_row_table into memory is an expensive operation. If there is an index on million_row_table.column2  the query should return a result very quickly despite the large size of million_row_table by doing a single probe into million_row_table via the index.Since in-memory materialization can be an expensive operation  the decision about whether to do it should be made based on query optimizer cost estimates. See SubqueryNode.generateExpression().2) It may not be wise to cache partial query results in memory at all. Although this can help performance in some cases  it also chews up memory. This is different from a limited-size cache with a backing store (like what the store uses for page caching). The language has no way to limit the total amount of memory used in this type of processing. Note that hash joins originally used in-memory hash tables with no backing store  and that a backing store was added later.3) The implementation of this optimization has some problems. The decision to materialize the subquery results in memory is made during code generation - all such decisions should be made during the compilation phase. It's not clear to me why materializeResultSetIfPossible() is in BaseActivation - I would expect the of materialization to be done by a type of ResultSet  not by a method in BaseActivation. Also  this method calls getMaxMemoryPerTable() in the OptimizerFactory - nothing in the execution code should refer to anything in the compilation code (perhaps getMaxMemoryPerTable() should be moved somewhere else).", "id": "634"}, "638": {"ground_truth": "0", "bug_report": "Network driver setTransactionIsolation() causes a commit  but does not complete it locally\nWhen autocommit is set to false  a call to setTransactionIsolation using client driver does not end the transaction when the method exits. When a close() is called on the conection  it throws an exception.Running the code below: conn.setAutoCommit(false); conn.setTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED); try{ conn.close(); }catch(SQLException se){ System.out.println('Got exception when closing the connection'); se.printStackTrace(); }with client driver gives:Got exception when closing the connectionorg.apache.derby.client.am.SqlException: java.sql.Connection.close() requested while a transaction is in progress on the connection.The transaction remains active  and the connection cannot be closed.with embedded driver  it works okay and does not throw any exception.", "id": "638"}, "642": {"ground_truth": "0", "bug_report": "SELECT MAX doesn't use indices optimally\nI tried running SELECT MAX on an indexed column in a big (8 GB)table. It took 12 minutes  which is about 12 minutes more than Iexpected.After a bit of investigation  I found out that a full index scan wasperformed because all the rows referenced from the rightmost B-treenode were actually deleted.Possible improvements: 1. Implement backwards scan in the B-trees (this is also suggested in the comments in BTreeMaxScan). 2. Go up to the parent node and down to the next leaf node on the left side  and continue until a valid max value is found. In Derby  traversing up in a B-tree is not allowed  but would it be ok to go up if the latches were kept on the higher-level nodes in the tree? Of course  this would have negative impact on concurrency. 3. Right-to-left traversal on the leaf level is possible (using ControlRow.getLeftSibling())  but will throw an exception if the page cannot be latched without waiting. It is therefore possible to try a right-to-left search for the max value  and only fall back to the left-to-right approach if a conflict arises.", "id": "642"}, "655": {"ground_truth": "0", "bug_report": "getImportedKeys returns duplicate rows in some cases\nI have a database with a large number of tables. I get duplicate rows when I call DatabaseMetaData.getImportedKeys for a particular table. However  if I create the same table with same number of foreign keys in another database (which has fewer number of tables)  then getImportedKeys returns me the correct number of rows. This error seems to happen only when the database has a large number of tables. I will attach a repro for this shortly.", "id": "655"}, "656": {"ground_truth": "1", "bug_report": "SecurityException with accessDeclaredMembers on DatabaseMetaData.getTables.\nThe code to determine the size of a class is using getDeclaredMembers which requires the permission accessDeclaredMembers. Ideally should not require to grant this permission to derby.jar. Need to see whichclass's size was being calculated. The code is not in a priv block which would require granting the permission all the way up the stack.Maybe if the class's declared memebrs can not be accessed and the value can not be pre-calculkated then some estimate could be made. (using public fields?).java.security.AccessControlException: Access denied (java.lang.RuntimePermission accessDeclaredMembers) at java.security.AccessController.checkPermission(AccessController.java:107) at java.lang.SecurityManager.checkPermission(SecurityManager.java:547) at com.ibm.ws.security.core.SecurityManager.checkPermission(SecurityManager.java:188) at java.lang.SecurityManager.checkMemberAccess(SecurityManager.java:1677) at java.lang.Class.checkMemberAccess(Class.java:104) at java.lang.Class.getDeclaredFields(Class.java:508) at org.apache.derby.iapi.services.cache.ClassSize.getSizeCoefficients(Unknown Source) at org.apache.derby.iapi.services.cache.ClassSize.estimateBase(Unknown Source) at org.apache.derby.iapi.store.access.BackingStoreHashtable.&lt;clinit&gt;(Unknown Source) at java.lang.J9VMInternals.initializeImpl(Native Method) at java.lang.J9VMInternals.initialize(J9VMInternals.java:148) at org.apache.derby.impl.sql.execute.HashTableResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.JoinResultSet.openRight(Unknown Source) at org.apache.derby.impl.sql.execute.JoinResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(Unknown Source) at org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getTables(Unknown Source)", "id": "656"}, "662": {"ground_truth": "0", "bug_report": "during crash recovery of a drop table  on case insensitive files systems derby may delete wrong file\nSometimes during redo the system will incorrectly remove the file associatedwith a table. The bug requires the following conditions to reproduce:1) The OS/filesystem must be case insensitive such that a request to delete a file named C2080.dat would also remove c2080.dat. This is true in windows default file systems  not true in unix/linux filesystems that I am aware of.2) The system must be shutdown not in a clean manner  such that a subsequent access of the database causes a REDO recovery action of a drop table statement. This means that a drop table statement must have happened since the last checkpoint in the log file. Examples of things that cause checkpoints are: o clean shutdown from ij using the 'exit' command o clean shutdown of database using the 'shutdown=true' url o calling the checkpoint system procedure o generating enough log activity to cause a regularly scheduled checkpoint.3) If the conglomerate number of the above described drop table is TABLE_1  then for a problem to occur there must also exist in the database a table such that it's HEX(TABLE_2) = TABLE_14) Either TABLE_2 must not be accessed during REDO prior to the REDO operation of the drop of TABLE_1 or there must be enough other table references during the REDO phase to push the caching of of the open of TABLE_2 out of cache.If all of the above conditions are met then during REDO the system willincorrectly delete TABLE_2 while trying to redo the drop of TABLE_1.&lt;p&gt;I will be adding the following test to reproduce the problem:1) create 500 tables  need enough tables to insure that conglomerate number 2080 (c820.dat) and 8320 (c2080.dat) exist.2) checkpoint the database so that create does not happen during REDO3) drop table with conglomerate number 2080  mapping to c820.dat. It looks it up in the catalog in case conglomerate number assignment changes for some reason.4) exit the database without a clean shudown  this is the default for test suites which run multiple tests in a single db - no clean shutdown is done. Since we only do a single drop since the last checkpoint  test will cause the drop during the subsequent REDO.5) run next test program dropcrash2  which will cause redo of the drop. At this point the bug will cause file c2080.dat to be incorrectly deleted and thus accesses to conglomerate 8320 will throw container does not exist errors.6) check the consistency of the database which will find the container does not exist error.", "id": "662"}, "665": {"ground_truth": "0", "bug_report": "Remove backup(File ...) methods\nThe code contains backup methods both for specifying the backup directory both as a String and as a File parameter. Only the String versions are currently used. The File versions should be removed to avoid duplication of code etc.Examples of such methods are:BasicDatabase.backupBasicDatabase.backupAndEnableLogArchiveModeRAMAccessManager.backupRAMAccessManager.backupAndEnableLogArchiveModeRawStore.backupAndEnableLogArchiveModeplus corresponding interfaces.", "id": "665"}, "675": {"ground_truth": "0", "bug_report": "Build-time processing of 'metadata.properties' file handles slashes incorrectly.\nAs found and described by Mamta here:http://www.nabble.com/-Derby-573-Optimizer-overrides-and-metadata.properties-files-t460642.htmlDuring the ant build process  Derby's metadata.properties file is modified by the ODBCMetadataGenerator class and that class treats backslashes that occur in the metadata.properties file incorrectly. More specifically  it treats every backslash as the end of a line and thus will translate things likeFROM --DERBY-PROPERTIES joinOrder=FIXED n /intoFROM --DERBY-PROPERTIES joinOrder=FIXED //n /(in other words  escaped characters like '/n' are handled incorrectly)..", "id": "675"}, "680": {"ground_truth": "1", "bug_report": "In ij  executing a prepared statement with numeric/decimal parameter fails with NullPointerException in J2ME/CDC/FP\nNPE is thrown in ij when executing prepared statement which  has numeric/decimal parameters does not return any result setRepro for this problem is the test lang/cast.sql. This test currently fails in CDC/FP.The following lines in the test throw NPE:execute q10 using 'values 123456.78';execute q11 using 'values 123456.78';where q10 is 'prepare q10 as 'insert into t1 (num) values cast(? as numeric(18))';'and q11 is 'prepare q11 as 'insert into t1 (dc) values cast(? as decimal(18))';'The stack trace for failure is:java.lang.NullPointerException at org.apache.derby.impl.tools.ij.util.DisplayMulti(util.java:666) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:398) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:290) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main.main(Main.java:75) at org.apache.derby.tools.ij.main(ij.java:56)This happens in the following code. Since the above prepared statements do not return result sets  call to getMetaData() will return null. But in the code  no check is done to see if getMetaData() returns null before calling getColumnType.------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- // In J2ME there is no object that represents // a DECIMAL value. By default use String to // pass values around  but for integral types // first convert to a integral type from the DECIMAL // because strings like 3.4 are not convertible to // an integral type. switch (ps.getMetaData().getColumnType(c)) { case Types.BIGINT: ps.setLong(c  rs.getLong(c)); break; case Types.INTEGER: case Types.SMALLINT: case Types.TINYINT: ps.setInt(c  rs.getInt(c)); break; default: ps.setString(c rs.getString(c)); break; } -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------", "id": "680"}, "682": {"ground_truth": "0", "bug_report": "Add tests for error codes for severe exceptions\nAdd tests to test error codes for disconnect exceptions and other severe errors for client and embedded drivers.", "id": "682"}, "714": {"ground_truth": "1", "bug_report": "NullPointerException or ClassCastException if UPDATE or DELETE is performed on a diagnostic VTI\nUPDATE and DELETE statements on read-only vtis will hit NullPointerException in insane mode  and ClassCastException in sane mode.ij&gt; delete from new org.apache.derby.diag.TransactionTable();ERROR XJ001: Java exception: ': java.lang.NullPointerException'.While these statements make no sense  a more graceful error should be returned  especially as in insane mode this causes the engine to shutdown. Code already exists to detect this situation but is not being called.Found through adding negative tests for DERBY-571", "id": "714"}, "718": {"ground_truth": "0", "bug_report": "Network client: deleteRow() makes getter methods return nulls for the following rows.\nOn the network driver  the ResultSet.deleteRow() method causes the getXXX() methods in the following rows to return null values. It should be possible to use the getXXX methods after positioning the cursor in the next row. It also has this side effect on other result sets if these are created with the same prepared statement.The repro case is uploaded as an attachment 'testDeleteRow.java'Output of the report case:List all rowsRow: 1: Testing 1Row: 2: Testing 2Row: 3: Testing 3Row: 4: Testing 4Row: 5: Testing 5Row: 6: Testing 6Row: 7: Testing 7Row: 8: Testing 8Row: 9: Testing 9Row: 10: Testing 10List all rows and delete first rowRow: 1: Testing 1Row deleted!Row: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullRow: 0: nullList all rowsRow: 2: Testing 2Row: 3: Testing 3Row: 4: Testing 4Row: 5: Testing 5Row: 6: Testing 6Row: 7: Testing 7Row: 8: Testing 8Row: 9: Testing 9Row: 10: Testing 10", "id": "718"}, "728": {"ground_truth": "0", "bug_report": "Unable to create databases whose name containg Chinese characters through the client driver\nTrying to create a database with the following URL (note the Chinese character in the database name):jdbc:derby://localhost:1527//u4e10;create=truethrows the following exception:----%&lt;----Exception in thread 'main' org.apache.derby.client.am.SqlException: Unicode string can't convert to Ebcdic string at org.apache.derby.client.net.EbcdicCcsidManager.convertFromUCS2(Unknown Source) at org.apache.derby.client.net.Request.writeScalarPaddedString(Unknown Source) at org.apache.derby.client.net.NetConnectionRequest.buildRDBNAM(Unknown Source) at org.apache.derby.client.net.NetConnectionRequest.buildACCSEC(Unknown Source) at org.apache.derby.client.net.NetConnectionRequest.writeAccessSecurity(Unknown Source) at org.apache.derby.client.net.NetConnection.writeServerAttributesAndKeyExchange(Unknown Source) at org.apache.derby.client.net.NetConnection.flowServerAttributesAndKeyExchange(Unknown Source) at org.apache.derby.client.net.NetConnection.flowUSRIDONLconnect(Unknown Source) at org.apache.derby.client.net.NetConnection.flowConnect(Unknown Source) at org.apache.derby.client.net.NetConnection.&lt;init&gt;(Unknown Source) at org.apache.derby.jdbc.ClientDriver.connect(Unknown Source) at java.sql.DriverManager.getConnection(DriverManager.java:525) at java.sql.DriverManager.getConnection(DriverManager.java:193) at jdbctest.Main.main(Main.java:33)----%&lt;----It's possible  however  to create databases using the embedded driver  using an URL like:jdbc:derby:/u4e10;create=trueTested with both 10.1.1.0 and 10.1.2.1 with the same result.Complete code to reproduce the bug:----%&lt;----public static void main(String[] args) throws Exception { Class.forName('org.apache.derby.jdbc.ClientDriver'); Connection conn = DriverManager.getConnection('jdbc:derby://localhost:1527//u4e10;create=true');}----%&lt;----", "id": "728"}, "733": {"ground_truth": "0", "bug_report": "Starvation in RAFContainer.readPage()\nWhen Derby is completely disk bound  threads might be starved inRAFContainer.readPage(). This is a real problem when multiple clientsare repeatedly accessing one or a small number of large tables. Incases like this  I have observed very high maximum response times(several minutes in the worst cases) on simple transactions. Theaverage response time is not affected by this.The starvation is caused by a synchronized block inRAFContainer.readPage(): synchronized (this) { fileData.seek(pageOffset); fileData.readFully(pageData  0  pageSize); }If many threads want to read pages from the same file  there will be along queue of threads waiting for this monitor. Since the Javaspecification does not guarantee that threads waiting for monitors aretreated fairly  some threads might have to wait for a long time beforethey get the monitor. (Usually  a couple of threads get full throughputwhile the others have to wait.)", "id": "733"}, "737": {"ground_truth": "0", "bug_report": "SYSCS_UTIL.SYSCS_COMPRESS_TABLE should create statistics if they do not exist\nThere must be an entry in the SYSSTATISTICS table in order for the cardinality statistics in SYSSTATISTICS to be created with SYSCS_UTIL.SYSCS_COMPRESS_TABLE SYSCS_UTIL.SYSCS_COMPRESS_TABLE should create statistics if they don't exist. The only way to create them if the index was created on an empty table  seems to be to drop and recreate the index after the table has been loaded.The documentation will also need updating if this change is made.http://db.apache.org/derby/docs/10.1/tuning/ctunstats57373.html", "id": "737"}, "744": {"ground_truth": "0", "bug_report": "Problem setting sanity state to false by using 'ant -Dsane=false'\nProblem report from Kathey Marsden:There seems to be some sort of problem with the sanity state.After ant clobber  rm -rf jars  rm -rf snapshot no apparent problematicfiles  ant -Dsane=false snapshot seemed to sometimes build the jars tothe sane jar directory and yield the following error..... &#91;delete&#93; Deleting directory D:/svn/opensource/10.1/javadoc/sourcedir &#91;mkdir&#93; Created dir: D:/svn/opensource/10.1/snapshotBUILD FAILEDD:/svn/opensource/10.1/build.xml:1287:D:/svn/opensource/10.1/jars/insane not found.A reliable workaround was to runant insanebefore ant -Dsane=false snapshot.", "id": "744"}, "781": {"ground_truth": "0", "bug_report": "Materialize subqueries in select list where possible to avoid creating invariant resultsets many times.\nDerby's handling of union subqueries in from list can be improved by materializing invariant resultsets once  rather than creating them many times.For example:create view V1 as select i  j from T1 union select i j from T2;create view V2 as select a b from T3 union select a b from T4;insert into T1 values (1 1)  (2 2)  (3 3)  (4 4)  (5 5);For a query like select * from V1  V2 where V1.j = V2.b and V1.i in (1 2 3 4 5)  it is possible the resultset for V2 is created 5 times. (assuming V2 is choosen as the the inner table) This can be very costly if the underlying selects can take long time and also may perform union many times.Enhance materialization logic in setOperatorNode.java. It currently returns FALSE always.public boolean performMaterialization(JBitSet outerTables) throws StandardException{ // RESOLVE - just say no to materialization right now - should be a cost based decision return false; /* Actual materialization  if appropriate  will be placed by our parent PRN. This is because PRN might have a join condition to apply. (Materialization can only occur before that. */ //return true;}", "id": "781"}, "783": {"ground_truth": "0", "bug_report": "Enhance ALTER TABLE syntax to allow users to change the next value to be generated for an identity column\nDerby allows a user to change the interval between consecutive values of the identity column using ALTER TABLE. But there is no way to change the next value to be generated for an identity column. Such a support in Derby will be very handy for tables with identity column defined as GENERATED BY DEFAULT and with a unique key defined on them. Column defined with GENERATED BY DEFAULT allows system to generate values for them or allows the user to manually supply the value for them. A column defined this way is very useful when the user might want to import some data into the generated column manually. But this can create problems when the system generated values conflict with manually inserted values.egautocommit on;create table tauto(i int generated by default as identity  k int); create unique index tautoInd on tauto; insert into tauto(k) values 1 2; &#8211; let system generate values for the identity column&#8211; now do few manual inserts into identity columninsert into tauto values (3 3); insert into tauto values (4 4); insert into tauto values (5 5); insert into tauto values (6 6); insert into tauto values (7 7); insert into tauto values (8 8); &#8211; notice that identity column at this point has used 1 through 8&#8211; now if the user wants to let the system generate a value  system will generate 3 but that is already used and hence&#8211; insert will throw unique key failure exception. System has consumed 3 at this point.insert into tauto(k) values 9;&#8211; the insert above will continue to fail with the unique key failure exceptions until system has consumed all the values till 8&#8211; If we add ALTER TABLE syntax to allow changing the next value to be generated  then user can simply use that to change&#8211; next value to be generated to 9 after the manual inserts above and then insert into tauto(k) values 9 will not failSQL standard syntax for changing the next generated valueALTER TABLE &lt;tablename&gt; ALTER &lt;columnName&gt; RESTART WITH integer-constant", "id": "783"}, "787": {"ground_truth": "0", "bug_report": "cursor closed as a sideeffect of closing another cursor with the same name on another connection\nI was writing some tests for the Scrollable updatable ResultSet feature  and found some tests failing with ERROR XCL07: Cursor 'SQLCUR0' is closed. Verify that autocommit is OFF.in ResultSet.updateRow(). The test does the following:1. set up a connection  and run a query which selects one tuple2. update the tuple using updateXXX and updateRow3. rollback the transaction and close the connectionThen  repeat the process  however this time use a different string in the query. This time updateRow() may fail with the error above. The problem has been reproduced on forward only  updatable resultsets.Workaround:It does not seem to fail if Ia  set another cursorname on the statement object b  use the same query string.I will attach the program to reproduce the problem. Below is the output:~:/&lt;3&gt;db-derby-10.1.2.1-bin/lib&gt; java -cp /home/ak136785/devel/derbytesting/derbytest/build/classes/:derby.jar derbytest.CursorIsClosedIssue1 1 19 Tuple 12 2 21 Tuple 2ERROR XCL07: Cursor 'SQLCUR0' is closed. Verify that autocommit is OFF. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.sql.execute.CurrentOfResultSet.getCursor(Unknown Source) at org.apache.derby.impl.sql.execute.CurrentOfResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.NormalizeResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.UpdateResultSet.setup(Unknown Source) at org.apache.derby.impl.sql.execute.UpdateResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedResultSet.updateRow(Unknown Source) at derbytest.CursorIsClosedIssue.runTest(CursorIsClosedIssue.java:80) at derbytest.CursorIsClosedIssue.main(CursorIsClosedIssue.java:103)", "id": "787"}, "801": {"ground_truth": "0", "bug_report": "Allow parallel access to data files.\nDerby currently serializes accesses to a data file. For example  theimplementation of RAFContainer.readPage is as follows: synchronized (this) { // 'this' is a FileContainer  i.e. a file object fileData.seek(pageOffset); // fileData is a RandomAccessFile fileData.readFully(pageData  0  pageSize); }I have experiemented with a patch where I have introduced several filedescriptors (RandomAccessFile objects) per RAFContainer. These areused for reading. The principle is that when all readers are busy  areadPage request will create a new reader. (There is a maximum numberof readers.) With this patch  throughput was improved by 50% onlinux. For more discussion on this  seehttp://www.nabble.com/Derby-I-O-issues-during-checkpointing-t473523.htmlThe challenge with the suggested approach is to make a mechanism tolimit the number of open file descpriptors. Mike Matrigali hassuggested to use the existing CacheManager infrastructure for thispurpose. For a discussion on that  see:http://www.nabble.com/new-uses-for-basic-services-cache---looking-for-advice-t756863.html", "id": "801"}, "806": {"ground_truth": "0", "bug_report": "One each deleted or updated from a heap row a new RowPosition object is created.\nSee the new RowPosition in GenericConglomerateController.delete and replace. The fetch methods also have new RowPosition calls but in general these calls are not made for scans.Can a single RowPosition object be re-used across the life of the query?In general Derby should try to avoid creating objects per row in any statement as the gc overhead when operating on a large number of rows can be high.", "id": "806"}, "809": {"ground_truth": "0", "bug_report": "Incorrect documentation for 'NetworkServerControl.logConnections(boolean)'\nThe documentation for 'NetworkServerControl.logConnections(boolean)' states that Derby logs both connections and disconnections. As of 10.1.2.1 and (all) earlier releases  this is not true. The documentation should be corrected to avoid confusing users.The thought of adding logging of disconnections has also been posted on derby-dev.Byran Pendleton identified the following documentation with the incorrect description:http://db.apache.org/derby/javadoc/publishedapi/org/apache/derby/drda/NetworkServerControl.htmlhttp://db.apache.org/derby/docs/10.1/adminguide/radminconfigdb2jdrdalogconnections.htmlhttp://db.apache.org/derby/docs/10.0/manuals/admin/hubprnt23.htmlhttp://db.apache.org/derby/docs/10.1/adminguide/tadminlogfile.htmlShould we fix this in 10.0? If yes  please update fix versions for this issue.", "id": "809"}, "822": {"ground_truth": "0", "bug_report": "Client driver: Pre-fetch data on executeQuery()\nCurrently  the client driver does not pre-fetch data whenexecuteQuery() is called  but it does on the first call toResultSet.next(). Pre-fetching data on executeQuery() would reducenetwork traffic and improve performance.The DRDA protocol supports this. From the description of OPNQRY (openquery): The qryrowset parameter specifies whether a rowset of rows is to be returned with the command. This is only honored for non-dynamic scrollable cursors (QRYATTSNS not equal to QRYSNSDYN) and for non-scrollable cursors conforming to the limited block query protocol. The target server fetches no more than the requested number of rows. It may fetch fewer rows if it is restricted by extra query block limits  or if a fetch operation results in a negative SQLSTATE or an SQLSTATE of 02000.", "id": "822"}, "856": {"ground_truth": "0", "bug_report": "modify setCharacterStreamInternal to take a long for the length  and perform the > max int check in the method\nA similar change to setBinaryStreamInternal is being handled as part of DERBY-599.", "id": "856"}, "857": {"ground_truth": "1", "bug_report": "LDAP user authentication fails under a security manager\nRunning the test jdbcapi/secureUsers1.sql with a security manager results in:&gt; ERROR 08004: Connection refused : javax.naming.CommunicationException: noSuchMachine:389 &#91;Root exception is java.security.AccessControlException: access denied (java.net.SocketPermission noSuchMachine resolve)&#93;Adding this permission to the policy file has no effect. which means a priv block is required around the LDAP call.permission java.net.SocketPermission 'noSuchMachine'  'resolve';", "id": "857"}, "861": {"ground_truth": "0", "bug_report": "Intermittent failure of store/readlocks.sql\nThe store/readlocks.sql test in derbyall fails intermittently with the following diff:     Start: readlocks jdk1.3.1_15 storeall:storemore 2006-01-22 03:25:51 ***19532a19533&gt; APP |UserTran|ROW |1 |S |A |(2 6) |GRANT|ACTIVE Test Failed. End: readlocks jdk1.3.1_15 storeall:storemore 2006-01-22 03:30:30 ***    i.e. it looks like there is an extra lock in the printed lock table.", "id": "861"}, "892": {"ground_truth": "0", "bug_report": "add mechanism for specifying policy file for individual function tests\nIt would be nice to be able to specify a test-specific policy file.This should get handled similar to existing properties  i.e. get specified in a test_app.properties file (or  for a suite  in the suite.properties file). The file should then be copied into the correct place.Note  that the 'old' functionTests harness (as opposed to junit tests) includes a check for a property called 'serverPolicyFile' (in harness/jvm.java). The name is a left over from when the policy file was only used for/by network server  and should be renamed - derbyTestPolicyFile  for instance. It is not used anywhere at present  and not specific to network server. It would be nice if this could be expanded  or  if not used  removed.The default policy file used is the derby_tests.policy file under functionTests/util.Also  currently  the property can only be used with RunTest - for further traction  it should probably get passed on through RunSuite/RunList.Once confirmed to be working  the property should get documented in &lt;trunk&gt;/java/testing/README.htm.", "id": "892"}, "903": {"ground_truth": "0", "bug_report": "Remove use of String(byte[]) and String(byte[]  int  int) constructors in testing leading to non-portable behaviour\nThese constructors use the Java default platform encoding to convert the bytes to a String  this typically leads to bugs on platforms with different encodings.Replace with code using fixed conversion  or alternative mechanisms. If the call is required its use should be commented as to why it is required.org.apache.derbyTesting.functionTests.tests.jdbcapi.blobclob4BLOBorg.apache.derbyTesting.functionTests.tests.jdbcapi.resultsetorg.apache.derbyTesting.functionTests.tests.lang.coalesceTestsorg.apache.derbyTesting.functionTests.tests.store.streamingColumnI generated this list using the Java search in eclipse for references to the constructorsString(byte[])String(byte[] int int) (no occurrences in java/testing)", "id": "903"}, "904": {"ground_truth": "0", "bug_report": "big decimal error diff in derbyall lang/procedure test run in the DerbyNetClient - jdk1.3 specific\nderby all regression test failure in the following test. Most recently it failed in the 1/27 derby build. It also failed on 1/20. It ran fine on 1/13. Havenot had time to narrow down further. Did note that there is a separate master for this test   but no jdk131 specific masters that I could see.     Start: procedure jdk1.3.1_15 DerbyNetClient derbynetmats:derbynetmats 2006-01-22 05:30:23 ***274 del&lt; EXPECTED SQL Exception: BigDecimal conversion exception &#91;converters&#93; Overflow occurred during numeric data type conversion of '10243'.. See attached Throwable.274a274&gt; EXPECTED SQL Exception: BigDecimal conversion exception &#91;converters&#93; Overflow occurred during numeric data type conversion of '10243'.. See attached Throwable. Caused by exception class org.apache.derby.client.am.ConversionException: &#91;converters&#93; Overflow occurred during numeric data type conversion of '10243'.337 del&lt; EXPECTED SQL Exception: Invalid argument: parameter index 2 is not an OUT or INOUT parameter.337a337&gt; EXPECTED SQL Exception: XN009.S : &#91;0&#93; 2355 del&lt; EXPECTED SQL Exception: BigDecimal conversion exception &#91;converters&#93; Overflow occurred during numeric data type conversion of '102.33'.. See attached Throwable.355a355&gt; EXPECTED SQL Exception: BigDecimal conversion exception &#91;converters&#93; Overflow occurred during numeric data type conversion of '102.33'.. See attached Throwable. Caused by exception class org.apache.derby.client.am.ConversionException: &#91;converters&#93; Overflow occurred during numeric data type conversion of '102.33'.Test Failed. End: procedure jdk1.3.1_15 DerbyNetClient derbynetmats:derbynetmats 2006-01-22 05:31:39 ***", "id": "904"}, "918": {"ground_truth": "1", "bug_report": "introduce a new test type to run junit tests from the current harness\nIt seems to me that for including a new JUnit test into i.e derby-all we need to make a new java class with a main() method  which parses a command line and set up the testsuite and run it  just like any java program. Basically we are running the junit tests as test type 'java'.Instead of having to do this for every junit test going into a derby test suite  I would propose a different strategy.I propose to introduce a new test type called 'junit' (current test types are: sql sql2 unit java multi demo - unit is not junit)Then you can use:java org.apache.derbyTesting.functionTests.harness.RunTest &lt;TestCaseClassName&gt;.junitto run a Junit test - instead of:java org.apache.derbyTesting.functionTests.harness.RunTest &lt;AnotherClassWithMainMethod&gt;.javaWhen starting a test of type junit  the RunTest class may simply use thejunit.textui.TestRunner class  which has a main method which takes a TestCase class name as parameter. The junit.textui.TestRunner runs the tests defined by the suite() method of the TestCase class.I think this strategy will make it easier to integrate new JUnit tests into the current test suites  since it save you the trouble of creating a java class with a main method for every test.", "id": "918"}, "924": {"ground_truth": "0", "bug_report": "new JDBC4 metadata API getFunctions() needs to be implemented\nFor now I am implementing this to return empty result set so at least we're compliant  but we should be able to implement this one", "id": "924"}, "939": {"ground_truth": "1", "bug_report": "NullPointerException at ResultSet.close() time for simple query using UNION and INTERSECT\nIf I set 'derby.language.logQueryPlan' to true and then attempt to execute the following simple query using UNION and INTERSECT  Derby will return the correct results and then  after returning the results  will throw a NullPointerException. This error also occurs for 10.1.To reproduce:&gt; java -Dderby.language.logQueryPlan=true org.apache.derby.tools.ijand then do:create table t1 (i int);create table t2 (j int);create table t3 (a int);ij&gt; select i from t1 union (select j from t2 intersect select a from t3);1-----------0 rows selectedERROR XJ001: Java exception: ': java.lang.NullPointerException'.If I add data  the query will return the correct results  but then throw the NPE.insert into t1 values 1  2  3  4  5;insert into t2 values 2  4  6  8  10;insert into t3 values 2  3  4;ij&gt; select i from t1 union (select j from t2 intersect select a from t3);1-----------123455 rows selectedERROR XJ001: Java exception: ': java.lang.NullPointerException'.The embedded and client stack traces are shown below. Both suggest that the problem occurs during the close of the result set.&#8211; Embedded &#8211;java.lang.NullPointerException at org.apache.derby.impl.sql.execute.rts.RealUnionResultSetStatistics.getStatementExecutionPlanText(RealUnionResultSetStatistics.java:107) at org.apache.derby.impl.sql.execute.rts.RealSortStatistics.getStatementExecutionPlanText(RealSortStatistics.java:124) at org.apache.derby.impl.sql.execute.rts.RunTimeStatisticsImpl.getStatementExecutionPlanText(RunTimeStatisticsImpl.java:293) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.finishAndRTS(BasicNoPutResultSetImpl.java:633) at org.apache.derby.impl.sql.execute.SortResultSet.finish(SortResultSet.java:479) at org.apache.derby.impl.jdbc.EmbedResultSet.close(EmbedResultSet.java:533) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:272) at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:260) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:381) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:434) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:310) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)&#8211; Client &#8211;ERROR (no SQLState): actual code point  4692 does not match expected code point  9224java.sql.SQLException: actual code point  4692 does not match expected code point  9224 at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:280) at org.apache.derby.client.am.ResultSet.close(ResultSet.java:412) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:272) at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:260) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:381) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:434) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:310) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)Caused by: org.apache.derby.client.am.DisconnectException: actual code point  4692 does not match expected code point  9224 at org.apache.derby.client.net.Reply.zThrowSyntaxError(Reply.java:1157) at org.apache.derby.client.net.Reply.parseLengthAndMatchCodePoint(Reply.java:1057) at org.apache.derby.client.net.NetConnectionReply.parseSQLCARD(NetConnectionReply.java:2519) at org.apache.derby.client.net.NetConnectionReply.parseRDBCMMreply(NetConnectionReply.java:200) at org.apache.derby.client.net.NetConnectionReply.readLocalCommit(NetConnectionReply.java:133) at org.apache.derby.client.net.ConnectionReply.readLocalCommit(ConnectionReply.java:42) at org.apache.derby.client.net.NetConnection.readLocalCommit_(NetConnection.java:1347) at org.apache.derby.client.am.Connection.readCommit(Connection.java:624) at org.apache.derby.client.am.Connection.readAutoCommit(Connection.java:614) at org.apache.derby.client.am.ResultSet.readAutoCommitIfNotAutoCommitted(ResultSet.java:509) at org.apache.derby.client.am.ResultSet.readCloseAndAutoCommit(ResultSet.java:474) at org.apache.derby.client.am.ResultSet.flowCloseAndAutoCommitIfNotAutoCommitted(ResultSet.java:455) at org.apache.derby.client.am.ResultSet.closeX(ResultSet.java:425) at org.apache.derby.client.am.ResultSet.close(ResultSet.java:407)ERROR XJ001: DERBY SQL error: SQLCODE: -1  SQLSTATE: XJ001  SQLERRMC: java.lang.NullPointerException&#91;XX&#93; XJ001.Ujava.sql.SQLException: DERBY SQL error: SQLCODE: -1  SQLSTATE: XJ001  SQLERRMC: java.lang.NullPointerException&#91;XX&#93;XJ001.U at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:280) at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:295) at org.apache.derby.client.am.ResultSet.close(ResultSet.java:412) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:272) at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:260) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:381) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:434) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:310) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:60)", "id": "939"}, "961": {"ground_truth": "0", "bug_report": "Error 22001 can include 'XX-RESOLVE-XX' which should be removed\nIn some cases  error 22001 can come up as follows: A truncation error was encountered trying to shrink CHAR () FOR BIT DATA 'XX-RESOLVE-XX' to length 40.This message makes it appear as if there is a column called XX-RESOLVE-XX  however  this string is coming out of SQLBinary.java.It should be removed from the message.Other references for this string are in the masters for updatableResultSet.out  and in the test lang/concateTests.java (referring to DERBY-124).So  running updatableResultSet will generate the message.The stack trace I saw: at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:362) at org.apache.derby.iapi.types.SQLBinary.checkHostVariable(SQLBinary.java:977) at org.apache.derby.exe.ac05550069x0109x5d95xbdfcxffff9c80fb80163.e0 (Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:138) at org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore(RowResultSet.java:155) at org.apache.derby.impl.sql.execute.NormalizeResultSet.getNextRowCore (NormalizeResultSet.java:204) at org.apache.derby.impl.sql.execute.DMLWriteResultSet.getNextRowCore(DMLWriteResultSet.java:123) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:521) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:359) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1142) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1421) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:263)", "id": "961"}, "965": {"ground_truth": "0", "bug_report": "DatabaseMetadata method supportsResultSetConcurrency returns wrong result on network client\nThe DatabaseMetaData method supportsResultSetConcurrency erroneouslyreturns false on the network client for all arguments combination  cfthe attached repro program. The embedded client returns correctresults  viz the output:org.apache.derby.jdbc.ClientDriver:SupportsResultSetConcurrency: TYPE_FORWARD_ONLY CONCUR_READ_ONLY: falseSupportsResultSetConcurrency: TYPE_FORWARD_ONLY CONCUR_UPDATABLE: falseSupportsResultSetConcurrency: TYPE_SCROLL_INSENSITIVE CONCUR_READ_ONLY: falseSupportsResultSetConcurrency: TYPE_SCROLL_INSENSITIVE CONCUR_UPDATABLE: falseSupportsResultSetConcurrency: TYPE_SCROLL_SENSITIVE CONCUR_READ_ONLY: falseSupportsResultSetConcurrency: TYPE_SCROLL_SENSITIVE CONCUR_UPDATABLE: falseorg.apache.derby.jdbc.EmbeddedDriver:SupportsResultSetConcurrency: TYPE_FORWARD_ONLY CONCUR_READ_ONLY: trueSupportsResultSetConcurrency: TYPE_FORWARD_ONLY CONCUR_UPDATABLE: trueSupportsResultSetConcurrency: TYPE_SCROLL_INSENSITIVE CONCUR_READ_ONLY: trueSupportsResultSetConcurrency: TYPE_SCROLL_INSENSITIVE CONCUR_UPDATABLE: falseSupportsResultSetConcurrency: TYPE_SCROLL_SENSITIVE CONCUR_READ_ONLY: falseSupportsResultSetConcurrency: TYPE_SCROLL_SENSITIVE CONCUR_UPDATABLE: falsePresumably  this is wrong in released versions as well.", "id": "965"}, "966": {"ground_truth": "0", "bug_report": "creating a preparedStatement outside of a Global tran using a ClientXADatasource  will result in an 'SqlException: Cannot set holdability'  if the statement  is used in a Global transaction\ncreating a preparedStatement outside of a Global tran using an xa datasource will result in an exception if the statement is used in a Global (i.e. xa transaction).  DERBY-346 and DERBY-8 may be relevant to this issue.User noted 1) setting the holdability on the connection to CLOSE_CURSORS_AT_COMMIT doesn't seem to be taken affect  since the problem is observed to happen even if I set the the holdability to CLOSE_CURSORS_AT_COMMIT before creating the statement. (maybe another bug)2) setting the holdability to close_cursor_at_commit on the PS when creating it  doesn't seem to be affecting the outcome  this  not sure its even honored (maybe another bug)Test case is below:import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.sql.Statement;import javax.sql.XAConnection;import javax.transaction.xa.XAException;import javax.transaction.xa.XAResource;import javax.transaction.xa.Xid;import com.ibm.db2.jcc.DB2Xid;class CursorHoldProblem{ public static PreparedStatement pstmt = null; public static void main (String args [])throws Exception { org.apache.derby.jdbc.ClientXADataSource ds = new  org.apache.derby.jdbc.ClientXADataSource(); System.out.println('getting connection'); ds.setDatabaseName('sample'); //ds.setTraceFile('trace.out'); ds.setConnectionAttributes('create=true'); conn1 = ds.getConnection();System.out.println(conn1.getMetaData().getDatabaseProductVersion()); PreparedStatement ps1 = null; try { System.out.println('creating table'); ps1 = conn1.prepareStatement('CREATE TABLE TAB1(COL1 INT NOT NULL)'); ps1.executeUpdate(); System.out.println('done creating table'); conn1.commit (); } catch (SQLException x) { System.out.println ('table already exists'); conn1.commit(); } XAConnection pc1 = ds.getXAConnection(); XAResource xar1 = pc1.getXAResource(); Xid xid1 = createXid(11); Connection conn = pc1.getConnection(); System.out.println('get Holidability returning: ' + conn.getHoldability()); conn.setHoldability(ResultSet.CLOSE_CURSORS_AT_COMMIT);  //==&gt; setting this has no affect  doSelect(conn  23); xar1.start(xid1  XAResource.TMNOFLAGS); doSomeWork1(conn  66); doSelect(conn  50); xar1.end(xid1  XAResource.TMSUCCESS); int prp1 = xar1.prepare(xid1); System.out.println('prp1 is: ' + prp1); if (prp1 == XAResource.XA_OK) xar1.commit(xid1  false); } private static void doSomeWork1(Connection conn  int deptno) throws SQLException  { Statement stmt = conn.createStatement(); int cnt = stmt.executeUpdate('INSERT INTO tab1 VALUES (' + deptno + ')'); System.out.println('No of rows Affected ' + cnt); stmt.close(); stmt = null; } private static void doSelect(Connection conn  int deptno) throws SQLException  { if (pstmt == null) pstmt = conn.prepareStatement('select * from tab1'); ResultSet rset1 = pstmt.executeQuery(); while (rset1.next()) { System.out.println('==&gt;: ' + rset1.getString(1)); break; }  } static Xid createXid(int bids) throws XAException { byte[] gid = new byte[1]; gid[0] = (byte) 9; byte[] bid = new byte[1]; bid[0] = (byte) bids; byte[] gtrid = new byte[64]; byte[] bqual = new byte[64]; System.arraycopy(gid  0  gtrid  0  1); System.arraycopy(bid  0  bqual  0  1); Xid xid = new DB2Xid(0x1234  gtrid  bqual); return xid; } }", "id": "966"}, "972": {"ground_truth": "0", "bug_report": "tests derbynet/csPrepStmt and prepStmt use mechanisms that are not portable over encodings\nWith zOS  with the classic 32 bit jvm  the tests derbynet/csPrepStmt and prepStmt.java fail because the insert with setAsciiStream of a byte array obtained from a new String.getBytes() (and/or the retrieval of that inserted value) is not ok. No error is returned  but the select shows no value.This is the section in the test csPrepStmt:----------------- ps.setString(10  'column11string'); byte[] c11ba = new String('column11vcstring').getBytes(); int len = c11ba.length; ps.setAsciiStream(11  new ByteArrayInputStream(c11ba)  len);and the value is retrieved using an ResultSet.getString(#)--------------------------28 del&lt; got row: 1 2 3 4 5.0 6.0 7.0 88.88 99.100 column11string  column11vcstring column12lvcstring 0123456789abcdef10111213202020 0123456789abcdef10111213 0123456789abcdef10111213 xxxxxxFILTERED-TIMESTAMPxxxxx-04-12 11:44:30.028a28&gt; got row: 1 2 3 4 5.0 6.0 7.0 88.88 99.100 column11string  column12lvcstring 0123456789abcdef10111213202020 0123456789abcdef10111213 0123456789abcdef10111213 xxxxxxFILTERED-TIMESTAMPxxxxx-04-12 11:44:30.0--------------------(i.e. the string 'column11vcstring' is not in the database)This needs to be replaced by a encoding-neutral (eg. fixed encoding) mechanism and the tests derbynet/prepStmt.java and csPrepStmt.java need to be checked for other non-portable code.", "id": "972"}, "989": {"ground_truth": "0", "bug_report": "unit/daemonService.unit fails intermittently: 'ran out of time'\n'Signature':                 Diff file unit/unit/daemonService.diff             Start: daemonService jdk1.5.0_04 unit:unit 2006-02-14 20:46:42 ***2 del&lt; &#8211; Unit Test T_DaemonService finished2 add&gt; ran out of time&gt; Shutting down due to unit test failure.&gt; Exit due to time bombTest Failed. End: daemonService jdk1.5.0_04 unit:unit 2006-02-14 21:47:13 ***    http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-377800.html &#91;SunOS-5.10 i86pc-i386&#93;", "id": "989"}, "990": {"ground_truth": "0", "bug_report": "store/access.sql fails - incorrect index?\nij&gt; &#8211; should only be 1 distinct row in this table since space used by the &#8211; index should be the same before and after select count(distinct a) from spaceused;'Signature':                 Diff file derbyall/encryptionAll/storemats/storemats/access.diff             Start: access jdk1.5.0_03 storemats:storemats 2006-02-15 05:04:54 ***2756 del&lt; 1 2756a2756&gt; 2 Test Failed. End: access jdk1.5.0_03 storemats:storemats 2006-02-15 05:06:04 ***    http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-377800.html &#91;SunOS-5.10 sun4u-sparc&#93;", "id": "990"}, "998": {"ground_truth": "0", "bug_report": "tests jdbcapi/SURTest.junit and jdbcapi/SURQueryMixTest.junit run twice in derbynetclientmats\nThe tests SURTest.junit and SURQueryMixTest.junit both appear in derbynetclientmats.runall as well as in jdbcapi.runall. So it unnecessarily runs twice  because jdbcapi is already included in the suites in derbynetclientmats.properties. It should be removed from derbynetclientmats.runall.", "id": "998"}, "1007": {"ground_truth": "0", "bug_report": "Optimizer can return incorrect 'best cost' estimates with nested subqueries  which leads to generation of sub-optimal plans.\nWhen optimizing a query that has nested subqueries in it  it's possible that the optimizer for the subqueries will return cost estimates that are lower than what they were actually calculated to be. The result is that the outer query can pick an access plan that is sub-optimal.Filing this jira issue based on the thread '&#91;OPTIMIZER&#93; OptimizerImpl 'best plans' for subqueries?' from derby-dev. Description that follows is pasted from that email:http://article.gmane.org/gmane.comp.apache.db.derby.devel/14836Following example of what I saw when tracing through the code demonstrates the problem.select x1.j  x2.b from (select distinct i j from t1) x1  (select distinct a b from t3) x2where x1.i = x2.a;During optimization of this query we will create three instancesof OptimizerImpl: OI_0: For 'select x1.j  x2.b from x1  x2 where x1.i = x2.a' OI_1: For 'select distinct i j from t1' OI_2: For 'select distinct a b from t3'Query ran against a clean codeline when T1 had 1 row and T3 had 50 000. &#8211; Top-level call is made to the optimize() method of the outermost SelectNode  which creates OI_0. &#8211; OI_0: picks join order {X1  X2} and calls X1.optimizeIt() &#8211; X1: creates OI_1 and makes calls to optimize it. &#8211; OI_1: picks join order {T1} and calls T1.optimizeIt() &#8211; T1: returns a cost of 20. &#8211; OI_1: saves 20 as new best cost and tells T1 to save it. &#8211; X1: calls OI_1.getOptimizedCost()  which returns 20. X1 then returns 20 to OI_0. &#8211; OI_0: calls X2.optimizeIt() &#8211; X2: creates OI_2 and makes calls to optimize it. &#8211; OI_2: picks join order {T3} and calls T3.optimizeIt() &#8211; T3: returns a cost of 64700. &#8211; OI_2: saves 64700 as new best cost and tells T3 to save it. &#8211; X2: calls OI_2.getOptimizedCost()  which returns 64700. X2 then returns 64700 to OI_0. &#8211; OI_0: saves 20 + 64700 = 64720 as new best cost and tells X1 to save 20 and X2 to save 64700. &#8211; OI_0: picks join order {X2  X1} and calls X2.optimizeIt() &#8211; X2: fetches OI_2 and makes calls to optimize it. &#8211; OI_2: picks join order {T3} and calls T3.optimizeIt() &#8211; T3: returns a cost of 10783. &#8211; OI_2: saves 10783 as new best cost and tells T3 to save it. &#8211; X2: calls OI_2.getOptimizedCost()  which returns 10783. X2 then returns 10783 to OI_0. &#8211; OI_0: calls X1.optimizeIt() &#8211; X1: fetches OI_1 and makes calls to optimize it. &#8211; OI_1: picks join order {T1} and calls T1.optimizeIt() &#8211; T1: returns a cost of 1 MILLION!. &#8211; OI_1: rejects new cost (1 mil &gt; 20) and does nothing. &#8211; X1: calls OI_1.getOptimizedCost()  which returns 20. X1 then returns 20 to OI_0...this seems WRONG! &#8211; OI_0: saves 10783 + 20 = 10803 as new best cost and tells X2 to save 10783 and X1 to save 20.So in the end  the outer-most OptimizerImpl chooses join order {X2  X1} because it thought the cost of this join order was only 10783  which is better than 64720. However  the actual cost of the join order was really estimated at 1 million--so the outer OptimizerImpl chose (and will generate) a plan that  according to the estimates  was (hugely) sub-optimal.", "id": "1007"}, "1009": {"ground_truth": "0", "bug_report": "Embedded ResultSet.getStatement() does not return the Statement object that created it  for a connection returned from EmbeddedXADataSource\nMay also be the case for connections obtained from EmbeddedConnectionPoolDataSource.ResultSet.getStatement() is returning the undetlying 'physical' java.sql.Statement object  not the brokered object.Bug as applications can then get at the underlying 'physical' connection and thus continue to use a connection that may have been assigned to someone else. Causes FAIL messages in thenew jdbcapi/XATest  real checks should be added in checkDataSource to ensure all the possibleconnection objects are checked.", "id": "1009"}, "1037": {"ground_truth": "0", "bug_report": "new test lang/ShutdownDatabase.java fails with j2ME\nThe new test lang/ShutdownDatabase.java fails with: java.lang.NoClassDefFoundError: java.sql.DriverThe test needs to be rewritten to take advantage of the TestUtil methods for getting a connection from a datasource or using a driver  similar to e.g. lang/closed.java.The stack trace is like so:java.lang.NoClassDefFoundError: java.sql.Driver at java.lang.ClassLoader.defineClassImpl(Native Method) at java.lang.ClassLoader.defineClass(ClassLoader.java:212) at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:109) at java.net.URLClassLoader.findClassImpl(URLClassLoader.java:1026) at java.net.URLClassLoader$4.run(URLClassLoader.java:557) at java.security.AccessController.doPrivileged(AccessController.java:167) at java.net.URLClassLoader.findClass(URLClassLoader.java:555) at com.ibm.oti.vm.URLSystemClassLoader.findClass(URLSystemClassLoader.java:32) at java.lang.ClassLoader.loadClass(ClassLoader.java:602) at com.ibm.oti.vm.URLSystemClassLoader.loadClass(URLSystemClassLoader.java:65) at java.lang.ClassLoader.loadClass(ClassLoader.java:561) at java.lang.Class.forNameImpl(Native Method) at java.lang.Class.forName(Class.java:116) at org.apache.derby.impl.tools.ij.util.loadDriver(util.java:837) at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:492) at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:573) at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:554) at org.apache.derbyTesting.functionTests.tests.lang.ShutdownDatabase.openConnectionToNewDatabase(ShutdownDatabase.java:530) at org.apache.derbyTesting.functionTests.tests.lang.ShutdownDatabase.testOnlyTransactionWasCommited(ShutdownDatabase.java:151) at org.apache.derbyTesting.functionTests.tests.lang.ShutdownDatabase.testShutDownWithCommitedTransaction(ShutdownDatabase.java:116) at org.apache.derbyTesting.functionTests.tests.lang.ShutdownDatabase.main(ShutdownDatabase.java:86)", "id": "1037"}, "1045": {"ground_truth": "0", "bug_report": "forupdate.sql   holdCursorIJ.sql ..etc are failing when run with 10.1 client againest trunk\nderbynetclientmats/derbynetmats/derbynetmats.fail:lang/forupdate.sql derbynetclientmats/derbynetmats/derbynetmats.fail:lang/holdCursorIJ.sql derbynetclientmats/derbynetmats/derbynetmats.fail:store/holdCursorJDBC30.sql derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/LOBTest.java derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/blobclob4BLOB.java derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/parameterMapping.java derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/setTransactionIsolation.java derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/metadataJdbc20.java derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/connectionJdbc20.javaSample diff :     Start: forupdate jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006-02-23 07:30:19 ***23 del&lt; ERROR 42X01: Syntax error: Encountered '&lt;EOF&gt;' at line 1  column 23.23a23&gt; ERROR 42X01: Syntax error: Encountered '&lt;EOF&gt;' at line 3  column 23.59 del&lt; ERROR (no SQLState): Invalid cursor name 'C1' in the Update/Delete statement.59a59&gt; ERROR 42X30: Cursor 'SQL_CURLH000C1' not found. Verify that autocommit is OFF.132 del&lt; ERROR (no SQLState): Invalid cursor name 'C4' in the Update/Delete statement.132a132&gt; ERROR 42X30: Cursor 'SQL_CURLH000C1' not found. Verify that autocommit is OFF.135 del&lt; ERROR (no SQLState): Invalid cursor name 'C4' in the Update/Delete statement.135a135&gt; ERROR 42X30: Cursor 'SQL_CURLH000C1' not found. Verify that autocommit is OFF.180 del&lt; ERROR 42X01: Syntax error: Encountered '.' at line 1  column 34.180a180&gt; ERROR 42X01: Syntax error: Encountered '.' at line 3  column 34.Test Failed. End: forupdate jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006", "id": "1045"}, "1046": {"ground_truth": "0", "bug_report": "JVMInfo is duplicated in derbyclient.jar\nThe JVMInfo class is included twice in derbyclient.jar  asorg.apache.derby.iapi.services.info.JVMInfo andorg.apache.derby.shared.common.info.JVMInfo. The only one of themactually used by the client code is the one found inorg.apache.derby.shared.common.info.org.apache.derby.iapi.services.info.JVMInfo is also included inderby.jar  so one could run into problems if the classpath containsderbyclient.jar and derby.jar with different versions.", "id": "1046"}, "1052": {"ground_truth": "0", "bug_report": "test jdbcapi/checkDataSource30 and savepointJdbc30_XA fail with remote server with security exceptions\nThe .tmp from the jdbcapi/checkDataSource30.java is:----------------------START XA HOLDABILITY TESTERROR (no SQLState): java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : Connection refusedCompleted checkDataSource30----------------------The .tmp from the jdbcapi/savepointJdbc30_XA.java is:-------------------------------------FAIL &#8211; unexpected exceptionSQLSTATE(null):java.sql.SQLException: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : Connection refused at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:285) at org.apache.derby.client.ClientPooledConnection.&lt;init&gt;(ClientPooledConnection.java:104) at org.apache.derby.client.ClientXAConnection.&lt;init&gt;(ClientXAConnection.java:47) at org.apache.derby.jdbc.ClientXADataSource.getXAConnection(ClientXADataSource.java:50) at org.apache.derby.jdbc.ClientXADataSource.getXAConnection(ClientXADataSource.java:43) at org.apache.derbyTesting.functionTests.tests.jdbcapi.savepointJdbc30_XA.main(savepointJdbc30_XA.java:58)Caused by: org.apache.derby.client.am.DisconnectException: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : Connection refused at org.apache.derby.client.net.NetAgent.&lt;init&gt;(NetAgent.java:113) at org.apache.derby.client.net.NetConnection.newAgent_(NetConnection.java:928) at org.apache.derby.client.am.Connection.initConnection(Connection.java:174) at org.apache.derby.client.am.Connection.&lt;init&gt;(Connection.java:144) at org.apache.derby.client.net.NetConnection.&lt;init&gt;(NetConnection.java:207) at org.apache.derby.client.net.NetXAConnection.&lt;init&gt;(NetXAConnection.java:39) at org.apache.derby.client.ClientPooledConnection.&lt;init&gt;(ClientPooledConnection.java:94) ... 4 more-----------------------------", "id": "1052"}, "1055": {"ground_truth": "1", "bug_report": "Security.AccessControlException in client under SecurityManager when trying to connect using EUSRIDPWD security mechanism\nWhen using EUSRIDPWD security mechanism  the JCE provider is added and since this is not in a privileged block  an accesscontrol exception is raised when trying to connect using EUSRIDPWD security mechanism  when client is run under security manager.Enabled test (T5) in testSecMec.java &gt; T5: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;user=neelima;password=lee;securityMechanism=9 - EXCEPTION Unexpected throwable caught java.security.AccessControlException: access denied (java.security.SecurityPermission insertProvider.SunJCE)", "id": "1055"}, "1062": {"ground_truth": "0", "bug_report": "Change the internal implemetation of SYSCS_INPLACE_COMPRESS_TABLE to share existing alter table\nChange the internal implemetation of SYSCS_INPLACE_COMPRESS_TABLE to share existing alter tablecode. One suggested approach is to use the same mechanism as SYSCS_COMPRESS_TABLE. Suchan implementation would involve:o change the parser for alter table to accecpt some internal only syntax for SYSCS_INPLACE_COMPRESS_TABLEo change the alter table constant action to get the required information for inplace compresso move most of the inplace compress driving code to a routine in alter table execution  following the same coding pattern as existing alter table compress.I believe doing this will have multiple benefits:1) shares existing alter table code  so things like error checking  security management  ... is all done by one piece of code2) by sharing the code I believe the following outstanding JIRA issues will be addressed: DERBY-719  DERBY-720 -3) future changes addressing ddl like grant/revoke will automatically work.", "id": "1062"}, "1064": {"ground_truth": "0", "bug_report": "Delete cascade causes NULL values inserted into table when after delete Trigger fires\nWhen an after delete trigger which inserts into a table is created on a table that has a foreign key that references a primary key and uses the on delete cascade constraint  nulls are inserted into the table by the trigger.The SQL below shows that the cascade delete works correctly:ij&gt; CREATE TABLE TABLE1 ( X INT PRIMARY KEY );0 rows inserted/updated/deletedij&gt; CREATE TABLE TABLE1_DELETIONS ( X INT );0 rows inserted/updated/deletedij&gt; CREATE TABLE TABLE2 ( Y INT  CONSTRAINT Y_AND_X FOREIGN KEY(Y) REFERENCES TABLE1(X) ON DELETE CASCADE);0 rows inserted/updated/deletedij&gt; CREATE TABLE TABLE2_DELETIONS ( Y INT );0 rows inserted/updated/deletedij&gt; INSERT INTO TABLE1 VALUES (0);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE2 VALUES (0);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE1 VALUES (1);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE2 VALUES (1);1 row inserted/updated/deletedij&gt; select * from table1;X-----------012 rows selectedij&gt; select * from table2;Y-----------012 rows selectedij&gt; DELETE FROM TABLE1;2 rows inserted/updated/deletedij&gt; select * from table1;X-----------0 rows selectedij&gt; select * from table2;Y-----------0 rows selectedNow insert the rows again  create the triggers  delete the rows from the primary key table  verify the cascade delete worked and observe the values in the tables used by the triggers:ij&gt; INSERT INTO TABLE1 VALUES(0);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE2 VALUES(0);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE1 VALUES(1);1 row inserted/updated/deletedij&gt; INSERT INTO TABLE2 VALUES(1);1 row inserted/updated/deletedij&gt; CREATE TRIGGER TRIGGER1 AFTER DELETE ON TABLE1 REFERENCING OLD AS OLD_ROW FOR EACH ROW MODE DB2SQL INSERT INTO TABLE1_DELETIONS VALUES (OLD_ROW.X);0 rows inserted/updated/deletedij&gt; CREATE TRIGGER TRIGGER2 AFTER DELETE ON TABLE2 REFERENCING OLD AS OLD_ROW FOR EACH ROW MODE DB2SQL INSERT INTO TABLE2_DELETIONS VALUES (OLD_ROW.Y);0 rows inserted/updated/deletedij&gt; DELETE FROM TABLE1;2 rows inserted/updated/deletedij&gt; select * from TABLE1;X-----------0 rows selectedij&gt; select * from TABLE2;Y-----------0 rows selectedij&gt; SELECT * FROM TABLE1_DELETIONS;X-----------012 rows selectedij&gt; SELECT * FROM TABLE2_DELETIONS;Y-----------NULLNULLThe TABLE2_DELETIONS table contains NULLs instead of the correct values which should be 0 and 1.", "id": "1064"}, "1072": {"ground_truth": "0", "bug_report": "Misleading/wrong error message while dropping a view\nwhile dropping a view which does not really exist on a database   the error message thrown by ij says ERROR X0X05: Table 'VIEW222' does not exist. It looks like we should make the error message to say that 'Table/View' does not exist  instead of 'table'.Look at other messages that are shared for both Table and View.", "id": "1072"}, "1089": {"ground_truth": "1", "bug_report": "Derby fails inserting a join into a table with a generated column\nI've been having a problem inserting the result of a join into a table with a generated column. If I rephrase the join clause into a where clause  the problem goes away. And it only seems to happen if the target table has a generated column. Unfortunately  the join that I want to do in my application is pretty complex so I don't think I can rephrase it. But here's a very simplified example of what I'm talking about:ij version 10.1ij&gt; connect 'jdbc:derby:test;create=true';ij&gt; create table source (source_id int not null primary key);0 rows inserted/updated/deletedij&gt; insert into source values (0);insert into source values (1);insert into source values (2);insert into source values (3);insert into source values (4);insert into source values (5);insert into source values (6);insert into source values (7);insert into source values (8);insert into source values (9);1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; 1 row inserted/updated/deletedij&gt; create table dest (dest_id int not null primary key generated always as identity source_id_1 int not null source_id_2 int not null);0 rows inserted/updated/deletedij&gt; select s1.source_id  s2.source_idfrom source as s1join source as s2on 1 = 1;SOURCE_ID |SOURCE_ID-----------------------0 |00 |10 |20 |30 |40 |50 |60 |70 |80 |91 |01 |11 |21 |31 |41 |51 |61 |71 |81 |92 |02 |12 |22 |32 |42 |52 |62 |72 |82 |93 |03 |13 |23 |33 |43 |53 |63 |73 |83 |94 |04 |14 |24 |34 |44 |54 |64 |74 |84 |95 |05 |15 |25 |35 |45 |55 |65 |75 |85 |96 |06 |16 |26 |36 |46 |56 |66 |76 |86 |97 |07 |17 |27 |37 |47 |57 |67 |77 |87 |98 |08 |18 |28 |38 |48 |58 |68 |78 |88 |99 |09 |19 |29 |39 |49 |59 |69 |79 |89 |9100 rows selectedij&gt; insert into dest (source_id_1  source_id_2)select s1.source_id  s2.source_idfrom source as s1join source as s2on 1 = 1;ERROR XJ001: Java exception: ': java.lang.NullPointerException'.ij&gt;derby.log:----------------------------------------------------------------2006-03-07 20:01:12.152 GMT:Booting Derby version The Apache Software Foundation - Apache Derby - 10.1.2.1 - (330608): instance c013800d-0109-d64c-5067-000000172958on database directory D:/Documents and Settings&#42;**/My Documents/testDatabase Class Loader started - derby.database.classpath=''2006-03-07 20:01:52.671 GMT Thread&#91;main 5 main&#93; (XID = 124)  (SESSIONID = 0)  (DATABASE = test)  (DRDAID = null)  Cleanup action starting2006-03-07 20:01:52.671 GMT Thread&#91;main 5 main&#93; (XID = 124)  (SESSIONID = 0)  (DATABASE = test)  (DRDAID = null)  Failed Statement is: insert into dest (source_id_1  source_id_2)select s1.source_id  s2.source_idfrom source as s1join source as s2on 1 = 1java.lang.NullPointerExceptionat org.apache.derby.impl.sql.compile.ResultColumnList.remapColumnReferencesToExpressions(Unknown Source)at org.apache.derby.impl.sql.compile.JoinNode.flatten(Unknown Source)at org.apache.derby.impl.sql.compile.FromList.flattenFromTables(Unknown Source)at org.apache.derby.impl.sql.compile.SelectNode.preprocess(Unknown Source)at org.apache.derby.impl.sql.compile.SingleChildResultSetNode.preprocess(Unknown Source)at org.apache.derby.impl.sql.compile.DMLStatementNode.optimize(Unknown Source)at org.apache.derby.impl.sql.compile.DMLModStatementNode.optimize(Unknown Source)at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source)at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)at org.apache.derby.tools.ij.main(Unknown Source)Cleanup action completed2006-03-07 20:43:03.759 GMT:Shutting down instance c013800d-0109-d64c-5067-000000172958----------------------------------------------------------------", "id": "1089"}, "1091": {"ground_truth": "0", "bug_report": "Test harness does not pass jvm flags properly if there are more than 1 property in jvm flags\nTo run Derby tests with EMMA for Code coverage  there is a need to set up emma flag -Djvmflags=-Demma.verbosity.level=silent. This is basically to enable EMMA not to print out any messages to avoid having any diffs. This all works fine when running Derby tests with EMMA for jdk142  jdk15  jdk131 etc because there is no other jvm flag that is passed while calling RunSuite Command. Now  while running tests with j2me/cdc/foundation  another value needs to be passed as jvmflag which is-Djvmflags='Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource'.I tried to combine values for both jvm flags as following  but it did not work properly:1. -Djvmflags='-Demma.verbosity.level=silent -Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource'During this run  the value that was further passed while running one test was Djvmflags=''-Demma.verbosity.level=silent'.As you can notice it took jvm flag as '-Demma.verbosity.level=silent 2. -Djvmflags='-Demma.verbosity.level=silent -Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource'During this run  the value that was further passed while running one test was Djvmflags=''-Demma.verbosity.level=silent'.As you can notice it took jvm flag as '-Demma.verbosity.level=silent From the above it looks like test harness needs to be changed so that it can parse multiple values for jvm flags properly.", "id": "1091"}, "1101": {"ground_truth": "0", "bug_report": "ResultSet.getHoldabilty will return incorrect value when the ResultSet is obtained from a procedure call\nEmbedResultSet40.getHoldability returns the holdability of the statement returned by ResultSet.getStatement().When a ResultSet is created by a procedure call  its holdability may not match the holdability of the Statement that called the procedure  which is probably what ResultSet.getStatement() should return.This may not be exposed as a bug yet  but I think this method should be directly obtaining the holdability of the ResultSet using the Activation.getResultSetHoldability() method  rather than through a Statement. Seems a safer approach.", "id": "1101"}, "1107": {"ground_truth": "0", "bug_report": "For existing databases JDBC metadata queries do not get updated properly  between maintenance versions.\nThe JDBC DatabaseMetaData queries are stored as stored prepared statements in the database. If a bug is fixed for any of the metadata calls it can require that these queries be changed. Currently existing databases will not get updated properly if a bug is fixed. Ideally the metadata queries should match the derby version that is running. That way we avoid situations where the query is not compatible with the Derby version running.To confirm I :1) created a database with 10.1.1.02) Made a metadata change in my 10.1.2.4 client.3) Connected to the 10.1.1.0 database with 10.1.2.4 and saw that there was no change to the stored prepared statements in SYS.SYSSTATEMENTSI also confirmed that a database created with 10.1.2.4 does not get changed when reverting to 10.1.1.0.Below this line is some history and reference that might be helful to someone fixing this issue:------------------------------------------------------------------------------------------------------------------------------------------------In discussing DERBY-970  the subject of the metadata stored prepared statements came up.The general questions are: 1) Why do we use stored prepared statements for metadata queries?  2) What issues might there be related to upgrade/downgrade with the metadata stored prepared statements? 3) How do we address potential upgrade/downgrade issues?GENERAL HISTORY: Cloudscape 5.x had stored prepared statements  a way to store precompiledstatements in the database. This is no longer exposed externally. Metadata stored prepared statements were a performance optimization thatpredated the statement cache. In the past  this performance optimization has been of particular importanceto gui database browsers that execute all the metadata methods on connection to the database. This would still probably be an issue with embedded even with the statement cache. All stored prepared statements get recompiled on the first connection to thedatabase if the version changes.UPGRADE HISTORY In Cloudscape 5.1  the metadata stored prepared statements have traditionallybeen a source of trouble for even minor version changes as queries change or they refer to methods/stored procedures that may or may not exist in the target version and cannot recompile or execute.  The solution to the problem in Cloudscape v5.1.60 was to automaticallyalways call DD_Version.dropJDBCMetadataSPSes() whenever the version changed up or down in upgradeIfNeeded(). The workaround before this change to do this automatically was to call thismethod manually: CALL Factory.getDatabaseOfConnection(). dropAllJDBCMetaDataSPSes()HOW DERBY WORKS TODAY: In Derby we now only call dropJDBCMetadataSPSes() on fullUpgrade and it hasbeen this way since contribution. I think the problems of upgrade/downgrade for metadata stored preparedstatements may exist in Derby. I don't know a workaround to drop the metadata stored prepared statements ifwe need to deliver a bug fix or how the ugprade/downgrade is handled currently. I seem to recall some special handling in Derby for soft upgrade for optimizer directives  but don't know the details.RECENT DISCUSSIONS:In discussing DERBY-970  the subject of the metadata stored prepared statements came up.The general questions are: 1) Why do we use stored prepared statements for metadata queries?  2) What issues might there be related to upgrade/downgrade with the metadata stored prepared statements? 3) How do we address potential upgrade/downgrade issues?MY QUESTIONSAnyone know when/why the dropJDBCMetadataSPSes() on all version changes was removed between Cloudcape 5.1.60 and contribution? How do we deliver bug fixes for metadata queries or handle changes in the metadata queries in Derby?", "id": "1107"}, "1113": {"ground_truth": "0", "bug_report": "transaction logs files requried for recovery are getting deleted when backup and checkpointas are running in parallel.\n----------------------------------------------------------------2006-03-14 19:45:40.573 GMT: Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.0.0 alpha - (1): instance c013800d-0109-fa4a-bf58-0000001078a0on database directory E:/", "id": "1113"}, "1127": {"ground_truth": "0", "bug_report": "client gives SqlException for test callable.java and parameterMapping.java on zOS\nOn zOS  the tests callable.java and parameterMapping.java failed with networkserver and the derby client. The failure did not occur with the db2jcc.jar. The stack trace was as follows:org.apache.derby.client.am.SqlException: ^V^V^30^30^D^F^53^F^31^38^31 : at org.apache.derby.client.am.Statement.completeExecute(Statement.java:1139) at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(NetStatementReply.java:296) at org.apache.derby.client.net.NetStatementReply.readExecuteCall(NetStatementReply.java:97) at org.apache.derby.client.net.StatementReply.readExecuteCall(StatementReply.java:74) at org.apache.derby.client.net.NetStatement.readExecuteCall_(NetStatement.java:174) at org.apache.derby.client.am.Statement.readExecuteCall(Statement.java:1105) at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:1426) at org.apache.derby.client.am.CallableStatement.executeX(CallableStatement.java:124) at org.apache.derby.client.am.CallableStatement.execute(CallableStatement.java:114) at org.apache.derbyTesting.functionTests.tests.derbynet.callable.main(Unknown Source)In callable.java  it's this part of the test that caused the failure:------------------------------------------ System.out.println('return value is: ' + cs.getInt(1)); cs.close(); // stmt.execute('DROP FUNCTION method4'); // different parameter types  also method overload stmt.execute('CREATE PROCEDURE method4P(' + 'IN P1 SMALLINT  IN P2 INT  IN P3 BIGINT  IN P4 REAL  ' + 'IN P5 DOUBLE  IN P6 DECIMAL(6 3)  IN P7 DATE  IN P8 TIME  IN P9 TIMESTAMP  IN P10 VARCHAR(20) FOR BIT DATA  ' + 'OUT O1 SMALLINT  OUT O2 INT  OUT O3 BIGINT  OUT O4 REAL  ' + 'OUT O5 DOUBLE  OUT O6 DECIMAL(6 3)  OUT O7 DATE  OUT O8 TIME  OUT O9 TIMESTAMP  OUT O10 VARCHAR(20) FOR BIT DATA' + ') ' + 'EXTERNAL NAME 'org.apache.derbyTesting.functionTests.tests.derbynet.callable.method4'' + ' NO SQL LANGUAGE JAVA PARAMETER STYLE JAVA'); cs = conn.prepareCall('call method4P(?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?)'); cs.setShort(1  (short) 3); cs.setInt(2  4); cs.setLong(3  5); cs.setFloat(4  (float) 6.0); cs.setDouble(5  7.0); cs.setBigDecimal(6  new BigDecimal('88.88')); cs.setDate(7  Date.valueOf('2002-05-12')); cs.setTime(8  Time.valueOf('10:05:02')); cs.setTimestamp(9  Timestamp.valueOf('2002-05-12 10:05:02.000000000')); byte[] ba = new byte&#91;2&#93;; ba&#91;0&#93; = 1; ba&#91;1&#93; = 2; cs.setBytes(10  ba); int n = 10; cs.registerOutParameter (n+1  java.sql.Types.SMALLINT); cs.registerOutParameter (n+2  java.sql.Types.INTEGER); cs.registerOutParameter (n+3  java.sql.Types.BIGINT); cs.registerOutParameter (n+4  java.sql.Types.REAL); cs.registerOutParameter (n+5  java.sql.Types.DOUBLE); cs.registerOutParameter (n+6  java.sql.Types.DECIMAL); cs.registerOutParameter (n+7  java.sql.Types.DATE); cs.registerOutParameter (n+8  java.sql.Types.TIME); cs.registerOutParameter (n+9  java.sql.Types.TIMESTAMP); cs.registerOutParameter (n+10  java.sql.Types.VARBINARY); cs.execute();------------------I found in derby.log a reference to error 22007  (.S.181) - i.e. syntax error on parameter 3 of SYSIBM.SQLCAMESSAGE (yes  this is from last year):-------------------------------2005-09-10 01:56:17.009 GMT Thread&#91;DRDAConnThread_2 5 main&#93; (XID = 110)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = NF000001.G7C1-4327676640608975420{2}) End compiling prepared statement: call method4P(?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?  ?) :End prepared statement2005-09-10 01:56:17.311 GMT Thread&#91;DRDAConnThread_2 5 main&#93; (XID = 110)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = NF000001.G7C1-4327676640608975420{2}) Begin compiling prepared statement: call SYSIBM.SQLCAMESSAGE(? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?) :End prepared statement2005-09-10 01:56:17.429 GMT Thread&#91;DRDAConnThread_2 5 main&#93; (XID = 110)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = NF000001.G7C1-4327676640608975420{2}) End compiling prepared statement: call SYSIBM.SQLCAMESSAGE(? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?) :End prepared statement2005-09-10 01:56:17.831 GMT Thread&#91;DRDAConnThread_2 5 main&#93; (XID = 110)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = NF000001.G7C1-4327676640608975420{2}) Executing prepared statement: call SYSIBM.SQLCAMESSAGE(? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?) :End prepared statement with 16 parameters begin parameter #1: -1 :end parameter begin parameter #2: 11 :end parameter begin parameter #3: ^V^V^30^30^D^F^53^F^31^38^31 :end parameter begin parameter #4: ^43^53^53^31^30^30^31^31 :end parameter begin parameter #5: 0 :end parameter begin parameter #6: 0 :end parameter begin parameter #7: 0 :end parameter begin parameter #8: 0 :end parameter begin parameter #9: 0 :end parameter begin parameter #10: 0 :end parameter beginparameter #11: ^20^20^20^20^20^20^20^20^20^20^20 :end parameter begin parameter#12: ^V^V^30^30^D :end parameter begin parameter #13: null :end parameter beginparameter #14: en :end parameter begin parameter #15: null :end parameter begin----------------------", "id": "1127"}, "1128": {"ground_truth": "0", "bug_report": "jdbc4/TestDbMetaData.java fails because of changes in SQLException text\njdbc4/TestDbMetaData.java fails with the following diff:                 Diff file jdbc4/DerbyNetClient/jdbc4/TestDbMetaData.diff             Start: TestDbMetaData jdk1.6.0-beta2 DerbyNetClient jdbc4:jdbc4 2006-03-16 20:13:06 ***49 del&lt; SQLSTATE(0A000):java.sql.SQLException: 0A000.S : &#91;0&#93; getClientInfoProperties ()50 del&lt; Caused by: org.apache.derby.client.am.SqlException: 0A000.S : &#91;0&#93; getClientInfoProperties ()50a49 50&gt; SQLSTATE(0A000):java.sql.SQLException: Feature not implemented: getClientInfoProperties ().&gt; Caused by: org.apache.derby.client.am.SqlException: Feature not implemented: getClientInfoProperties ().58 del&lt; SQLSTATE(0A000):java.sql.SQLException: 0A000.S : &#91;0&#93; getSchemas (String  String)59 del&lt; Caused by: org.apache.derby.client.am.SqlException: 0A000.S : &#91;0&#93; getSchemas (String  String)59a58 59&gt; SQLSTATE(0A000):java.sql.SQLException: Feature not implemented: getSchemas (String  String).&gt; Caused by: org.apache.derby.client.am.SqlException: Feature not implemented: getSchemas (String  String).Test Failed. End: TestDbMetaData jdk1.6.0-beta2 DerbyNetClient jdbc4:jdbc4 2006-03-16 20:13:16 ***    (http://www.multinet.no/~solberg/public/Apache/DerbyJDK16/testlog/JDK16Jvm1.6SunOS-5.10_i86pc-i386/386413-jdbc4_diff.txt)The failure is caused by changes in MessageUtil which have modified the exception message.", "id": "1128"}, "1129": {"ground_truth": "1", "bug_report": "compatibility tests fail with security related errors.\nA * few* cases:                 Begin: serverVM-1.3_serverTrunk_clientVM-1.3_clientTrunkException in thread 'main' java.lang.NoClassDefFoundError: javax/crypto/IllegalBlockSizeException             End: serverVM-1.3_serverTrunk_clientVM-1.3_clientTrunk                     Begin: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDB2JCCcom.ibm.db2.jcc.c.SqlException: java.net.ConnectException : Error opening socket to server localhost on port 1527 with message : Connection refused at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.main(CompatibilitySuite.java:129)Exception in thread 'main' java.lang.Exception: Error lookup up server info: java.net.ConnectException : Error opening socket to server localhost on port 1527 with message : Connection refused             End: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDB2JCC                     Begin: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDerby10.1.1.0org.apache.derby.client.am.DisconnectException: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : nullException in thread 'main' java.lang.Exception: Error lookup up server info: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : null             End: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDerby10.1.1.0                     Begin: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDerby10.1.2.0org.apache.derby.client.am.DisconnectException: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : nullException in thread 'main' java.lang.Exception: Error lookup up server info: java.security.PrivilegedActionException : Error opening socket to server localhost on port 1527 with message : null             End: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientDerby10.1.2.0                     Begin: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientTrunkException in thread 'main' java.lang.NoClassDefFoundError: javax/crypto/IllegalBlockSizeException             End: serverVM-1.3_server10.0.2.1_clientVM-1.3_clientTrunk                     Begin: serverVM-1.3_server10.0.2.1_clientVM-1.4_clientDB2JCCcom.ibm.db2.jcc.c.SqlException: java.net.ConnectException : Error opening socket to server localhost on port 1527 with message : Connection refused at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.main(CompatibilitySuite.java:129)Exception in thread 'main' java.lang.Exception: Error lookup up server info: java.net.ConnectException : Error opening socket to server localhost on port 1527 with message : Connection refused             End: serverVM-1.3_server10.0.2.1_clientVM-1.4_clientDB2JCC    See e.g.http://www.multinet.no/~solberg/public/Apache/Derby/testlog/SunOS-5.10_i86pc-i386/386871-compatibility_diff.txt inhttp://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-386871.htmlhttp://www.multinet.no/~solberg/public/Apache/DerbyJDK16/testlog/JDK16Jvm1.6SunOS-5.10_i86pc-i386/387016-compatibility_diff.txt inhttp://www.multinet.no/~solberg/public/Apache/DerbyJDK16/Limited/testSummary-current.htmlFirst occurence in svn 386687 &#91;2006-03-17 19:45:55 CET&#93;Changes in http://www.multinet.no/~solberg/public/Apache/Derby/UpdateInfo/386687.txt", "id": "1129"}, "1132": {"ground_truth": "0", "bug_report": "Truncation Error with Concat\nConsider the tableCREATE TABLE CUSTOMER_TABLE ( ID VARCHAR(255) PRIMARY KEY NOT NULL  NAMEZ VARCHAR(255)   COUNTRY VARCHAR(255) )Sql:PreparedStatement ps = conn.prepateStatement ('SELECT * FROM CUSTOMER_TABLE WHERE NAMEZ = VARCHAR ( CAST (? AS VARCHAR(32672) ) || CAST (? AS VARCHAR(32672) ) )' );ps.setString(1  'Alan E. ');ps.setString(2  'Frechette');ps.executeQuery()Error:'A truncation error was encountered trying to shrink VARCHAR 'Alan E. Frechette' to length 15.'getErrorCode()-1getSQLState()22001 Please note that-The query executes ok against DB2 database-The query executes ok if the total length of both the parameters bound is less than 15. That is as follows //Total length of parameters bound = len('Alan E. Fre') = 11 ps.setString(1  'Alan E. '); ps.setString(2  'Fre');-The error occurs both with embedded and network mode of derby-Omitting the casts as follows also gives the same error query: SELECT * FROM CUSTOMER_TABLE WHERE NAMEZ = VARCHAR( 'Frechette' || ? ) error: SQLState: 22001 'A truncation error was encountered trying to shrink VARCHAR 'FrechetteAlan E. ' to length 15'-Using parameter markers for both the variables without cast like as follows results in error query: SELECT * FROM CUSTOMER_TABLE WHERE NAMEZ = ? || ? error: SQLState: 42X35 'It is not allowed for both operands of '||' to be ? parameters.'-Using parameter markers for only one variables without cast like as follows results in error query: SELECT * FROM CUSTOMER_TABLE WHERE NAMEZ = 'Frechette' || ? error:SQLState: 42818 'Comparisons between 'VARCHAR' and 'LONG VARCHAR' are not supported.' -It works to cast to VARCHAR(2000)  but not VARCHAR(2001) or larger. Regardless of length  if it fails  the magic number is always 15.", "id": "1132"}, "1144": {"ground_truth": "0", "bug_report": "With client PooledConnection.getConnection() does not reset holdability and isolation state properly\nI found this issue when working on DERBY-1044 which was filed for the isolation not getting reset for XAConnections.I found that this was a generic issue for PooledConnections and also that holdability was also wrong.The fix proposed for DERBY-1044 should also fix this issue. That bug has the repro for the isolation state issueFor holdability  this code passes for embedded but fails for client: // Test holdability  ConnectionPoolDataSource ds = TestUtil.getConnectionPoolDataSource(p); pc1 = ds.getPooledConnection(); testPooledConnHoldability('PooledConnection'  pc1); pc1.close(); ** @param string @param pc1 */ private static void testPooledConnHoldability(String string  PooledConnection pc1)  throws SQLException Unknown macro: { System.out.println(&quot;n**Test holdability state**&quot;); Connection conn = pc1.getConnection(); conn.setHoldability(ResultSet.CLOSE_CURSORS_AT_COMMIT); // reset the connection and see if the holdability gets reset conn = pc1.getConnection(); int holdability = conn.getHoldability(); if (holdability != ResultSet.HOLD_CURSORS_OVER_COMMIT) { System.out.println('FAIL: Holdability not reset on get Connection'); } else { System.out.println('PASS: Holdability reset on getConnection'); } conn.close(); }", "id": "1144"}, "1152": {"ground_truth": "0", "bug_report": "Failures in sysinfo and sysinfo_withproperties induced by classpath wiring\nIf you wire your classpath together out of the compiled classtree and the checked-in jars  you get the following error in the sysinfo and sysinfo_withproperties tests. You don't see this error if you run against the built Derby jar files:15d14&lt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)43d41&lt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)72d69&lt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)Test Failed.", "id": "1152"}, "1154": {"ground_truth": "0", "bug_report": "derbynet/testSecMec.java fails with Sun JDK 1.3\nderbynet/testSecMec.java fails with Sun JDK 1.3:&lt; SECMEC_EUSRIDPWD:EXCEPTION testSecurityMechanism() Security exception encountered  see next exception for details.&gt; SECMEC_EUSRIDPWD:EXCEPTION testSecurityMechanism() Security exception encountered  see next exception for details. Caused by exception class java.security.NoSuchProviderException: null... (and so forth)Does not fail with 1.4  so probably just a master update.", "id": "1154"}, "1155": {"ground_truth": "0", "bug_report": "Separate XAResource from EmbedXAConnection\njdbc4.0 introduces two new methods in javax.sql.PooledConnection. Due to this a new implementation of PooledConnection and XAConnection for jdbc4.0 is required. According to current hierarchy XAConnection extends from PooledConnection. Going by similar hierarchy for new classes PooledConnection40 will extend from PooledConnection and XAConnection40 will be extending from PooledConnection40. This structure forces to replicate all the methods of XAConnection to be present in XAConnection40 too. In the current implementation EmbedXAConnection itself is XAResource. This will cause to replicate all the XAResource methods to be present in XAConnection40. Separating these two implementation will save replication of lots of methods.See the comments on jira issue 1137 for some more discussion about this issue.", "id": "1155"}, "1156": {"ground_truth": "1", "bug_report": "allow the encrypting of an existing unencrypted db and allow the re-encrypting of an existing encrypted db\nencrypted database to be re-encrypted with a new password.Here are some ideas for an initial implementation.The easiest way to do this is to make sure we have exclusive access to thedata and that no log is required in the new copy of the db. I want to avoidthe log as it also is encrypted. Here is my VERY high level plan:1) Force exclusive access by putting all the work in the low level store  offline boot method. We will do redo recovery as usual  but at the end there will be an entry point to do the copy/encrypt operation.copy/encrypt process:0) The request to encrypt/re-encrypt the db will be handled with a new set of url flags passed into store at boot time. The new flags will provide the same inputs as the current encrypt flags. So at high level the request will be 'connect db old_encrypt_url_flags; new_encrypt_url_flags'. TODO - provide exact new flag syntax.1) Open a transaction do all logged work to do the encryption. All logging will be done with existing encryption.2) Copy and encrypt every db file in the database. The target files will be in the data directory. There will be a new suffix to track the new files  similar to the current process used for handling drop table in a transaction consistent manner without logging the entire table to the log. Entire encrypted destination file is guaranteed synced to disk before transaction commits. I don't think this part needs to be logged. Files will be read from the cache using existing mechanism and written directly into new encrypted files (new encrypted data does not end up in the cache).3) Switch encrypted files for old files. Do this under a new log operation so the process can be correctly rolled back if the encrypt db operation transaction fails. Rollback will do file at a time switches  no reading of encrypted data is necessary.4) log a 'change encryption of db' log record  but do not update system.properties with the change.5) commit transaction.6) update system.properties and sync changes.7) TODO - need someway to handle crash between steps 5 and 6.6) checkpoint all data  at this point guaranteed that there is no outstanding transaction  so after checkpoint is done there is no need for the log.ISSUES:o there probably should be something that catches a request to encrypt to whatever db was already encrypted with.", "id": "1156"}, "1157": {"ground_truth": "0", "bug_report": "Helper methods in BaseJDBCTestCase for creating data sources\nBaseJDBCTestCase should be extended with methods that create DataSource  ConnectionPoolDataSource and XADataSource objects.", "id": "1157"}, "1159": {"ground_truth": "0", "bug_report": "PreparedStatement.executeUpdate throws a XJ05C exception in a global transaction if the statement is HOLD_CURSORS_OVER_COMMIT\nSQLSTATE(XJ05C): Cannot set holdability ResultSet.HOLD_CURSORS_OVER_COMMIT for a global transaction.Exception is thrown in client  in embedded the statement executes successfully.Since HOLD_CURSORS_OVER_COMMIT only applies to ResultSets and executeUpdate states it only succeeds if the statementdoes not generate ResultSets  then this combination should succeed.Probably related to the fact that in embedded an execute() call on the same PreparedStatement will thrown a XJ05C exceptionWorkaround is to prepare the statement explicitly with CLOSE_CURSORS_AT_COMMIT.", "id": "1159"}, "1174": {"ground_truth": "1", "bug_report": "NullPointerException in network server with LDAP authentication\nWhile trying to fix DERBY-1000 I tried to set up Derby's network server to use LDAP authentication  but I ran into something that looks like a bug  but could just as well be my own configuration mistake. I would appreciate any help in figuring this out. =)The problem is a NullPointerException in the Network Server when it tries to initialize the LDAP authentication service. The attached derby.log shows the exception and its stacktrace. The attached derby.properties is what I put in the derby home directory.I'm seeing this problem in the trunk as well as my own build of the 10.1 branch and the 10.1.2.1 release build available from the Derby web site. ( http://db.apache.org/derby/releases/release-10.1.2.1.cgi )The problem is cause by the setInitDirContextEnv method in JNDIAuthenticationSchemeBase receiving a null dbProps argument  which it obviously doesn't expect. Adding a check for a null dbProps argument and returning immediately after creating the initDirContextEnv object fixes the NullPointerException and makes LDAP authentication work for me. This is a reasonable enough robustness fix and shouldn't have any negative impact  but if the source of the problem is that JNDIAuthenticationSchemeBase should never receive that null pointer in the first place  more patching is needed. I'm not sure about this  so I'm leaving it up to the experts to decide this. =)", "id": "1174"}, "1187": {"ground_truth": "0", "bug_report": "defragment of inplace compress pass for described dataset is not freeing up empty pages.\nFor the following script defragment pass is not freeing up the free pages:drop table t1;create table t1 (i integer primary key  j integer  c char(200));insert into t1 values (1  1  'a');insert into t1 (select t1.i + 1  t1.j + 1  t1.c from t1);insert into t1 (select t1.i + 2  t1.j + 2  t1.c from t1);insert into t1 (select t1.i + 4  t1.j + 4  t1.c from t1);insert into t1 (select t1.i + 8  t1.j + 8  t1.c from t1);insert into t1 (select t1.i + 16  t1.j + 16  t1.c from t1);insert into t1 (select t1.i + 32  t1.j + 32  t1.c from t1);insert into t1 (select t1.i + 64  t1.j + 64  t1.c from t1);insert into t1 (select t1.i + 128  t1.j + 128  t1.c from t1);insert into t1 (select t1.i + 256  t1.j + 256  t1.c from t1);insert into t1 (select t1.i + 512  t1.j + 512  t1.c from t1);delete from t1 where i &lt; 512;select cast(conglomeratename as char(12)) as tabname  isindex  cast(numallocatedpages as int) as alloc  numfreepages  cast(numunfilledpages as int) as unfilled  pagesize  estimspacesavingfrom new org.apache.derby.diag.SpaceTable('T1') t order by conglomeratename;CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'  'T1'  1  1  1);select cast(conglomeratename as char(12)) as tabname  isindex  cast(numallocatedpages as int) as alloc  numfreepages  cast(numunfilledpages as int) as unfilled  pagesize  estimspacesavingfrom new org.apache.derby.diag.SpaceTable('T1') t order by conglomeratename;select cast(conglomeratename as char(12)) as tabname  isindex  cast(numallocatedpages as int) as alloc  numfreepages  cast(numunfilledpages as int) as unfilled  pagesize  estimspacesavingfrom new org.apache.derby.diag.SpaceTable('T1') t order by conglomeratename;Here is example output from a run on the trunk:ij&gt; drop table t1;0 rows inserted/updated/deletedij&gt; create table t1 (i integer primary key  j integer  c char(200));0 rows inserted/updated/deletedij&gt; insert into t1 values (1  1  'a');1 row inserted/updated/deletedij&gt; insert into t1 (select t1.i + 1  t1.j + 1  t1.c from t1);1 row inserted/updated/deletedij&gt; insert into t1 (select t1.i + 2  t1.j + 2  t1.c from t1);2 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 4  t1.j + 4  t1.c from t1);4 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 8  t1.j + 8  t1.c from t1);8 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 16  t1.j + 16  t1.c from t1);16 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 32  t1.j + 32  t1.c from t1);32 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 64  t1.j + 64  t1.c from t1);64 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 128  t1.j + 128  t1.c from t1);128 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 256  t1.j + 256  t1.c from t1);256 rows inserted/updated/deletedij&gt; insert into t1 (select t1.i + 512  t1.j + 512  t1.c from t1);512 rows inserted/updated/deletedij&gt; delete from t1 where i &lt; 512;511 rows inserted/updated/deletedij&gt; select cast(conglomeratename as char(12)) as tabname  isindex  cast(numallocatedpages as int) as alloc  numfreepages  cast(numunfilledpages as int) as unfilled  pagesize  estimspacesavingfrom new org.apache.derby.diag.SpaceTable('T1') t order by conglomeratename;TABNAME |ISIND&amp;|ALLOC |NUMFREEPAGES |UNFILLED |PAGESIZE |ESTIMSPACESAVING-------------------------------------------------------------------------------------------------SQL060406034|1 |7 |0 |0 |4096 |0T1 |0 |60 |9 |0 |4096 |368642 rows selectedij&gt; CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP'  'T1'  1  1  1);0 rows inserted/updated/deletedij&gt; select cast(conglomeratename as char(12)) as tabname  isindex  cast(numallocatedpages as int) as alloc  numfreepages  cast(numunfilledpages as int) as unfilled  pagesize  estimspacesavingfrom new org.apache.derby.diag.SpaceTable('T1') t order by conglomeratename;TABNAME |ISIND&amp;|ALLOC |NUMFREEPAGES |UNFILLED |PAGESIZE |ESTIMSPACESAVING-------------------------------------------------------------------------------------------------SQL060406034|1 |7 |0 |1 |4096 |0T1 |0 |69 |0 |0 |4096 |02 rows selectedij&gt;", "id": "1187"}, "1190": {"ground_truth": "0", "bug_report": "Network Server reports wrong product name when logging connections to derby.log\nThe Derby Network Server is symptomatic of dissociative identity disorder when derby.drda.logConnections=true. At startup and shutdown the network server correctly recognizes itself as 'Apache Derby'. When logging connections  however  it thinks it is 'Cloudscape'. See the following derby.log for an example:======= derby.log START ================Apache Derby Network Server - 10.2.0.0 alpha started and ready to accept connections on port 1527 at 2006-04-07 09:09:22.766 GMTConnection number: 1.----------------------------------------------------------------2006-04-07 09:10:02.054 GMT: Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.0.0 alpha - (392214): instance c013800d-010a-739c-e4bf-0000001109c8on database directory /export/home/tmp/test/testDBDatabase Class Loader started - derby.database.classpath=''2006-04-07 09:10:03.287 GMT Thread&#91;DRDAConnThread_3 5 main&#93; (DATABASE = testDB)  (DRDAID = {1})  Cloudscape Network Server connected to database testDB;create=true======= derby.log END ================To reproduce  do the following:1. Start the network server with the property derby.drda.logConnections set to true. An example follows:bash-3.00 $ java -Dderby.drda.logConnections=true -jar ${DERBY_CURRENT}/derbyrun.jar NetworkServerControl startApache Derby Network Server - 10.2.0.0 alpha started and ready to accept connections on port 1527 at 2006-04-07 09:09:22.766 GMTConnection number: 1.2. Use the client driver to connect to the server. An example follows (using IJ):bash-3.00 $ java -jar ${DERBY_CURRENT}/derbyrun.jar ijij version 10.2ij&gt; connect 'jdbc:derby://localhost:1527/testDB;create=true';ij&gt; exit;", "id": "1190"}, "1203": {"ground_truth": "0", "bug_report": "Derby Server and Administration Guide - Servlet interface - Running page\nIn this page is written:1) You can use the running page to stop the server and turn logging and tracing on or off  boot or shut down databases.I installed the servlet in Tomcat  and I can't see any option to boot or shut down databases in this page.2) Test the connection. (If you choose this option  the Test connection page is displayed.)I also can't see any option to test connection in this page.3) Stop the application server.The option is 'Press the button to stop the Network server'  and not the application server.I'm using:--------- Derby Information --------JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&#91;/org/apache/derby/info/DBMS.properties&#93; 10.1.2.1 - (330608)&#91;/org/apache/derby/info/net.properties&#93; 10.1.2.1 - (330608)I don't know if my servlet's version is old  but those things are written in the manual for the version I'm using.I'm sending a diff file to adjust this page to what appears in the servlet I'm using.", "id": "1203"}, "1216": {"ground_truth": "0", "bug_report": "ij should have a --help option to print command line syntax\nij should accept a --help option to print command line syntax for reference and friendliness.", "id": "1216"}, "1219": {"ground_truth": "0", "bug_report": "jdbcapi/checkDataSource.java and jdbcapi/checkDataSource30.java hang intermittently with client\nThe tests checkDataSource.java and checkDataSource30.java hang intermittently especially with jdk 1.5.Attached is the test run output and traces when the server is started separately.1) Enable checkDataSource30.java by taking it out of functionTests/suites/DerbyNetClient.exclude.2) Run the test with client.java -Dij.exceptionTrace=true -Dkeepfiles=true -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest jdbcapi/checkDataSource30.javaAttachements: testfiles_after_hang.zip - Test directory. traces_on_hang.txt - Server side traces obtained by starting the server separately before running the test.I wish I had time to work on this right now as I would really like to see this valuable test in the suite  but hopefully someone else will pick it up.", "id": "1219"}, "1230": {"ground_truth": "0", "bug_report": "Remove the huge log files (TesterN.out) left from running 'stress/stress.multi'\nSee http://www.nabble.com/derbyall-test-uses-%7E11Gb-disk-space-when-run%21-t530808.html#a1433024 :'I discovered that when I now run the derbyall test it uses ~11Gb disk space!I find 4 x 10 '..../multi/Tester*.out' files which each is ~270Mb! (=&gt;10.8Gb.)'I will upload a patch which makes ij/mtTester.java able to tell if the mtTester detected errors  which then is used by harness/MultiTest.java to decide if the .out file can be deleted.mtTester is currently only used by harness/MultiTest.java.", "id": "1230"}, "1231": {"ground_truth": "0", "bug_report": "LIKE does not match empty strings when used with a prepared statement\nLIKE should give true for two 0-length strings. See SQL 2003 Ch. 8.5General Rules 3)c)i)The query SELECT * FROM t WHERE v like ''appears to give me all rows where v is an emptystring  as expected.But a prepared statementSELECT * FROM t WHERE v like ?  with setString(1  '')always returns an empty result set. See attached repro for the full example.", "id": "1231"}, "1235": {"ground_truth": "0", "bug_report": "Move isPoolable() and setPoolable() from PreparedStatement to Statement\nAn upcoming release of jdk1.6 will move isPoolable() and setPoolable() from PreparedStatement to Statement. We should conform.", "id": "1235"}, "1236": {"ground_truth": "0", "bug_report": "Verify that applications can't manipulate the transaction state while inside a distributed transaction.\nThe next rev of the JDBC4 spec will clarify that applications may not call the following methods while inside distributed transactions: setAutoCommit( true )  commit()  rollback()  and setSavepoint(). We should verify that we conform.", "id": "1236"}, "1248": {"ground_truth": "0", "bug_report": "Assert failure in BasePage.shiftUp() when running store/onlineBackupTest4.sql\nI saw this error when I ran derbyall.                 Diff file derbyall/storeall/storemore/onlineBackupTest4.diff             Start: onlineBackupTest4 jdk1.5.0_04 storeall:storemore 2006-04-24 11:51:50 ***68 del&lt; ij(CONNECTION1)&gt; select * from ctest;69 del&lt; ID |NAME 70 del&lt; --------------------------------------------------------------------------------------------------------------------------------------------71 del&lt; 1 |derby backup/compress test &amp;72 del&lt; 2 |derby backup/compress test &amp;73 del&lt; 300 |derby backup/compress test &amp;74 del&lt; 509 |derby backup/compress test &amp;75 del&lt; 510 |derby backup/compress test &amp;76 del&lt; 511 |derby backup/compress test &amp;77 del&lt; 512 |derby backup/compress test &amp;78 del&lt; ij(CONNECTION1)&gt; insert into ctest values(2000  'restore was successfil') ;79 del&lt; 1 row inserted/updated/deleted80 del&lt; ij(CONNECTION1)&gt; 80 add&gt; org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED shiftUp failed  low must be between 0 and recordCount. low = 140  recordCount = 2&gt; ERROR XJ040: Failed to start database 'wombat'  see the next exception for details.&gt; ERROR XJ001: Java exception: 'ASSERT FAILED shiftUp failed  low must be between 0 and recordCount. low = 140  recordCount = 2: org.apache.derby.shared.common.sanity.AssertFailure'.&gt; ij&gt; select * from ctest;&gt; IJ ERROR: Unable to establish connection&gt; ij&gt; insert into ctest values(2000  'restore was successfil') ;&gt; IJ ERROR: Unable to establish connection&gt; ij&gt; Test Failed. End: onlineBackupTest4 jdk1.5.0_04 storeall:storemore 2006-04-24 11:51:56 ***    The test usually succeeds  but I managed to reproduce the failure by running this loop in the shell:touch onlineBackupTest4.passwhile [ -f onlineBackupTest4.pass ]; do rm onlineBackupTest4.pass java org.apache.derbyTesting.functionTests.harness.RunTest store/onlineBackupTest4.sqldone", "id": "1248"}, "1252": {"ground_truth": "0", "bug_report": "Old clients with new server return wrong database metadata values for some methods\nWith an old client (10.1.1  10.1.2) accessing a new (10.2) server some metadata calls will return the wrong value for both the JCC andthe Derby clients: deletesAreDetected(TYPE_SCROLL_INSENSITIVE) -&gt; true updatedAreDetected(TYPE_SCROLL_INSENSITIVE) -&gt; true ownDeletesAreVisible(TYPE_SCROLL_INSENSITIVE) -&gt; true ownUpdatesAreVisible(TYPE_SCROLL_INSENSITIVE) -&gt; trueThis happens because these values were changed for the 10.2 withthe addition of updatable scrollable insensitive result sets (DERBY-775) combined with a weakness in the way the client and the server cooperates to answer these metadata calls.Presently  when the client application invokes these methods  theresults will be returned by the server without regard to the identityof the client  i.e. the 2-tuple {JCC or Derby client  client version}.The values to be returned for the methods in question are based solelyon the values found in the file metadata_net.properties  which is partof the server.In general  some database metadata is dependent on the combination ofthe capabilities in the client and the server and the returned valuesshould reflect this  which in general implies negotiating (down) tovalues which are correct for the actual combination of client andserver.", "id": "1252"}, "1254": {"ground_truth": "0", "bug_report": "XAConnection uses NetConnection as underlying physical connection for JDBC4/Java 1.6\nWhen running under DerbyNetClient (using Derby network server) using Java 1.6  XAConnection.getConnection() returns a NetConnection instance instead of NetConnection40 instance for the underlying 'physical connection'. This causes AbstractMethod errors for calls in LogicalConnection40 (not yet committed). PooledConnection does the correct thing according to the test that revealed this problem.The XAConnection was obtained by using TestUtil.getXADataSource().getXAConnection(). The underlying connection object was then obtained with XAConnection.getConnection().A new ConnectionTest is on the way as part of DERBY-1180. It will be submitted/committed  but not enabled until this bug is fixed.", "id": "1254"}, "1255": {"ground_truth": "0", "bug_report": "Implement new JDBC4 methods for creating empty LOBs in the embedded client\nImplement Connection.createClob() and Connection.createBlob(). Right now these methods are implemented in the network client but not the embedded client.", "id": "1255"}, "1266": {"ground_truth": "0", "bug_report": "Client: Attempted deleteRow or updateRow while on insert row gives wrong error message\nThis fragment from deleteRowX shows the problem:&gt; if (isOnInsertRow_) {&gt; throw new SqlException(agent_.logWriter_  &gt; new MessageId(SQLState.CURSOR_NOT_POSITIONED_ON_INSERT_ROW));&gt; }It should be the opposite: the problem is that the cursor is on theinsert row  not that it isn't.These is a similar error in updateRowX.The client master files for updatableResultSet show the problem  sothe masters are wrong  too.&gt; Negative Test 39.a - run updateRow on insertRow&gt; SQL State: XJ086&gt; Got expected exception: This method cannot be invoked while the cursor is not on the insert row or if the concurrency of this  ResultSet object is CONCUR_READ_ONLY.", "id": "1266"}, "1274": {"ground_truth": "0", "bug_report": "Network Server does not shutdown the databases it has booted when started and shutdown from the command line\nIf network server is started and shutdown from the comand line t does not shutdown the database. This can is evidenced by the fact that the db.lck file remains after the following steps.java org.apache.derby.drda.NetworkServerControl start &amp;&lt;some database access&gt;java org.apache.derby.drda.NetworkServerControl shutdown There is much discussion about the correct behavior of NetworkServer in this regard related to embedded server scenarios in DERBY-51  but it seems clear in this case the databases should be shutdown.", "id": "1274"}, "1276": {"ground_truth": "0", "bug_report": "Calling ResultSet.isLast() on a scrollable insensitive resultset  causes the entire ResultSet to be populated\nThe following is not a bug  however some applications do not always need to scroll to the last row  however they do want to check isLast(). Therefore it is unfortunate that isLast() is expensive. The general logic in ScrollInsensitiveResultSet is to populate rows by demand.The current logic in ScrollInsensitiveResultSet to return true or false on isLast()  is to move to the last row. If the last row is not the same row number as the current  then isLast() returns false. When moving to the last row  all rows will be populated into the BackingStoreHashtable of the ScrollInsensitiveResultSet.This logic may be rewritten to only move to the next row. If the next row exists  isLast() may return false.(note the logic is also optimized to use beforeFirst and afterLast flags)", "id": "1276"}, "1290": {"ground_truth": "0", "bug_report": "Resolve test failures with JCC2.8\nThe following tests fail when run with JCC 2.8 driver:derbynetmats/derbynetmats.fail:jdbcapi/resultset.javaderbynetmats/derbynetmats.fail:jdbcapi/LOBTest.javaderbynetmats/derbynetmats.fail:jdbcapi/parameterMapping.javaderbynetmats/derbynetmats.fail:derbynet/testSecMec.java (fails with Sun JDKs only)", "id": "1290"}, "1308": {"ground_truth": "0", "bug_report": "Tests jdbcapi/HoldabilityTest.junit  jdbcapi/UpdateXXXTest.junit jdbcapi/SURTest.junit fail on wctme5.7_foundation\n05/05/2006 regression test run of derbyall shows the following test failure with wctme5.7_foundation  derbyall/derbyall.fail:jdbcapi/HoldabilityTest.junitderbyall/derbyall.fail:jdbcapi/UpdateXXXTest.junitderbyall/derbyall.fail:jdbcapi/SURTest.junitDiff is a CNFE with ConnectionPoolDataSource.                 Diff file derbyall/jdbcapi/HoldabilityTest.diff             Start: HoldabilityTest jdkJ2ME Foundation Specification v1.0 derbyall:jdbcapi 2006-05-07 11:31:05 ***0 add&gt; Exception in thread 'main' java.lang.NoClassDefFoundError: javax.sql.ConnectionPoolDataSourceTest Failed. End: HoldabilityTest jdkJ2ME Foundation Specification v1.0 derbyall:jdbcapi 2006-05-07 11:31:06 ***    My guess is these tests need to excluded from running in this environment. Can someone please confirm. Thanks.", "id": "1308"}, "1313": {"ground_truth": "0", "bug_report": "SUR: Use DRDA's extended diagnostic to send ROW_UPDATED and ROW_DELETED warnings.\nDetectability of own changes is implemented in the client using warnings cf the write-up for DERBY-775. When a row has been deleted and/or updated  a warning will be sent to the client to indicate that fact. Presently  only one warning can be sent each time a data row is sent from to the client  that means that some warnings may be lost. Using extended diagnostic allows us to send several warnings for each data row.I propose to use extended diagnostics to send ROW_UPDATED and ROW_DELETED warnings when necessary. This may later be extended for other warnings  but I do not plan to do it as a part of the work in this issue.", "id": "1313"}, "1314": {"ground_truth": "0", "bug_report": "Differences between client and embedded when invoking stored procedures using Statement.executeUpdate()\nWhen invoking a stored procedure using Statement.executeUpdate()  theclient driver and the embedded driver behave differently.If the stored procedure does not return any result set  the embeddeddriver returns 0  whereas the client returns -1.If the stored procedure returns one or more result sets  the embeddeddriver returns -1  whereas the client fails with an exception.", "id": "1314"}, "1320": {"ground_truth": "0", "bug_report": "Test lang/procedure.java fails with ibm1.5 jvm\nlang/procedure.java fails on IBM1.5 jvm on linux machine. I spoke to Manjula who filed DERBY-1108 that this is related to that issue and is a JVM bug. The JVM team has been notified. Please note: I have marked this as a Regression Test Failure although this test has not passed with IBM 1.5 JVM atleast in our nightly regression test runs  so it is not a regression of the product. diff:                 Diff file derbyall/derbylang/procedure.diff             Start: procedure jdk1.5.0 derbyall:derbylang 2006-05-10 22:17:16 ***1018 del&lt; testImplicitClose(): PASSED1018 add&gt; testImplicitClose(): FAILED (no exception thrown)Test Failed. End: procedure jdk1.5.0 derbyall:derbylang 2006-05-10 22:17:31 ***    here is machine info.------------------ Java Information ------------------Java Version: 1.5.0Java Vendor: IBM CorporationJava home: /local1/cloudtst/dev/src/ibm15/jreJava classpath: /local1/cloudtst/dev/src/jars/insane/derby.jar:/local1/cloudtst/dev/src/jars/insane/derbytools.jar:/local1/cloudtst/dev/src/jars/insane/derbynet.jar:/local1/cloudtst/dev/src/jars/insane/derbyclient.jar:/local1/cloudtst/dev/src/jars/insane/derbyTesting.jar:/local1/cloudtst/dev/src/jcc/db2jcc.jar:/local1/cloudtst/dev/src/jcc/db2jcc_license_c.jar:/local1/cloudtst/dev/src/jars/insane/derbyTesting.jar:/local1/cloudtst/dev/src/tools/java/jakarta-oro-2.0.8.jar:/local1/cloudtst/dev/src/tools/java/junit.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_de_DE.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_es.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_fr.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_it.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_ja_JP.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_ko_KR.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_pt_BR.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_zh_CN.jar:/local1/cloudtst/dev/src/jars/insane/derbyLocale_zh_TW.jar:/local1/cloudtst/dev/src/jars/insane/derbyrun.jar:OS name: LinuxOS architecture: x86OS version: 2.6.5-7.252-bigsmpJava user name: cloudtstJava user home: /u/cloudtstJava user dir: /local1/cloudtst/dev/src/NightlyBuildResults.2006-05-10/ibm15_derbyalljava.specification.name: Java Platform API Specificationjava.specification.version: 1.5--------- Derby Information --------JRE - JDBC: J2SE 5.0 - JDBC 3.0&#91;/local1/cloudtst/dev/src/jars/insane/derby.jar&#93; 10.2.0.0 alpha - (405653)&#91;/local1/cloudtst/dev/src/jars/insane/derbytools.jar&#93; 10.2.0.0 alpha - (405653)&#91;/local1/cloudtst/dev/src/jars/insane/derbynet.jar&#93; 10.2.0.0 alpha - (405653)&#91;/local1/cloudtst/dev/src/jars/insane/derbyclient.jar&#93; 10.2.0.0 alpha - (405653)&#91;/local1/cloudtst/dev/src/jcc/db2jcc.jar&#93; 2.6 - (90)&#91;/local1/cloudtst/dev/src/jcc/db2jcc_license_c.jar&#93; 2.6 - (90)------------------------------------------------------", "id": "1320"}, "1322": {"ground_truth": "0", "bug_report": "Missing resets of isOnInsertRow state in net client when navigating away via other than ResultSet#next\nPlease see the enclosed repro program.When attempting the deleteRow  it will fail with SQL state 24000 'nocurrent row'  since the first() call doesn't properly reset theIsOnInsertRow_ state. By inspection of ../am/ResultSet.java I foundthe other positioning calls beside next and moveToCurrentRow to sufferthe same problem.", "id": "1322"}, "1324": {"ground_truth": "0", "bug_report": "Need to remove old copyright notice\nAn IBM copyright is in these files:derby/code/trunk/tools/jar/copyright.txtderby/code/branches/10.1/tools/jar/copyright.txtderby/code/branches/10.0/tools/jar/copyright.txt'svn log' shows it was part of the original code contribution &#8211; I think this was just missed in the copyright cleanup.There also exists reference to CPL injava/drda/org/apache/derby/impl/drda/EbcdicCcsidManager.java(22): http://www.ibm.com/developerworks/oss/CPLv1.0.htmMore references:java/engine/org/apache/derby/database/Database.java(47): * &lt;I&gt;IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/database/UserUtility.java(41): IBM Corp. reserves the right java/engine/org/apache/derby/iapi/db/ConnectionInfo.java(40): * &lt;i&gt;IBM Corp. reserves the right to change  rename or remove this class orjava/engine/org/apache/derby/iapi/db/ConsistencyChecker.java(70): * &lt;I&gt;IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/iapi/db/Factory.java(58): * &lt;I&gt;IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/iapi/db/PropertyInfo.java(54): * &lt;I&gt;IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/iapi/db/TriggerExecutionContext.java(32): * &lt;I&gt;IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/impl/sql/compile/AggregateDefinition.java(46): * &lt;I&gt; IBM Corp. reserves the right to change  rename  orjava/engine/org/apache/derby/vti/VTICosting.java(40): * &lt;I&gt;IBM Corp reserves the right to change  rename  orjava/engine/org/apache/derby/vti/VTIEnvironment.java(29): * &lt;I&gt;IBM Corp. reserves the right to change  rename  or", "id": "1324"}, "1325": {"ground_truth": "0", "bug_report": "Isolation level of local connection does not get reset after exiting a global transaction if the isolation level was changed using SQL\nIf we update the isolation level using SQL instead of JDBC and then join/resume a global transaction  on ending the transaction  the isolation level of the local connection is not restored. The problem seems to be in EmbedXAResource. So it happens with both embedded and client driver. Client driver internally uses SQL to set the transaction isolation. So the problem is more likely to be hit with the client. I will attach a repro and a draft patch with more details.", "id": "1325"}, "1327": {"ground_truth": "0", "bug_report": "Identity column can be  created with wrong and very large start with value with  'J2RE 1.5.0 IBM Windows 32 build pwi32dev-20060412 (SR2)' with JIT on\nUsing the following JRE with JIT on an identity column may be created with a wrong and very large START WITH value. When the problem occurs it affects not only the table being created  but also other tables that were created in previous transactions.For example attempting to create 1000 tables with identity columns the 126th table creation changes the start with value in sys.syscolumns to 41628850257395713 for ALL 125 tables. Attempts to insert into any of the tables cause'SQL Exception: A truncation error was encountered trying to shrink ... to length 12.' This program will create up to 1000 tables until the problem occursNote: The problem does not occur with -Xnojit (JIT OFF) The problem  when it occurs  changes not only the table beingcreated but all previous tables created. See output below. Every thing was fine up until mytable126 and then all the tables got changed to start with 41628850257395713  Problem occurs with autocommit on/off. The problem occurs after the create table but before thecommit. If the non-identity columns are removed the problem does notreproduce.import java.sql.DatabaseMetaData;import java.sql.ResultSet;import java.sql.SQLException;import java.sql.Statement;import java.sql.DriverManager;public class BadStartWith{ public static void main (String args [])throws Exception  { testBadStartWith(); } /** After some number of table creations with JIT turned on  the START WITH value for the table being created and all the ones already created gets mysteriously changed with pwi32dev-20060412 (SR2)  @throws Exception */ public static void testBadStartWith() throws Exception { Class.forName('org.apache.derby.jdbc.EmbeddedDriver').newInstance(); Connection conn = DriverManager.getConnection('jdbc:derby:wombat;create=true'); conn.setAutoCommit(false); Statement stmt = null; DatabaseMetaData md = conn.getMetaData() ; System.out.println(md.getDatabaseProductVersion()); System.out.println(md.getDatabaseProductName()); System.out.println(md.getDriverName()); dropAllAppTables(conn); System.out.println('Create tables until we get a wrong Start with value'); stmt = conn.createStatement(); // numBadStartWith will be changed if any columns get a bad start with value. int numBadStartWith = 0;  try { // create 1000 tables. Break out if we get a table that has a bad // start with value. for (int i = 0; (i &lt; 1000) &amp;&amp; (numBadStartWith == 0); i++) { String tableName = 'APP.MYTABLE' + i; String createTableSQL = 'CREATE TABLE ' + tableName + ' (ROLEID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 2  INCREMENT BY 1)  INSTANCEID INTEGER  STATUS INTEGER  LOGICAL_STATE INTEGER  LSTATE_TSTAMP TIMESTAMP  UPDT_TSTAMP TIMESTAMP  TSTAMP TIMESTAMP  CLALEVEL1_CLALEVEL2_CLALEVEL2ID VARCHAR(255)  CLALEVEL1_CLALEVEL2_CLALEVEL3_CLALEVEL3ID VARCHAR(255))'; stmt.executeUpdate(createTableSQL); System.out.println(createTableSQL); System.out.println('Check before commit'); numBadStartWith = checkBadStartWithCols(conn 2); conn.commit(); System.out.println('Check after commit'); numBadStartWith = checkBadStartWithCols(conn 2); if (numBadStartWith &gt; 0) break; } } catch (SQLException se) { se.printStackTrace(); } if (numBadStartWith == 0) System.out.println('PASS: All 1000 tables created without problems'); stmt.close(); conn.rollback(); conn.close(); }/** Check that all tables in App do not have a an autoincrementstart value greater tan maxautoincrementstart @param conn @param maxautoincrementstart Maximum expected autoincrementstart value @return number of columns with bad autoincrementstart value */ private static int checkBadStartWithCols(Connection conn  int maxautoincrementstart) throws Exception { Statement stmt = conn.createStatement(); ResultSet rs =stmt.executeQuery('select count(autoincrementstart) from sys.syscolumns c  sys.systables t  sys.sysschemas s WHERE t.schemaid = s.schemaid and s.schemaname = 'APP' and autoincrementstart &gt; ' + maxautoincrementstart); rs.next(); int numBadStartWith = rs.getInt(1); System.out.println(numBadStartWith + ' columns have bad START WITH VALUE'); rs.close(); if (numBadStartWith &gt; 0) { rs =stmt.executeQuery('select tablename  columnname  autoincrementstart from sys.syscolumns c  sys.systables t  sys.sysschemas s WHERE t.schemaid = s.schemaid and s.schemaname = 'APP' and autoincrementstart &gt; 2 ORDER BY tablename'); while (rs.next()) { System.out.println('Unexpected start value: ' + rs.getLong(3) + ' on column ' + rs.getString(1) + '(' + rs.getString(2) + ')'); } } return numBadStartWith; } /** Drop all tables in schema APP @param conn @throws SQLException */ private static void dropAllAppTables(Connection conn) throws SQLException { Statement stmt1 = conn.createStatement(); Statement stmt2 = conn.createStatement(); System.out.println('Drop all tables in APP schema'); ResultSet rs = stmt1.executeQuery('SELECT tablename from sys.systables t  sys.sysschemas s where t.schemaid = s.schemaid and s.schemaname = 'APP''); while (rs.next()) { String tableName = rs.getString(1); try { stmt2.executeUpdate('DROP TABLE ' + tableName); } catch (SQLException se) { System.out.println('Error dropping table:' + tableName); se.printStackTrace(); continue; } } }}Relevant output:$java BadStartWith10.2.0.0 alphaApache DerbyApache Derby Embedded JDBC DriverDrop all tables in APP schemaCreate tables until we get a wrong Start with valueCREATE TABLE APP.MYTABLE0 (ROLEID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 2  INCREMENT BY 1)  INSTANCEID INTEGER  STATUS INTEGER  LOGICAL_STATE INTEGER  LSTATE_TSTAMP TIMESTAMP  UPDT_TSTAMP TIMESTAMP  TSTAMP TIMESTAMP  CLALEVEL1_CLALEVEL2_CLALEVEL2ID VARCHAR(255)  CLALEVEL1_CLALEVEL2_CLALEVEL3_CLALEVEL3ID VARCHAR(255))Check before commit0 columns have bad START WITH VALUECheck after commit0 columns have bad START WITH VALUE&#91;snip MYTABLE1 ... MYTABLE124&#93;CREATE TABLE APP.MYTABLE125 (ROLEID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 2  INCREMENT BY 1)  INSTANCEID INTEGER  STATUS INTEGER  LOGICAL_STATE INTEGER  LSTATE_TSTAMP TIMESTAMP UPDT_TSTAMP TIMESTAMP  TSTAMP TIMESTAMP  CLALEVEL1_CLALEVEL2_CLALEVEL2ID VARCHAR(255)  CLALEVEL1_CLALEVEL2_CLALEVEL3_CLALEVEL3ID VARCHAR(255))Check before commit0 columns have bad START WITH VALUECheck after commit0 columns have bad START WITH VALUECREATE TABLE APP.MYTABLE126 (ROLEID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 2  INCREMENT BY 1)  INSTANCEID INTEGER  STATUS INTEGER  LOGICAL_STATE INTEGER  LSTATE_TSTAMP TIMESTAMP UPDT_TSTAMP TIMESTAMP  TSTAMP TIMESTAMP  CLALEVEL1_CLALEVEL2_CLALEVEL2ID VARCHAR(255)  CLALEVEL1_CLALEVEL2_CLALEVEL3_CLALEVEL3ID VARCHAR(255))Check before commit127 columns have bad START WITH VALUEUnexpected start value: 41628850257395713 on column MYTABLE0(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE1(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE10(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE100(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE101(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE102(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE103(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE104(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE105(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE106(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE107(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE108(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE109(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE11(ROLEID)Unexpected start value: 41628850257395713 on column MYTABLE110(ROLEID)&#91;snip the rest of the tables have unexpected START WITH value too&#93;", "id": "1327"}, "1339": {"ground_truth": "0", "bug_report": "messages_pt_BR.properties file  should not translate Network Server 'start' and 'shutdown' commands\nIn the current file messages_pt_BR.properties the commands 'start' and 'shutdown' are translated  but once they are commands they should not be translated. Also the word host wasn't translated  and it appears in many lines. Others modifications were done for compatibility with the translated manuals.", "id": "1339"}, "1351": {"ground_truth": "0", "bug_report": "lang/forupdate.sql fails with derbyclient in the 10.1 branch\nDerby 10.1 branch - 10.1.2.5 - (409283)     Start: forupdate jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006-05-24 21:24:26 ***333 del&lt; SQL_CURLH000C3333a333&gt; SQL_CURLH000C1393 del&lt; SQL_CURLH000C3393a393&gt; SQL_CURLH000C1Test Failed. End: forupdate jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006-05-24 21:24:41 ***", "id": "1351"}, "1355": {"ground_truth": "0", "bug_report": "ClientDriver ResultSetMetaData.isAutoIncrement(column) always returns false\nWith ClientDriver  resultSet.getMetaData().isAutoIncrement(column) always returns false. EmbeddedDriver correctly returns the true value (true or false)The following code demonstrates the problem:===================================================================================import java.sql.Connection;import java.sql.DriverManager;import java.sql.ResultSet;import java.sql.ResultSetMetaData;import java.sql.SQLException;import java.sql.Statement;import org.apache.derby.jdbc.ClientDriver;import org.apache.derby.jdbc.EmbeddedDriver;public class TestAutoIncrement { private static final String URL_EMBEDDED = 'jdbc:derby:EmbeddedTestBase;'; private static final String URL_CLIENT = 'jdbc:derby://localhost:1527/ClientTestBase;'; public TestAutoIncrement() { super(); } public static void main(String[] args) throws SQLException { System.out.println(new ClientDriver().getClass().getName() + ' registered'); System.out.println(new EmbeddedDriver().getClass().getName() + ' registered'); new TestAutoIncrement().test(); } private void test() throws SQLException { if (test(URL_EMBEDDED) != test(URL_CLIENT)) { System.out.println('Embedded and client driver behave differently for isAutoIncrement().'); } else { System.out.println('Embedded and client driver behave the same for isAutoIncrement().'); } } private boolean test(String url) throws SQLException { boolean ai = false; Connection connection = DriverManager.getConnection(url + 'create=true;'); Statement statement = connection.createStatement(); statement .execute('CREATE TABLE TEST_TABEL (' + 'ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1  INCREMENT BY 1) ' + 'VALUE INTEGER NOT NULL  PRIMARY KEY (ID))'); statement.execute('INSERT INTO TEST_TABEL (VALUE) VALUES(1)'); ResultSet resultSet = statement .executeQuery('SELECT * FROM TEST_TABEL'); ResultSetMetaData meta = resultSet.getMetaData(); ai = meta.isAutoIncrement(1); System.out.println('For ' + url + ' ' + meta.getColumnName(1) + ' isAutoIncrement: ' + ai); connection.close(); try { DriverManager.getConnection(url + 'shutdown=true;'); } catch (SQLException e) { System.out.println(e.getMessage()); } return ai; }}===================================================================================The output I receive from the above program is:org.apache.derby.jdbc.ClientDriver registeredorg.apache.derby.jdbc.EmbeddedDriver registeredFor jdbc:derby:EmbeddedTestBase; ID isAutoIncrement: trueDatabase 'EmbeddedTestBase' shutdown.For jdbc:derby://localhost:1527/ClientTestBase; ID isAutoIncrement: falseDERBY SQL error: SQLCODE: -1  SQLSTATE: 08006  SQLERRMC: Database 'ClientTestBase' shutdown.Embedded and client driver behave differently for isAutoIncrement().===================================================================================Ouput from sysinfo:------------------ Java Information ------------------Java Version: 1.5.0_06Java Vendor: Sun Microsystems Inc.Java home: C:/Program Files/Java/jre1.5.0_06Java classpath: .;C:/PROGRA~1/JMF21~1.1E/lib/sound.jar;C:/PROGRA~1/JMF21~1.1E/lib/jmf.jar;C:/PROGRA~1/JMF21~1.1E/lib;C:/WINDOWS/java/classes;C:/WorkSpace/PB 3.0/bin;C:/WorkSpace/Filipe/bin;C:/Documents and Settings/Piet/My Documents/Resources/Jars/ImgrRdr130.jar;C:/Documents and Settings/Piet/My Documents/Resources/Jars/lucene-1.4.1.jar;C:/Documents and Settings/Piet/My Documents/Resources/Jars/Multivalent20040415.jar;C:/Workspace/Stick/bin;OS name: Windows XPOS architecture: x86OS version: 5.1Java user name: PietJava user home: C:/Documents and Settings/PietJava user dir: C:/StickFolderjava.specification.name: Java Platform API Specificationjava.specification.version: 1.5--------- Derby Information --------JRE - JDBC: J2SE 5.0 - JDBC 3.0&#91;/org/apache/derby/info/DBMS.properties&#93; 10.1.2.1 - (330608)&#91;/org/apache/derby/info/tools.properties&#93; 10.1.2.1 - (330608)&#91;/org/apache/derby/info/net.properties&#93; 10.1.2.1 - (330608)&#91;/org/apache/derby/info/dnc.properties&#93; 10.1.2.1 - (330608)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [Nederlands/Nederland &#91;nl_NL&#93;]Found support for locale: &#91;de_DE&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;es&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;fr&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;it&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;ja_JP&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;ko_KR&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;pt_BR&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;zh_CN&#93; version: 10.1.2.1 - (330608)Found support for locale: &#91;zh_TW&#93; version: 10.1.2.1 - (330608)------------------------------------------------------", "id": "1355"}, "1362": {"ground_truth": "0", "bug_report": "Class-Path manifest entry for derby.jar is missing from the 10.2.0.2 snapshot\nThe class path manifest entry should include all the supported locales. It is missing from the snapshot.I see this entry when I build the jar files myself.Class-Path: derbyLocale_de_DE.jar derbyLocale_es.jar derbyLocale_fr.ja r derbyLocale_it.jar derbyLocale_ja_JP.jar derbyLocale_ko_KR.jar derb yLocale_pt_BR.jar derbyLocale_zh_CN.jar derbyLocale_zh_TW.jar", "id": "1362"}, "1367": {"ground_truth": "0", "bug_report": "add  lang/grantrevoke.java to derbynetclientmats\nI noticed running lang./grantrevoke.java with client fails with :&gt; Unexpected exception&gt; 08004: Connection authentication failure occurred. Reason: userid or password invalid.&gt; java.sql.SQLException: Connection authentication failure occurred. Reason: userid or password invalid.&gt; Caused by: org.apache.derby.client.am.SqlException: Connection authentication failure occurred. Reason: userid or password invalid.&gt; ... 8 more&gt; FAILED. 1 errorTest Failed.     End: grantRevoke jdk1.4.2_07 DerbyNetClient 2006-06-01 12:17:25 ***    Perhaps just a test configuration problem of some sort  but It would be good to have client testing for grant revoke.", "id": "1367"}, "1376": {"ground_truth": "0", "bug_report": "File java/engine/org/apache/derby/loc/messages_en.properties - Message XSLAT.D\nThe message XSLAT.D (String LOG_SEGMENT_EXIST = 'XSLAT.D' states:XSLAT.D=Log directory {0} exists. Please make sure specified logDevice location is correct.But it seems by the source code that the problem is not that this directory exists  but the fact that it is not empty (// make sure log directory is empty  in LogToFile.java). So it seems to me that the following message would be better:XSLAT.D=Log directory {0} is not empty. Please make sure specified logDevice location is correct.", "id": "1376"}, "1380": {"ground_truth": "0", "bug_report": "Interface changes introduced in Mustang build 86\nBuild 86 of Mustang introduced changes to the Connection interface that were not compatible with the existing Derby implementions. createArray() was renamed createArrayOf() and setClientInfoProperties() now throws SQLClientInfoException (rather than ClientInfoException). The result of this is that it is not possible to build Derby with build 86.", "id": "1380"}, "1386": {"ground_truth": "0", "bug_report": "Wrong results with query using LIKE and ESCAPE clause that includes '%'  '/'  and '_'\nAfter the fix for DERBY-1262 was checked in  I'm noticing that the following query now returns different results. Prior to the fix for DERBY-1262 the query returned 2 rows; now it doesn't return any rows.create table escTable (c1 char(10));insert into escTable values ('%_/a');insert into escTable values ('%_b');insert into escTable values ('%c');insert into escTable values ('d');insert into escTable values ('%_/e');select c1 from escTable where c1 like '&#37;&#95;%' ESCAPE '/';Before DERBY-1262  the SELECT returned:C1----------%_/a%_/e2 rows selectedNow it returns:C1----------0 rows selectedBrief inspection of the query and data suggest to me that these new results (i.e. no rows) are wrong  and that Derby should in fact return 2 rows/.Based on comments in DERBY-1262  I'm creating a new Jira issue for the regression since it has been checked into the 10.1 maintenance branch. I've set the priority to 'Critical' since this could potentially delay a 10.1.3 release--I.e. I don't think we'd want to release 10.1.3 knowing that we have a wrong results regression. But if anyone thinks that's not the correct priority  feel free to speak up.Other option  of course  is to back out the change for DERBY-1262 in 10.1 and then lower the priority accordingly. Input/feedback/comments would be appreciated.", "id": "1386"}, "1416": {"ground_truth": "0", "bug_report": "Message id J029 (CONN_RESTORE_FROM) does not have a matching message text\nThis is used by engine.org.apache.derby.jdbc.Driver20. Uncovered by the test i18n/MessageBundleTest.jav", "id": "1416"}, "1431": {"ground_truth": "0", "bug_report": "Typo in link to Simple Example from frameworks/readme.html\nThere is a small typo in frameworks/readme.html.The link 'see the simple example' links to  ../demo/programs/simple/example.htmlbut it should link to  ../demo/simple/example.htmlbecause there is no 'programs' folder in the 'demo' subtree.I'm attaching a patch for review.", "id": "1431"}, "1436": {"ground_truth": "0", "bug_report": "setEmbeddedCP.ksh and setNetworkCleitn.ksh does not work or gives wrong error message\nsetEmbeddedCP.ksh (and setNetworkClient.ksh) gives the following message if neither DERBY_HOME nor DERBY_INSTALL is set: echo '/$DERBY_HOME or /$DERBY_INSTALL not set. Please set one of these variables' echo 'to the location of your Derby installation.'but the scripts do not work if only DERBY_HOME is set", "id": "1436"}, "1444": {"ground_truth": "0", "bug_report": "Using -Djvmflags option causes NoClassDefFoundError\nWhen starting tests with the -Djvmflags option  the harness (RunList class) places '' around the argument to -Djvmflags when executing the java launcher to start a new jvm. This is (at least by suns java launcher) interpreted as a Class and not as a command line option  because of the ''. Because of this I get a NoClassDefFoundError.I believe this is a problem that happens only when using Suns java launcher.", "id": "1444"}, "1458": {"ground_truth": "0", "bug_report": "Add MessageBundleTest to build script to verify that there are no orphaned message ids\nMessageBundleTest can't be run with the regular tests because it relies on SQLState.java and MessageId.java  which are not in the jar files. But it actually makes more sense to run it as part of the build  as we are verifying the consistency of code references.", "id": "1458"}, "1466": {"ground_truth": "0", "bug_report": "Network Server should flush the PrintWriter after console output\nIf Network Server is started with a PrintWriter specified for console output it will not automatically flush output such as starting the server. This can be confusing as the console output shows no activity.Users currently need to specify the PrintWriter to autoflush e.g. starterWriter = new PrintWriter(new FileOutputStream(new File(SERVER_START_LOG)) true); derbyServer = new NetworkServerControl(); derbyServer.start(starterWriter); For repro see:http://www.nabble.com/Questions-about-Network-Server-API-Behavior-p5055814.htmlAnd change the following line in the program to not autoflush as follows:starterWriter = new PrintWriter(new FileOutputStream(new File(SERVER_START_LOG)) false);", "id": "1466"}, "1470": {"ground_truth": "0", "bug_report": "Correct instructions in demo html file demo/simple/example.html\nIn file demo/simple/example.html  under section 'Next run the SimpleApp demo in Derby client mode:'  step 5'java org.apache.derby.tools.sysinfo -cp client SimpleApp.class' gives the following error:Exception in thread 'main' java.lang.NoClassDefFoundError: org/apache/derby/tools/sysinfoThe above error is given because step 4 instructs to set path as following:export CLASSPATH=.:${DERBY_INSTALL}/lib/derbyclient.jarNow as neither derby.jar or derbytool.jar is been added to the above classpath  sysinfo file not found.Step 4 should instruct to set up path as following:export CLASSPATH=.:${DERBY_INSTALL}/lib/derbyclient.jar:${DERBY_INSTALL}/lib/derby.jar", "id": "1470"}, "1489": {"ground_truth": "0", "bug_report": "Provide ALTER TABLE DROP COLUMN functionality\nProvide a way to drop a column from an existing table. Possible syntax would be: ALTER TABLE tablename DROP COLUMN columnname CASCADE / RESTRICT;Feature should properly handle columns which are used in constraints  views  triggers  indexes  etc.", "id": "1489"}, "1493": {"ground_truth": "0", "bug_report": "EmbeddedDriver does not implement PreparedStatement.setNull(int  int  String)\nThe embedded driver throws Util.notImplemented() when PreparedStatement.setNull(int  int  String) is called. The javadoc says that '&#91;if&#93; the parameter does not have a user-defined or REF type  the given typeName is ignored.' The client driver correctly ignores typeName and forwards the call to setNull(int  int). Embedded should be changed to match the client.", "id": "1493"}, "1496": {"ground_truth": "1", "bug_report": "testSecMec needs many masters - should convert to junit\nderbynet/testSecMec.java fails with jcc2.8 with 131 vms. I have checked the diff and it is a master update with difference in the exception  message string.diff snippet:8 del&lt; T5: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=neelima;password=lee;securityMechanism=9; - EXCEPTION java.security.InvalidAlgorithmParameterException is caught when initializing EncryptionManager 'Prime size must be multiple of 64  and can only range from 512 to 1024 (inclusive)'8a8&gt; T5: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=neelima;password=lee;securityMechanism=9; - EXCEPTION java.security.NoSuchAlgorithmException is caught when initializing EncryptionManager 'DH KeyPairGenerator not available'14 del----------------There is difference in the exception message and will require lot of jvm specific master files which can become difficult to maintain. Myrna suggested that this might be a good test to convert to junit.", "id": "1496"}, "1499": {"ground_truth": "0", "bug_report": "test run exits for _foundation run because unloadEmbeddedDriver uses driverManager  which isn't available.\nThe wctme5.7_foundation runs have been exiting out for a while. We only run this environment weekly and were under the impression there was a time out. But I ran the suite  capturing the output in a file  and the last part of the run shows the problem is with unloadEmbeddedDriver:Now do RunListException in thread 'main' java.lang.NoClassDefFoundError: java.sql.DriverManager at org.apache.derbyTesting.functionTests.harness.RunList.unloadEmbeddedDriver(RunList.java:1636) at org.apache.derbyTesting.functionTests.harness.RunList.runSuites(RunList.java:276) at org.apache.derbyTesting.functionTests.harness.RunList.&lt;init&gt;(RunList.java:167) at org.apache.derbyTesting.functionTests.harness.RunSuite.getSuitesList(RunSuite.java:208) at org.apache.derbyTesting.functionTests.harness.RunSuite.main(RunSuite.java:147)UnloadEmbeddedDriver was put in to allow running with useprocess=false and autoload of the driver  so it's needed. But maybe we can add an appropriate if condition so it doesn't try to do this with foundation.", "id": "1499"}, "1510": {"ground_truth": "0", "bug_report": "'SQLBinary.readFromStream' can enter endless loop\nUnder certain circumstances  the method 'SQLBinary.readFromStream' can enter an endless loop while reading the stream. The following must be true for the bug to occur:  There must be more data in the stream than what can fit into the initial buffer (32 K). The method 'available' of the stream returns 0.Since the default return value for 'InputStream.available' is 0  and the method reading the stream can be used for data types CHAR FOR BIT DATA  VARCHAR FOR BIT DATA and LONG VARCHAR FOR BIT DATA  the bug should be fixed. The maximum length is 32700 bytes.The method will also be used by SQLBlob  but it may be better to introduce a new streaming method for it  since the current implementation has memory-problems for large data (materializes the whole stream). A separate issue should/will be created for this.The symptom for this bug is a hang when calling one of the execute methods of Prepared- or CallableStatement and maybe also certain set methods in ResultSet.The visibility of this bug is very low  but the impact is severe/critical. When the JDBC 4 length less streaming overloads are added (DERBY-1417)  visibility might increase.", "id": "1510"}, "1521": {"ground_truth": "1", "bug_report": "Upgrade test needs to be enhanced to test grant revoke\nGrant Revoke is one of the features targeted for 10.2 Release. The upgrade test should be modified to test this feature with various upgrade scenarios to make sure everything works fine.", "id": "1521"}, "1527": {"ground_truth": "0", "bug_report": "Factor out type checks in EmbedResultSet and EmbedPreparedStatement\nEmbedPreparedStatement and EmbedResultSet have many occurrences of switch (...) { case Types.CHAR: case Types.VARCHAR: case Types.LONGVARCHAR: case Types.CLOB: break; default: throw dataTypeConversion(...); }and switch (...) { case Types.BINARY: case Types.VARBINARY: case Types.LONGVARBINARY: case Types.BLOB: break; default: throw dataTypeConversion(...); }Instead of having many copies of this code  it would be good to factorit out into methods that can be shared. For instance  one could addthese methods to DataTypeDescriptor: public static boolean isAsciiStreamCompatible(int jdbcType) public static boolean isBinaryStreamCompatible(int jdbcType) public static boolean isCharacterStreamCompatible(int jdbcType)", "id": "1527"}, "1529": {"ground_truth": "0", "bug_report": "The Eclipse plug-in distributions (UI and Core zip files) do not contain the Apache license  copyright or notice files\nThe Apache Derby Core and Apache Derby UI plug-ins do not contain the appropriate Apache Software Foundation license files in their zip distributions  derby_core_plugin_10.1.3.zip  derby_ui_plugin_1.1.0.zip.I'm not sure exactly which files are required  LICENSE  COPYRIGHT and NOTICE  but the zip filesshould contain some or all of these files.", "id": "1529"}, "1538": {"ground_truth": "1", "bug_report": "Unexpected behavior on self privilege revocation\nWhen revoking the owner's own privilege against the table he have created  Derby executes the revocation successfullybut the owner is able to select from the table later as if though the REVOKE statement has no effect. More importantly  I was expecting a SQLException with the appropriate SQLSTATE to be thrown when the owner attempts to revoke privilege from himself. i.e.:ij&gt; connect 'jdbc:derby:authtest' user 'yip' as conn1;ij&gt; create table t1 (c1 int);0 rows inserted/updated/deletedij&gt; insert into t1 values 1 2 3;3 rows inserted/updated/deletedij&gt; revoke select on t1 from yip;0 rows inserted/updated/deletedij&gt; select * from t1;C1-----------1233 rows selectedHere is the sysinfo:------------------ Java Information ------------------Java Version: 1.4.2_12Java Vendor: Sun Microsystems Inc.Java home: C:/jdk142/jreJava classpath: derby.jar;derbytools.jar;.OS name: Windows XPOS architecture: x86OS version: 5.1Java user name: yipJava user home: C:/Documents and Settings/AdministratorJava user dir: C:/derby/trunk/jars/sanejava.specification.name: Java Platform API Specificationjava.specification.version: 1.4--------- Derby Information --------JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&#91;C:/derby/trunk/jars/sane/derby.jar&#93; 10.2.0.4 alpha - (423353)&#91;C:/derby/trunk/jars/sane/derbytools.jar&#93; 10.2.0.4 alpha - (423353)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [English/United States &#91;en_US&#93;]Found support for locale: &#91;de_DE&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;es&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;fr&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;it&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;ja_JP&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;ko_KR&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;pt_BR&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;zh_CN&#93; version: 10.2.0.4 alpha - (423353)Found support for locale: &#91;zh_TW&#93; version: 10.2.0.4 alpha - (423353)------------------------------------------------------", "id": "1538"}, "1539": {"ground_truth": "1", "bug_report": "A  trigger should be dropped when a privilege required by the trigger is revoked.\nA trigger tracks its privileges requirements using Derby's Dependency Manager. If any one of those required privileges are revoked  the trigger should be dropped automatically. I am just creating a new jira entry here so it is easier to track sub items of DERBY-1330. Will link this Jira entry to DERBY-1330.See the functional spec attached to DERBY-1330", "id": "1539"}, "1541": {"ground_truth": "1", "bug_report": "Make test jdbc4/TestPreparedStatement run under the security manager\nSee trunk/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/TestPreparedStatement_app.properties which says: test fails trying to read blob content filesOther tests succesfully read files so it must be possible to enable this test under the security manager.Maybe the files need to be marked as support files and copied into the extin/extout/extinout foldersto use the existing permissions in the test policy files.", "id": "1541"}, "1545": {"ground_truth": "1", "bug_report": "derbynet/testProtocol.java fails with security manager enabled\nThe tinderbox test started failing after revision 423676 which enabled security manager for derbynet/testProtocol.java. See http://www.multinet.no/~solberg/public/Apache/TinderBox_Derby/testlog/SunOS-5.10_i86pc-i386/423706-derbyall_diff.txtException in thread 'main' java.security.AccessControlException: access denied (java.net.SocketPermission 127.0.0.1:1527 connect resolve) at java.security.AccessControlContext.checkPermission(AccessControlContext.java:264) at java.security.AccessController.checkPermission(AccessController.java:427) at java.lang.SecurityManager.checkPermission(SecurityManager.java:532) at java.lang.SecurityManager.checkConnect(SecurityManager.java:1034) at java.net.Socket.connect(Socket.java:501) at java.net.Socket.connect(Socket.java:457) at java.net.Socket.&lt;init&gt;(Socket.java:365) at java.net.Socket.&lt;init&gt;(Socket.java:178) at org.apache.derby.impl.drda.TestProto.getConnection(Unknown Source) at org.apache.derby.impl.drda.TestProto.&lt;init&gt;(Unknown Source) at org.apache.derbyTesting.functionTests.tests.derbynet.testProtocol.executeFile(Unknown Source) at org.apache.derbyTesting.functionTests.tests.derbynet.testProtocol.main(Unknown Source)", "id": "1545"}, "1546": {"ground_truth": "0", "bug_report": "Derby JDBC 4.0 driver returns 3 for JDBC driver major version\nFor 10.2 the DatabaseMetaData.getJDBCMajorVersion() is returning '3' for the Derby JDBC 4.0 driver. It should return 4. This is easily reproduced by running a simple test to obtain a connection and output the value Database product: Apache DerbyDatabase version: 10.2.0.4 alphaDriver name: Apache Derby Embedded JDBC DriverDriver version: 10.2.0.4 alphaJDBC driver major version: 3JDBC driver minor version: 0Test code:org.apache.derby.jdbc.EmbeddedConnectionPoolDataSource40 ds = new org.apache.derby.jdbc.EmbeddedConnectionPoolDataSource40();ds.setDatabaseName('C://drivers//derby//databasesJDBC40DB'); ds.setUser('dbuser1'); ds.setPassword('dbpwd1'); PooledConnection pooledConn = ds.getPooledConnection(); Connection conn = pooledConn.getConnection(); System.out.println('Database product: ' + conn.getMetaData().getDatabaseProductName()); System.out.println('Database version: ' + conn.getMetaData().getDatabaseProductVersion()); System.out.println('Driver name: ' + conn.getMetaData().getDriverName()); System.out.println('Driver version: ' + conn.getMetaData().getDriverVersion()); System.out.println('JDBC driver major version: ' + conn.getMetaData().getJDBCMajorVersion()); System.out.println('JDBC driver minor version: ' + conn.getMetaData().getJDBCMinorVersion());Relevant Derby Embedded code in EmbedDatabaseMetaData is: JDBC 3.0 * Retrieves the major JDBC version number for this driver. * @return JDBC version major number */ public int getJDBCMajorVersion() { return 3; }and client code in org.apache.derby.client.am.DatabaseMetaData:public int getJDBCMajorVersion() throws SQLException { checkForClosedConnection(); return 3; }I am not sure if this should be JVM dependent or if it should always return 4 regardless of the JVM version.", "id": "1546"}, "1558": {"ground_truth": "0", "bug_report": "enable more testcases in ConcurrencyTest\nA number of testcases  which depend on SUR  are not enabled in the ConcurrencyTest.These testcases can be enabled. The test should also set some properties to reduce lock timeout  so that it runs faster.", "id": "1558"}, "1574": {"ground_truth": "1", "bug_report": "NullPointerException in UPDATE with COALESCE and subquery\nThe following statements generate a NullPointerException:CREATE TABLE t1 (i INTEGER);CREATE TABLE t2 (i INTEGER);UPDATE t1 SET i = COALESCE( (SELECT i FROM t2 WHERE t2.i=t1.i)  0);Any further SQL statements generate an internal error in RawStore  e.g.:SELECT * FROM t1;", "id": "1574"}, "1588": {"ground_truth": "0", "bug_report": "Link 'Getting Started....' and 'Apache Derby Server ....' in demo.html needs to be linked to actual documents instead of manuals page\nThe links 'Getting Started with Apache Derby' and 'Apache Derby Server and Administration Guide' in file https://svn.apache.org/repos/asf/db/derby/code/trunk/java/demo/demo.html needs to be linked to actual documents as following:Getting Started with Apache Derby to 'http://db.apache.org/derby/docs/dev/getstart/getstartderby.pdf'Apache Derby Server and Administration Guide to 'http://db.apache.org/derby/docs/dev/adminguide/derbyadmin.pdf' Right now the links are linked to 'http://db.apache.org/derby/manuals/index.html'Also  once the dev release is committed (for example committed to 10.2)  the links needs to be changed so that 'dev' is replaced with actual release number.", "id": "1588"}, "1595": {"ground_truth": "0", "bug_report": "Network server fails with DRDAProtocolException if a BLOB with size 2147483647 is streamed from client\nWhen executing a program which inserts a BLOB of size 2GB-1  the Network server fails with DRDAProtocolException. This happens before it starts handling the actual LOB data:java org.apache.derby.drda.NetworkServerControl startApache Derby Network Server - 10.2.0.4 alpha started and ready to accept connections on port 1527 at 2006-07-26 14:15:21.284 GMTExecution failed because of a Distributed Protocol Error: DRDA_Proto_SYNTAXRM; CODPNT arg = 0; Error Code Value = corg.apache.derby.impl.drda.DRDAProtocolException at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:441) at org.apache.derby.impl.drda.DDMReader.readLengthAndCodePoint(DDMReader.java:554) at org.apache.derby.impl.drda.DDMReader.getCodePoint(DDMReader.java:617) at org.apache.derby.impl.drda.DRDAConnThread.parseSQLDTA_work(DRDAConnThread.java:4072) at org.apache.derby.impl.drda.DRDAConnThread.parseSQLDTA(DRDAConnThread.java:3928) at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:3806) at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:3640) at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:928) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:254)nullorg.apache.derby.impl.drda.DRDAProtocolException at org.apache.derby.impl.drda.DRDAConnThread.throwSyntaxrm(DRDAConnThread.java:441) at org.apache.derby.impl.drda.DDMReader.readLengthAndCodePoint(DDMReader.java:554) at org.apache.derby.impl.drda.DDMReader.getCodePoint(DDMReader.java:617) at org.apache.derby.impl.drda.DRDAConnThread.parseSQLDTA_work(DRDAConnThread.java:4072) at org.apache.derby.impl.drda.DRDAConnThread.parseSQLDTA(DRDAConnThread.java:3928) at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTTobjects(DRDAConnThread.java:3806) at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLSTT(DRDAConnThread.java:3640) at org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:928) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:254)", "id": "1595"}, "1597": {"ground_truth": "0", "bug_report": "Scripts in frameworks direcotry needs to be revisted to set up CLASSPATH properly\nNeed to revisit scripts in directory frameworks/embedded/bin and frameworks/NetworkServer/bin for setting up CLASSPATH properly. The current problem is as following:If user already has a CLASSPATH set on their system  the CLASSPATH is not set again within the script. Therefore  there are no derby classes in the CLASSPATH which results in java command failing as it can not find the derby class it is calling. Basically  to make the scripts work  user has to either issue command 'set CLASSPATH=' or have derby jar files be appended to their system CLASSPATH before running any frameworks batch script.In ksh scripts  there is same problem except that the user has to issue command 'export CLASSPATH=' or have derby jar files be appended to their system CLASSPATH only once as whatever CLASSPATH is set up by scripts is not visible once the script is done.So I am proposing the following solution so that frameworks scripts work properly without interfering with system classpath or without any setup from user.In batch scripts:-----------------------1. Before line 'call '%DERBY_INSTALL%'/frameworks/embedded/bin/setEmbeddedCP.bat'  save the current classpath as follows:set SAVED_CLASSPATH=%CLASSPATH%2. Replace the following lines:@if Unable to render embedded object: File (&quot;%CLASSPATH%&quot;==) not found. call '%DERBY_INSTALL%'/frameworks/embedded/bin/setEmbeddedCP.bat@if '%CLASSPATH%' == '' call '%DERBY_INSTALL%'/frameworks/embedded/bin/setEmbeddedCP.batwithcall '%DERBY_INSTALL%'/frameworks/embedded/bin/setEmbeddedCP.batNote: I have given the above as example only. The name of script that is getting called may be different.3. At the end of script  reset the CLASSPATH to system CLASSPATH as follows:set CLASSPATH=%SAVED_CLASSPATH%In korn scripts:-----------------------In ksh script  even though system classpath is only modified within the script and is not effective once script exits  to be consistent with batch scripts  do the following:1. Before line '. '$DERBY_HOME'/frameworks/embedded/bin/setEmbeddedCP.ksh' save the current classpath as follows:export SAVED_CLASSPATH=$CLASSPATH2. Replace the following lines:[ -z '$CLASSPATH' ] &amp;&amp; { . '$DERBY_HOME'/frameworks/embedded/bin/setEmbeddedCP.ksh}with. '$DERBY_HOME'/frameworks/embedded/bin/setEmbeddedCP.kshNote: I have given the above as example only. The name of script that is getting called may be different.3. At the end of script  reset the CLASSPATH to system CLASSPATH as follows:export CLASSPATH=$SAVED_CLASSPATH", "id": "1597"}, "1605": {"ground_truth": "0", "bug_report": "test harness evaluates j9 2.2 jvm (a.k.a wctme5.7) as isJDBC4; does enthousiastic sed-ing\nThe wctme5.7 run shows failures like so:     Start: iepnegativetests jdk1.3.1 subset - 2.2 derbyall:derbytools 2006-07-24 11:41:43 ***16 del&lt; ERROR 38000: The exception 'java.sql.SQLException: Table/View 'IEP.NOTABLE' does not exist.' was thrown while evaluating an expression.16a16&gt; ERROR 38000: The exception 'SQL Exception: Table/View 'IEP.NOTABLE' does not exist.' was thrown while evaluating an expression....    It seems to me this is because it evaluates the major/minor version (2.2) as isJDBC4 in functionTests/harness/RunTest.java : JavaVersionHolder jvh = getProperties(sp); boolean isJDBC4 = jvh.atLeast( 1  6 );and is gets passed on to Sed.java.The following tests fail with this jvm because of this:lang/compressTable.sqllang/nestedCommit.sqllang/releaseCompileLocks.sqltools/iepnegativetests.sqltools/importExportThruIJ.sqltools/ieptests.sqljdbcapi/statementJdbc20.javai18n/iepnegativetests_ES.sqlstore/streamingColumn.javastore/TransactionTable.sqllang/procedureInTrigger.sqlIt seems to me we need an if (!jvmName.startsWith('j9')) or some such around the isJDBC4 assignment.", "id": "1605"}, "1606": {"ground_truth": "0", "bug_report": "derbyrunjartest hangs with wctme5.7 & always uses j9_13; hangs with _foundation\nderbyrunjartest hangs with wctme5.7.I am not sure what the hook up is but if I do this:j9 -jcl:max -Xbootclasspath/p:c:/wctme5.7/ive/lib/jclMax/classes.zip;c:/wctme5.7/ive/lib/charconv.zip;c:/wctme5.7/ive/lib/database_enabler.jar -jar c:/derbyt/svn2/trunk/jars/sane/derbyrun.jar ij --helpI get successfully:Usage: java org.apache.derby.tools.ij &#91;-p propertyfile&#93; [-ca connectionAttributePropertyFile] &#91;inputfile&#93;Also  when looking at the code of this test  it forces the jvm class to be used to be j9_13 whenever the jvm as set in RunTest starts with J9. However  wctme5.7 is j9_22 and this also prevents running with foundation (assuming that's supported).", "id": "1606"}, "1607": {"ground_truth": "0", "bug_report": "new j9 canons required/canons need to be removed to catch up to changes to 7/27/06.\nThere are some newer failures with wctme5.7 &amp; wsdd5.6 that are just due to canon maintenance. lang/aggregate.sql - needs a new j9_13 and j9_22 canon lang/ejbql.sql - j9_13 canon can be removed (there is no j9_22 canon) lang/distinct.sql - needs new j9_22 canon nist/dml099.sql - j9_13 canon can be removed lang/procedureInTrigger.sql - needs a j9_22 canon note  this last test also suffers from DERBY-1605.", "id": "1607"}, "1614": {"ground_truth": "0", "bug_report": "Test harness overrides heap size settings when starting Network Server\nTest specific heap size settings can be passed to the test harness using the jvmflags system property  for example in a &lt;testname&gt;_app.properties file or at the command line when starting a test  e.g '-Djvmflags=-Xms32m^-Xmx32m'.The test harness almost always overrides such settings when starting a new Network Server using the org.apache.derbyTesting.functionTests.harness.NetServer class of the test harness. Currently  if either -ms or -Xms is missing from the jvmflags  NetServer.start() adds -ms16777216. Also  if either -mx or -Xmx is missing from the jvmflags  NetServer.start() adds -ms33554432. This has been the case since SVN revision 420048 (July 8  2006).Earlier revisions did not override the heap settings unless the newer -Xms or -Xmx flags were used instead of the -ms and -mx flags. A patch for DERBY-1091 attempted (among other things) to make the harness recognize the newer flags as well as the older flags  but the resulting behavior is (most likely) not as intended. If a test is run in either the DerbyNet framework or the DerbyNetClient framework  the test-specific JVM flags should (probably) be used for the Network Server JVM as well as the test JVM. Currently  even if non-default heap size flags are passed to the harness  the server JVM will ignore these settings since the harness adds -ms and/or -mx flags after all other heap flags. The exception is if both new and old versions of heap flags are passed to the harness  e.g:jvmflags=-ms32m^-Xms32m^-mx128m^-Xmx128mHere is the code causing this behaviour:if (setJvmFlags &amp;&amp; ((jvmflags.indexOf('-ms') == -1) || (jvmflags.indexOf('-Xms') == -1))) // only setMs if no starting memory was given jvm.setMs(16*1024*1024); // -ms16mif (setJvmFlags &amp;&amp; ((jvmflags.indexOf('-mx') == -1) || (jvmflags.indexOf('-Xmx') == -1))) // only setMx if no max memory was given jvm.setMx(32*1024*1024); // -mx32m", "id": "1614"}, "1616": {"ground_truth": "0", "bug_report": "Lots of jdk1.6 regression test failures with diffs because of  SQL Exception instead of java.sql.SQLException\njdk16 derbyall derbyall: 19 failures derbyall/derbyall.fail:lang/compressTable.sql derbyall/derbyall.fail:lang/nestedCommit.sql derbyall/derbyall.fail:lang/outparams.java derbyall/derbyall.fail:lang/procedure.java derbyall/derbyall.fail:lang/procedureInTrigger.sql derbyall/derbyall.fail:tools/importExportThruIJ.sql derbyall/derbyall.fail:tools/ieptests.sql derbyall/derbyall.fail:tools/iepnegativetests.sql derbyall/derbyall.fail:jdbcapi/statementJdbc20.java derbyall/derbyall.fail:jdbcapi/statementJdbc30.java derbyall/derbyall.fail:jdbcapi/parameterMapping.java derbyall/derbyall.fail:i18n/iepnegativetests_ES.sql derbyall/derbynetclientmats/derbynetclientmats.fail:jdbc4/ClosedObjectTest.junit derbyall/derbynetclientmats/derbynetclientmats.fail:jdbc4/UnsupportedVetter.junit derbyall/derbynetclientmats/derbynetclientmats.fail:jdbc4/VerifySignatures.junit derbyall/encryptionAll/encryption.fail:stress/stress.multi derbyall/encryptionAll/storemats.fail:store/streamingColumn.java derbyall/storeall/storeall.fail:store/TransactionTable.sql derbyall/storeall/storemats.fail:store/streamingColumn.java", "id": "1616"}, "1619": {"ground_truth": "0", "bug_report": "Sysinfo in 10.2  shows multiple entries if the derby jars reside in a directory with spaces in its name\nFor the Derby jars residing in C:/Documents and Settings/Administrator/TEMP DIR/lib  the sysinfo shows:--------- Derby Information --------JRE - JDBC: J2SE 5.0 - JDBC 3.0&#91;C:/Documents%20and%20Settings/Administrator/TEMP%20DIR/lib/derby.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents%20and%20Settings/Administrator/TEMP%20DIR/lib/derbytools.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents%20and%20Settings/Administrator/TEMP%20DIR/lib/derbynet.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents%20and%20Settings/Administrator/TEMP%20DIR/lib/derbyclient.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derby.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbynet.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbyclient.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbytools.jar&#93; 10.2.0.5 alpha - (426734)&#91;C:/Documents%20and%20Settings/Administrator/TEMP%20DIR/lib/db2jcc.jar&#93; 2.6 - (90)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/db2jcc_license_c.jar&#93; 2.6 - (90)------------------------------------------------------This is a regression from 10.1 where the same sysinfo shows:--------- Derby Information --------JRE - JDBC: J2SE 5.0 - JDBC 3.0&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derby.jar&#93; 10.1.3.2 - (426741)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbynet.jar&#93; 10.1.3.2 - (426741)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbyclient.jar&#93; 10.1.3.2 - (426741)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/derbytools.jar&#93; 10.1.3.2 - (426741)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/db2jcc.jar&#93; 2.6 - (90)&#91;C:/Documents and Settings/Administrator/TEMP DIR/lib/db2jcc_license_c.jar&#93; 2.6 - (90)------------------------------------------------------", "id": "1619"}, "1621": {"ground_truth": "0", "bug_report": "Trigger action statement is not recompile when there is a change that would affect it.\nA trigger action statement  such as an INSERT statement is not recompiled when there is some DDL change on the underlying table  such as a CREATE INDEX.In the example below a unique index is added to the table (t2) inserted into by the trigger's action statement. When the tirgger fires it does not raise any error (should raise a unique constraint violated error) and does not insert the value into the index. A select from t2 does not show the additional rows in t2 as it is performing an index scan  once the index is dropped the rows appear to the select.ij version 10.2ij&gt; connect 'jdbc:derby:cs;create=true';ij&gt; create table t (i int);0 rows inserted/updated/deletedij&gt; create table t2 (i int);0 rows inserted/updated/deletedij&gt; create trigger tt after insert on t for each statement mode db2sqlinsert into t2 values 1;0 rows inserted/updated/deletedij&gt; insert into t values 1;1 row inserted/updated/deletedij&gt; select * from t2;I-----------11 row selectedij&gt; create unique index tu on t2;0 rows inserted/updated/deletedij&gt; insert into t values 1;1 row inserted/updated/deletedij&gt; select * from t2;I-----------11 row selectedij&gt; insert into t values 1;1 row inserted/updated/deletedij&gt; select * from t2;I-----------11 row selectedij&gt; drop index tu;0 rows inserted/updated/deletedij&gt; select * from t2;I-----------1113 rows selected", "id": "1621"}, "1630": {"ground_truth": "0", "bug_report": "NetConnection40 references an engine class  org.apache.derby.impl.jdbc.Util\nNetConnection40.java contains this:...import org.apache.derby.impl.jdbc.Util;... public boolean isValid(int timeout) throws SQLException { // Validate that the timeout has a legal value if (timeout &lt; 0) { throw Util.generateCsSQLException(SQLState.INVALID_API_PARAMETER  new Integer(timeout)  'timeout'  'java.sql.Connection.isValid'); }...This was added as part of DERBY-1090. This should be changed to use the client's method of throwing exceptions.", "id": "1630"}, "1643": {"ground_truth": "1", "bug_report": "A  'revoke execute ... restrict' should fail if there are dependent objects on the execute privilege\nAs per the functional spec attached to DERBY-1330  a 'revoke execute ... restrict' should fail if there are dependent objects on the execute privilegeIn order to implement this  when revoke execute is executed  a special invalidation action should be sent and dependent objects will need to catch that invalidation and throw an exception. If there are no dependents  then no exception will be thrown and revoke execute will succeed.I am just creating a new jira entry here so it is easier to track sub items of DERBY-1330. Will link this Jira entry to DERBY-1330. See the functional spec attached to DERBY-1330", "id": "1643"}, "1644": {"ground_truth": "1", "bug_report": "NPE when inserting values to a table that has a column declared as generated by default as identity\nThe following scenario triggers a NullPointerException in statement compilation:ij&gt; create table t1 (c1 int  c2 int generated by default as identity);0 rows inserted/updated/deletedij&gt; insert into t1 (c2) values default  10;ERROR XJ001: Java exception: ': java.lang.NullPointerException'.Stacktrace from derby.log:Database Class Loader started - derby.database.classpath=''2006-08-04 06:31:17.235 GMT Thread&#91;main 5 main&#93; (XID = 235)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = null)  Cleanup action starting2006-08-04 06:31:17.235 GMT Thread&#91;main 5 main&#93; (XID = 235)  (SESSIONID = 0)  (DATABASE = wombat)  (DRDAID = null)  Failed Statement is: insert into t1 (c2) values default  10java.lang.NullPointerException at org.apache.derby.impl.sql.compile.ResultColumnList.generateCore(ResultColumnList.java:1033) at org.apache.derby.impl.sql.compile.ResultColumnList.generate(ResultColumnList.java:893) at org.apache.derby.impl.sql.compile.RowResultSetNode.generate(RowResultSetNode.java:690) at org.apache.derby.impl.sql.compile.UnionNode.generate(UnionNode.java:589) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(ProjectRestrictNode.java:1424) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(ProjectRestrictNode.java:1286) at org.apache.derby.impl.sql.compile.NormalizeResultSetNode.generate(NormalizeResultSetNode.java:122) at org.apache.derby.impl.sql.compile.InsertNode.generate(InsertNode.java:764) at org.apache.derby.impl.sql.compile.StatementNode.generate(StatementNode.java:232) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:477) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:118) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:713) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:567) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:516) at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:313) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:478) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:347) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:248) at org.apache.derby.impl.tools.ij.Main.go(Main.java:203) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:55) at org.apache.derby.tools.ij.main(ij.java:69)sysinfo:------------------ Java Information ------------------Java Version: 1.4.2_12Java Vendor: Sun Microsystems Inc.Java home: C:/jdk142/jreJava classpath: classes;.OS name: Windows XPOS architecture: x86OS version: 5.1Java user name: yipJava user home: C:/Documents and Settings/AdministratorJava user dir: C:/derby/trunkjava.specification.name: Java Platform API Specificationjava.specification.version: 1.4--------- Derby Information --------JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&#91;C:/derby/trunk/classes&#93; 10.2.0.5 alpha - (1)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [English/United States &#91;en_US&#93;]Found support for locale: &#91;de_DE&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;es&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;fr&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;it&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;ja_JP&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;ko_KR&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;pt_BR&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;zh_CN&#93; version: 10.2.0.5 alpha - (1)Found support for locale: &#91;zh_TW&#93; version: 10.2.0.5 alpha - (1)------------------------------------------------------", "id": "1644"}, "1661": {"ground_truth": "0", "bug_report": "Create index on large tables fails with too many open files   FileNotFoundException.\nCreate index fails on a table with 18million rows during sort with too many open files errorThis error was first seen when running against a tpcc-like test. The test creates the tables  inserts data and then creates the indexes &amp; adds constraints.Customer table has 18 million rows in this case. The below error is thrown on create index. ij&gt; create index customer_last on customer(c_w_id  c_d_id  c_last);ERROR XSDF1: Exception during creation of file /home/cloudtst/SinglePerf/testruns/scripts/dbtpcc/tmp/T1128794811044.tmp for containerERROR XJ001: Java exception: '/home/cloudtst/SinglePerf/testruns/scripts/dbtpcc/tmp/T1128794811044.tmp (Too many open files): java.io.FileNotFoundException'.ij", "id": "1661"}, "1675": {"ground_truth": "0", "bug_report": "Network Server should not send to client that it supports EUSRIDPWD when running against Sun JVM\nAs part of ACCSECRD  if the server does not accept the security mechanism sent by the client  the server will send a list of security mechanism that it supports. Currently even when the server is running with sun jvm  it will still send EUSRIDPWD as a sec mec that it supports  which is incorrect. The server should test if it can support EUSRIDPWD dynamically and if it does  only then send EURRIDPWD as an option that it supports.see DRDAConnThread.writeACCSECRD(int)", "id": "1675"}, "1681": {"ground_truth": "0", "bug_report": "Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.\nIf Derby chooses to do a join between two FromTables and the right table is a chain of UNIONs  then the optimizer may choose to push the join predicate (if provided) down into the UNION and to both children of every UNION in the chain. But if the predicate cannot be pushed to the children of any of the UNIONs (except the top-level one) the predicate can end up being ignored altogether with respect to that UNION's children. The result is that query execution can return rows that do not satisfy the predicate.This is a regression introduced in 10.1.2.4 and thus it affects 10.1.3 and 10.2. I came across this while tracing through code for DERBY-1633.", "id": "1681"}, "1688": {"ground_truth": "0", "bug_report": "ConsistencyToken.hashCode() is not thread safe\nIf ConsistencyToken.hashCode() is run concurrently by different threads  some of the threads may see a partial result instead of the correct hash code. This is not a problem in the current code since all calls to that method are synchronized on a higher level  but it would be good to fix in case the method will be used differently in the future.", "id": "1688"}, "1691": {"ground_truth": "1", "bug_report": "jdbcapi/blobclob4BLOB.java fails under DerbyNet framework with JCC 2.6\nWith JCC 2.6  the jdbcapi/blobclob4BLOB.java fails. The diff did not show anything alarming  so I am guessing itmay be a master update. The test passed fine with DerbyClient     Start: blobclob4BLOB jdk1.5.0_06 DerbyNet derbynetmats:jdbcapi 2006-08-11 23:29:48 ***466a467 474&gt; EXPECTED SQLSTATE(22018): Invalid character string format for type INTEGER.&gt; end clobTest54&gt; START: clobTest6&gt; EXPECTED SQLSTATE(null): Invalid position 0 or length 5&gt; EXPECTED SQLSTATE(null): Invalid position 1 or length -76&gt; EXPECTED SQLSTATE(null): Invalid position 1 or length -1&gt; EXPECTED SQLSTATE(null): Invalid position 0 or length 0&gt; FAIL &#8211; unexpected exception:java.lang.StringIndexOutOfBoundsException: String index out of range: -1468 475d475&lt; EXPECTED SQLSTATE(22018): Invalid character string format for type INTEGER.&lt; end clobTest54&lt; START: clobTest6&lt; EXPECTED SQLSTATE(null): Invalid position 0 or length 5&lt; EXPECTED SQLSTATE(null): Invalid position 1 or length -76&lt; EXPECTED SQLSTATE(null): Invalid position 1 or length -1&lt; EXPECTED SQLSTATE(null): Invalid position 0 or length 0&lt; FAIL &#8211; unexpected exception:java.lang.StringIndexOutOfBoundsException: String index out of range: -1775a776 782&gt; blobTest54 finished&gt; START: blobTest6&gt; EXPECTED SQLSTATE(null): Invalid position 0 or length 5&gt; EXPECTED SQLSTATE(null): Invalid position 1 or length -76&gt; EXPECTED SQLSTATE(null): Invalid position 1 or length -1&gt; EXPECTED SQLSTATE(null): Invalid position 0 or length 0&gt; FAIL &#8211; unexpected exception:java.lang.NegativeArraySizeException777 783d783&lt; blobTest54 finished&lt; START: blobTest6&lt; EXPECTED SQLSTATE(null): Invalid position 0 or length 5&lt; EXPECTED SQLSTATE(null): Invalid position 1 or length -76&lt; EXPECTED SQLSTATE(null): Invalid position 1 or length -1&lt; EXPECTED SQLSTATE(null): Invalid position 0 or length 0&lt; FAIL &#8211; unexpected exception:java.lang.NegativeArraySizeException789 del&lt; com.ibm.db2.jcc.c.SqlException: Operation 'CREATE TRIGGER' cannot be performed on object 'TESTBLOB' because there is an open ResultSet dependent on that object.789a789&gt; com.ibm.db2.jcc.a.SqlException: Operation 'CREATE TRIGGER' cannot be performed on object 'TESTBLOB' because there is an open ResultSet dependent on that object.Test Failed. End: blobclob4BLOB jdk1.5.0_06 DerbyNet derbynetmats:jdbcapi 2006-08-11 23:30:46 ***", "id": "1691"}, "1692": {"ground_truth": "0", "bug_report": "Client driver does not use the query timeout value set using Statement.setQueryTimeout() for subsequent executions using the same statement object\nI will attach a repro with more details.", "id": "1692"}, "1694": {"ground_truth": "0", "bug_report": "derbynet/testProperties.java hangs\nThe testProperties.execCmd() is used to fork a JVM and not handle itsstreams. This will cause problems  as indicated by the javadoc for Process.'The parent process uses these streams to feed input to and get outputfrom the subprocess. Because some native platforms only provide limitedbuffer size for standard input and output streams  failure to promptlywrite the input stream or read the output stream of the subprocess maycause the subprocess to block  and even deadlock'", "id": "1694"}, "1695": {"ground_truth": "0", "bug_report": "testSecMec.java fails with JCC 2.6 and JCC 2.8\nAfter the checkin for DERBY-528 testSecMec fails with JCC 2.6 and 2.8. My hope was to just wait until the masters were normalized with the conversion of this test to Junit  but I think that work has been deferred for a bit so I will look at the current test.I have had a problem with this test on my machine for sometime with DERBY-1114 like symptoms with all jvms and even with derbyclient. I need to investigate that or run on another machine to resolve this issue.", "id": "1695"}, "1698": {"ground_truth": "0", "bug_report": "Add more tests for Statement.setQueryTimeout method\nCurrently  the following checks work as expected but it would be good to add them to regression tests: Add tests to check query timeout value is used by executeUpdate method. Existing test tests calls to execute and executeQuery. The following mail mentions query timeout limit should be applied for all executeXXX methods. http://www.nabble.com/Statement.setQueryTimeout-tf94429.html#a258410 Add tests for Statement and CallableStatement class. Existing test tests this method with PreparedStatement only. I found a difference in behaviour with client driver when using Statement class (DERBY-1692). So it may be good to add some tests for each statement class.", "id": "1698"}, "1709": {"ground_truth": "0", "bug_report": "Deprecate scripts in frameworks directory\nWith revision 432159  new scripts to be added to the -bin distribution as a part of DERBY-1032 were added to the distributions and snapshots. The old frameworks scripts should be marked as deprecated where appropriate in the documentation  readme files  and release pages.", "id": "1709"}, "1714": {"ground_truth": "0", "bug_report": "huge single insert statements fail with JVM error due to size of generated method\nERROR XBCM1: Java linkage error thrown during load of generated class org.apache.derby.exe.ace5214067x010dx1c21xe385x00000011be005.ERROR XJ001: Java exception: 'Invalid method Code length 68686 in class file org/apache/derby/exe/ace5214067x010dx1c21xe385x00000011be005: java.lang.ClassFormatError'.The above occurred when doing an insert statement using the mutiple row syntax 'INSERT INTO foo (...) VALUES (...)  (...) ...' for huge amounts of input data. I was able to insert 500 rows at once  but it balked at 1000.Workaround: chunk one huge insert into several merely big inserts before sending them to Derby.", "id": "1714"}, "1729": {"ground_truth": "1", "bug_report": "Invoking Java stored procedure that contains GRANT or REVOKE statement with CONTAINS SQL should fail.\nIn Derby SQL authorization mode  invoking Java stored procedure that contains GRANT or REVOKE statement with CONTAINS SQL from a trigger should fail but in the following test  it successfully executed the trigger action. Attaching repro patch for trunk.i.e.:ij&gt; connect 'triggerProcSQLAuth;create=true' user 'APP' as app;WARNING 01J14: SQL authorization is being used without first enabling authentication.ij&gt; &#8212; setup the environment&#8212; table used in the procedurescreate table t1 (i int primary key  b char(15));0 rows inserted/updated/deletedij&gt; insert into t1 values (1  'XYZ');1 row inserted/updated/deletedij&gt; insert into t1 values (2  'XYZ');1 row inserted/updated/deletedij&gt; &#8212; table used in this testcreate table t2 (x integer  y integer);0 rows inserted/updated/deletedij&gt; create procedure grant_select_proc()  parameter style java dynamic result sets 0 language java  contains sql external name 'org.apache.derbyTesting.functionTests.util.ProcedureTest.grantSelect';0 rows inserted/updated/deletedij&gt; create procedure revoke_select_proc()  parameter style java dynamic result sets 0 language java  contains sql external name 'org.apache.derbyTesting.functionTests.util.ProcedureTest.revokeSelect';0 rows inserted/updated/deletedij&gt; &#8212; testscreate trigger grant_select_trig AFTER delete on t1  for each STATEMENT mode db2sql call grant_select_proc();0 rows inserted/updated/deletedij&gt; &#8212; should faildelete from t1 where i = 1;1 row inserted/updated/deletedij&gt; &#8212; check delete failedselect * from t1;I |B ---------------------------2 |XYZ 1 row selectedij&gt; &#8212; check if there are rows in sys.systableperms  should be 0select count from SYS.SYSTABLEPERMS;1 -----------1 1 row selectedij&gt; drop trigger grant_select_trig;0 rows inserted/updated/deletedij&gt; create trigger revoke_select_trig AFTER delete on t1  for each STATEMENT mode db2sql call revoke_select_proc();0 rows inserted/updated/deletedij&gt; &#8212; should faildelete from t1 where i = 2;1 row inserted/updated/deletedij&gt; &#8212; check delete failedselect * from t1;I |B ---------------------------0 rows selectedij&gt; &#8212; check if there are rows in sys.systableperms  should be 0select count from SYS.SYSTABLEPERMS;1 -----------0 1 row selectedij&gt; drop trigger revoke_select_trig;0 rows inserted/updated/deletedij&gt; ------------------ Java Information ------------------Java Version: 1.4.2_12Java Vendor: Sun Microsystems Inc.Java home: C:/Program Files/Java/j2re1.4.2_12Java classpath: derby.jar;derbytools.jarOS name: Windows XPOS architecture: x86OS version: 5.1Java user name: YipJava user home: C:/Documents and Settings/YipJava user dir: C:/work3/derby/trunk/jars/sanejava.specification.name: Java Platform API Specificationjava.specification.version: 1.4--------- Derby Information --------JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&#91;C:/work3/derby/trunk/jars/sane/derby.jar&#93; 10.3.0.0 alpha - (432670M)&#91;C:/work3/derby/trunk/jars/sane/derbytools.jar&#93; 10.3.0.0 alpha - (432670M)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [English/United States &#91;en_US&#93;]Found support for locale: &#91;de_DE&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;es&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;fr&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;it&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;ja_JP&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;ko_KR&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;pt_BR&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;zh_CN&#93; version: 10.3.0.0 alpha - (432670M)Found support for locale: &#91;zh_TW&#93; version: 10.3.0.0 alpha - (432670M)------------------------------------------------------", "id": "1729"}, "1730": {"ground_truth": "0", "bug_report": "Manifest file doesn't contain OSGi attributes\nWith osgi.jar in tools/java  'ant buildjars' does not add the OSGi attributes to derby.jar's manifest. Instead  a file named ${manifest.file} is created in the root of the source tree. This file contains what should have been in the manifest  for instance:Manifest-Version: 1.0Ant-Version: Apache Ant 1.6.5Created-By: diablo-1.5.0_07-b00 (Sun Microsystems Inc.)Bundle-Activator: org.apache.derby.osgi.EmbeddedActivatorDynamicImport-Package: *Export-Package: org.apache.derby.authentication org.apache.derby.datab ase org.apache.derby.io org.apache.derby.jdbc org.apache.derby.vtiThis seems to be caused by build.xml containing a reference to '${manifest.file}' at a location where manifest.file is not bound to a value. The attached patch (manifest.diff) fixes the issue by replacing '${manifest.file}' with '${derby.jar.dir}/lists/smf.mf'.", "id": "1730"}, "1732": {"ground_truth": "0", "bug_report": "The language and store systems treat a JVM error such as OutOfMemoryError differently leading to the raw store protocol violation errors\nDon't have the exact details  but remember noticing it a while ago. I think the store transaction context closes the transaction on such an error  while the language conneciton context just rollsback the transaction or the statement. I think the best and consistent approach would be to close the connection.", "id": "1732"}, "1743": {"ground_truth": "1", "bug_report": "derbynet/testSecMec.java fails with NullPointerException (intermittent failure)\nhttp://www.multinet.no/~solberg/public/Apache/TinderBox_Derby/testlog/SunOS-5.10_i86pc-i386/433374-derbyall_diff.txt                 Diff file derbyall/derbynetclientmats/DerbyNetClient/derbynetmats/derbynetmats/testSecMec.diff             Start: testSecMec jdk1.5.0_04 DerbyNetClient derbynetmats:derbynetmats 2006-08-22 01:45:28 ***61a62 63&gt; java.sql.SQLException: No current connection.&gt; Exception in thread 'DRDAConnThread_15' java.lang.NullPointerExceptionTest Failed. End: testSecMec jdk1.5.0_04 DerbyNetClient derbynetmats:derbynetmats 2006-08-22 01:46:05 ***    Detailed log:Test USRSSBPWD_with_BUILTIN - derby.drda.securityMechanism=nullTurning ON Derby BUILTIN authenticationUSRSSBPWD (T0): jdbc:derby://localhost:20000/wombat;user=neelima;password=lee;shutdown=true;securityMechanism=8 - EXCEPTION DERBY SQL error: SQLCODE: -1  SQLSTATE: 08006  SQLERRMC: Database 'wombat' shutdown.java.sql.SQLException: No current connection. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.noCurrentConnection(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.checkIfClosed(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.setupContextStack(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.rollback(Unknown Source) at org.apache.derby.impl.drda.Database.close(Unknown Source) at org.apache.derby.impl.drda.Session.close(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.closeSession(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)Exception in thread 'DRDAConnThread_15' java.lang.NullPointerException at java.lang.Throwable.printStackTrace(Throwable.java:509) at org.apache.derby.impl.drda.DRDAProtocolException.&lt;init&gt;(Unknown Source) at org.apache.derby.impl.drda.DRDAProtocolException.newAgentError(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.sendUnexpectedException(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.closeSession(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)", "id": "1743"}, "1749": {"ground_truth": "0", "bug_report": "Implement Bracketed SQL comments (/*...*/ comments)\nHibernate use multiline sql statements to show the internal building of the hql statements. You can disable this feature  but it would be nice if you can implements bracketed SQL comments in Derby.Thanks.", "id": "1749"}, "1751": {"ground_truth": "0", "bug_report": "derbynet/testSecMec.java fails with ShutdownException in DerbyNetClient framework\nDuring 10.2.1.0 beta testing this test failed with org.apache.derby.iapi.services.context.ShutdownException on 2 of 4 platforms running Solaris zones:Platform 'sparc_zone2': derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diffPlatform 'sparc_zone3': derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diff derbyall/derbynetclientmats/DerbyNetClient/derbynetmats/derbynetmats/testSecMec.diffThe test did not fail on other platforms  which may indicate timing sensitivity (tests are run concurrently in 4 zones (1 global  3 local) on one single machine). Here is one of the diffs (from platform 'sparc_zone2'):                 Diff file derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diff             Start: testSecMec jdk1.6.0-rc DerbyNetClient derbynetmats:derbynetmats 2006-08-14 21:31:48 ***308a309 312&gt; java.sql.SQLException: Java exception: ': org.apache.derby.iapi.services.context.ShutdownException'.&gt; ... 14 more----------------------------------------------&gt; Testing with derby.drda.securityMechanism=INVALID_VALUE&gt; EXPECTED EXCEPTION DRDA_InvalidValue.U:Invalid value  INVALID_VALUE  for derby.drda.securityMechanism.310 312d313&lt; Testing with derby.drda.securityMechanism=INVALID_VALUE&lt; EXPECTED EXCEPTION DRDA_InvalidValue.U:Invalid value  INVALID_VALUE  for derby.drda.securityMechanism.&lt; -----Test Failed. End: testSecMec jdk1.6.0-rc DerbyNetClient derbynetmats:derbynetmats 2006-08-14 21:32:54 ***    The failure occurred in the DerbyNetClient framework when shutting down the database for the second (and last) time in the method testUSRSSBPWD_with_BUILTIN(). This test method was added August 9  2006 (DERBY-528).Attatching derby.log from the failure in derbynetclientmats/derbynetmats on sparc_zone2.", "id": "1751"}, "1759": {"ground_truth": "0", "bug_report": "XMLSERIALIZE operator doesn't follow SQL/XML spec in some areas when serializing a sequence.\nThe SQL/XML specification dictates that  when serializing a sequence of XML items  the XMLSERIALIZE operator must first 'normalize' the sequence based on the rules defined here: http://www.w3.org/TR/xslt-xquery-serialization/#serdmThe current Derby implementation doesn't perform such normalization  which leads to two ways in which the results of an XMLSERIALIZE operator may not agree with the required behavior: 1. Sequences of atomic values will not have spaces between  but the space is required as part of step 3 of the normalization rules at the above link. 2. Derby will allow serialization of a sequence even if it has a top-level Attribute node in it  but the rules of normalization dictate that an error should be thrown instead (step 7).Both of these behaviors can be seen with the following query.values xmlserialize( xmlquery('/ageinfo/@*' passing by ref xmlparse( document '&lt;ageinfo age='48' birthdate='1900-02-08'/&gt;' preserve whitespace ) empty on empty ) as char(50) )Derby will currently return the following result from this statement:1--------------------------------------------------481900-02-08This result does not abide by SQL/XML specification because a) Derby allowed serialization of a sequence having a top-level attribute node (actually  the sequence had two)  and b) the atomic values produced from the attributes were displayed without a space between them.The correct behavior for the above example is to return a serialization error caused by the presence of an Attribute node in the sequence.If the example was rewritten as  say: xmlquery('/ageinfo/@*' passing by ref+ xmlquery('fn:data(/ageinfo/@*)' passing by refthen the attribute nodes are no longer present--we only have their atomic values  which is allowed. Thus the correct result should then be:1--------------------------------------------------48 1900-02-08Note  though  that Xalan doesn't appear to support the 'fn:data' function  so this rewritten query won't actually work. I tried using Xalan's built-in string function  as follows: xmlquery('/ageinfo/@*' passing by ref+ xmlquery('string(/ageinfo/@*)' passing by refbut Xalan only returns the first attribute in that case; it doesn't return the second one. So part of this Jira issue is probably going to involve figuring out how to allow a user to retrieve a sequence of attribute values (as opposed to attribute nodes) using Xalan and still abide by the SQL/XML rules.", "id": "1759"}, "1760": {"ground_truth": "1", "bug_report": "remote server testing with 10.2 snapshot showed 8 failures\nI ran derbynetclientmats between two IPV6 machines with the 10.2 snapshot and finally got to look at the results...There were 8 failures  4 of those because of other tests leaving stuff behind.2 tests complained about junit classes not being found (? one of those was checkDataSource!).2 tests seemed to have trouble connecting - those might be the more interesting ones.Will do further analysis  &amp; create test cleanup patches.The failing tests and some comments:suite derbynetclientmats with ibm142 &amp; IPV6 machines using -DhostName= (i.e. remote server test) and build: 10.2.0.4 alpha - (419130)derbynetclientmats/derbynetclientmats.fail:jdbcapi/checkDataSource.java ?? fails because of an error accessing junit. Not sure why  junit is in client classpath...and it's not even a junit test. Stack trace not helpful. (points to client.am  which makes little/no sense).derbynetclientmats/derbynetmats/derbynetmats.fail:derbynet/testconnection.java ?? no connectionderbynetclientmats/derbynetmats/derbynetmats.fail:derbynet/testij.java ?? no connectionderbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/metadata.java extra tables/views: JIRA1454  Y.derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/odbc_metadata.java dittoderbynetclientmats/derbynetmats/derbynetmats.fail:lang/syscat.sql dittoderbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/ProcedureTest.junit junit not available??derbynetclientmats/derbynetmats/derbynetmats.fail:jdbcapi/checkDataSource30.java Table/View 'Y' already exists.", "id": "1760"}, "1776": {"ground_truth": "0", "bug_report": "ERROR 42Z72: XML syntax error; missing keyword(s): 'AS'. - Misleading text\ncreate table t (i int  x xml);select xmlserialize from t;ERROR 42Z72: XML syntax error; missing keyword(s): 'AS'.This is not an 'XML Syntax error'  it's a syntax in the SQL language. No need to have a special error messgae here  wouldn't the error be caught by regular parsing?", "id": "1776"}, "1787": {"ground_truth": "0", "bug_report": "The database owner is incorrectly referred to as dba in the code comments that were checked in Derby 10.2 for grant revoke work. We should clean this up at some point.\nGrant revoke functionality was added in Derby 10.2 The comments that went into the grant revoke code  in some places refer to database owner as 'dba'. They are not the same thing. In the grant revoke world  dba is a role. We haven't added roles into Derby yet but current use of dba in comments might make it confusing when we do start working on roles including dba.", "id": "1787"}, "1811": {"ground_truth": "0", "bug_report": "Embedded ResultSet.getTimestamp on a TIME column returns a java.sql.Timestamp with a date portion that can be incorrect.\nThe date portion of the java.sql.Timestamp from a TIME column is intended to be the current date but instead can be any date value  based upon the last getXXX call that required a Java Calendar object.", "id": "1811"}, "1816": {"ground_truth": "0", "bug_report": "Client's ResultSet.getTime() on a SQL TIMESTAMP column loses the sub-second resolution and always has a milli-second value of zero.\nIn embedded the java.sql.Time object returned from ResultSet.getTime() for a SQL TIMESTAMP object has its millisecond value for the time portion equal to that for the java.sql.Timestamp value.In client the millisecond time value for such a value is always set to zero.Note a Derby SQL TIME value has by definition resolution of only a second so its millisecond value is always zero but java.sql.Time is not a direct mapping to the SQL Type  it's a JDBC type  so when converting from a SQL TIMESTAMPit should retain the precision.The new test lang.TimeHandlingTest has this assert code that shows the problem  one of its calls will be commented outwith a comment with this bug number. private void assertTimeEqual(Time tv  Timestamp tsv) { cal.clear(); cal.setTime(tv); int hour = cal.get(Calendar.HOUR_OF_DAY); int min = cal.get(Calendar.MINUTE); int sec = cal.get(Calendar.SECOND); int ms = cal.get(Calendar.MILLISECOND); // Check the time portion is set to the same as tv cal.clear(); cal.setTime(tsv); assertEquals(hour  cal.get(Calendar.HOUR_OF_DAY)); assertEquals(min  cal.get(Calendar.MINUTE)); assertEquals(sec  cal.get(Calendar.SECOND)); assertEquals(ms  cal.get(Calendar.MILLISECOND)); &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; FAILS HERE }", "id": "1816"}, "1828": {"ground_truth": "0", "bug_report": "Access rule violations should use a SQL state starting with '42' according to the SQL standard.\nThe SQL standard says that SQL State '42' is for 'syntax error or accessrule violation' (section 23.1).There is a question of what JDBC 4.0 exception should be thrown for a access rule violation JDBC 4.0 maps '42' to SQLSyntaxErrorException which seems wrong for an access rule.Message thread:http://mail-archives.apache.org/mod_mbox/db-derby-dev/200609.mbox/%3c45004A04.5080002@apache.org%3e", "id": "1828"}, "1829": {"ground_truth": "0", "bug_report": "lang/procedureInTrigger.sql fails with wctme5.7 foundation with CNFE  java.sql.DriverManager and other exceptions.\nTest failed with 10.3 jars 10.3.0.0 alpha - (439522). I am attaching the report file from the test run wctme5.7_derbyall_report.txt . Please see this file for the diff. This test was added as part of DERBY-551 and checkin - r421281.", "id": "1829"}, "1832": {"ground_truth": "1", "bug_report": "sysinfo test fails with 'access denied (java.util.PropertyPermission java.class.path read)' when derbyclient.jar is first in classpath\nSeen on Linux and Solaris  with Sun JVM 1.4  1.5  1.6 when derbyclient.jar is first in classpath:                 Diff file derbyall/derbynetmats/DerbyNet/derbynetmats/sysinfo.diff             Start: sysinfo jdk1.4.2_02 DerbyNet derbynetmats:derbynetmats 2006-09-05 08:44:54 ***14a15&gt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)17 26d17&lt; Current Locale : [English/United States &#91;en_US&#93;]&lt; Found support for locale: &#91;de_DE&#93;&lt; Found support for locale: &#91;es&#93;&lt; Found support for locale: &#91;fr&#93;&lt; Found support for locale: &#91;it&#93;&lt; Found support for locale: &#91;ja_JP&#93;&lt; Found support for locale: &#91;ko_KR&#93;&lt; Found support for locale: &#91;pt_BR&#93;&lt; Found support for locale: &#91;zh_CN&#93;&lt; Found support for locale: &#91;zh_TW&#93;41a33&gt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)44 53d35&lt; Current Locale : [English/United States &#91;en_US&#93;]&lt; Found support for locale: &#91;de_DE&#93;&lt; Found support for locale: &#91;es&#93;&lt; Found support for locale: &#91;fr&#93;&lt; Found support for locale: &#91;it&#93;&lt; Found support for locale: &#91;ja_JP&#93;&lt; Found support for locale: &#91;ko_KR&#93;&lt; Found support for locale: &#91;pt_BR&#93;&lt; Found support for locale: &#91;zh_CN&#93;&lt; Found support for locale: &#91;zh_TW&#93;69a52&gt; Unable to analyze class path: access denied (java.util.PropertyPermission java.class.path read)72 81d54&lt; Current Locale : [English/United States &#91;en_US&#93;]&lt; Found support for locale: &#91;de_DE&#93;&lt; Found support for locale: &#91;es&#93;&lt; Found support for locale: &#91;fr&#93;&lt; Found support for locale: &#91;it&#93;&lt; Found support for locale: &#91;ja_JP&#93;&lt; Found support for locale: &#91;ko_KR&#93;&lt; Found support for locale: &#91;pt_BR&#93;&lt; Found support for locale: &#91;zh_CN&#93;&lt; Found support for locale: &#91;zh_TW&#93;Test Failed. End: sysinfo jdk1.4.2_02 DerbyNet derbynetmats:derbynetmats 2006-09-05 08:44:59 ***", "id": "1832"}, "1834": {"ground_truth": "0", "bug_report": "Correct message SQL State 01006 to reflect that is being revoked - 'user' and update the Ref Manual\nthe SQL State 01006 'Privilege not revoked from {0}.' should be changed to 'Privilege notrevoked from user {0}.'Once changed in the code  the Ref Manual file rrefexcept71493. dita needs to be updated as well.", "id": "1834"}, "1844": {"ground_truth": "0", "bug_report": "jdbcapi/blobclob4BLOB.java fails with JCC drivers\nTest fails with JCC versions 2.4  2.6 and 2.8. Sample diff:&lt; FAIL: Caught exception java.lang.NegativeArraySizeException592a592&gt; FAIL: Caught exception java.lang.NegativeArraySizeException:", "id": "1844"}, "1846": {"ground_truth": "0", "bug_report": "Create a script that allows users to easily update their Derby jars with the JDBC4 classes.\nSince the resolution of the JDBC 4 licensing issue was to not ship a build that includes Derby's JDBC 4 code  but continue to ship the Derby source files for them  a script which automatically compiles and updates the Derby jars with the JDBC 4 classes would be useful.", "id": "1846"}, "1849": {"ground_truth": "1", "bug_report": "Tests lang/grantRevokeDDL.sql and lang/grantRevokeDDL2.sql fails on IBM WCTME 5.7 Foundation (jdkJ2ME Foundation Specification v1.0)\nThe diff for grantRevokeDDL.sql is big  hence attaching. For lang/grantRevokeDDL2.sql the diff is as follows:                 Diff file derbyall/derbylang/grantRevokeDDL2.diff             Start: grantRevokeDDL2 jdkJ2ME Foundation Specification v1.0 derbyall:derbylang 2006-09-10 11:42:23 ***0a1&gt; java.lang.reflect.InvocationTargetException: java.lang.NullPointerException99 del&lt; ERROR: Failed with SQLSTATE 3800199a100&gt; ERROR: Failed with SQLSTATE XJ001119 del&lt; ERROR: Failed with SQLSTATE 38002119a120&gt; ERROR: Failed with SQLSTATE XJ001139 del&lt; ERROR: Failed with SQLSTATE 38002139a140&gt; ERROR: Failed with SQLSTATE XJ001158 del&lt; 1 row inserted/updated/deleted158a159 160&gt; ERROR: Failed with SQLSTATE 38000&gt; ERROR: Failed with SQLSTATE XJ001163 del&lt; 0 rows selected163a165 166&gt; 4 |XYZ &gt; 1 row selected168a172 182&gt; ERROR: Failed with SQLSTATE 28508&gt; ij(USER2)&gt; set connection user1;&gt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &gt; for each STATEMENT mode db2sql call revoke_select_proc1();&gt; 0 rows inserted/updated/deleted&gt; ij(USER1)&gt; &#8211; should fail&gt; delete from t1 where i = 5;&gt; ERROR: Failed with SQLSTATE 38000&gt; ERROR: Failed with SQLSTATE XJ001&gt; ij(USER1)&gt; &#8211; check delete failed&gt; select * from t1 where i = 5;171 184d184&lt; 1 |XYZ &lt; 1 row selected&lt; ij(USER2)&gt; set connection user1;&lt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &lt; for each STATEMENT mode db2sql call revoke_select_proc1();&lt; 0 rows inserted/updated/deleted&lt; ij(USER1)&gt; &#8211; should fail&lt; delete from t1 where i = 5;&lt; ERROR: Failed with SQLSTATE 38000&lt; ERROR: Failed with SQLSTATE 38001&lt; ij(USER1)&gt; &#8211; check delete failed&lt; select * from t1 where i = 5;&lt; I |B &lt; ---------------------------191a192 202&gt; ERROR: Failed with SQLSTATE 28508&gt; ij(USER2)&gt; set connection user1;&gt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &gt; for each STATEMENT mode db2sql call revoke_select_proc2();&gt; 0 rows inserted/updated/deleted&gt; ij(USER1)&gt; &#8211; should fail&gt; delete from t1 where i = 6;&gt; ERROR: Failed with SQLSTATE 38000&gt; ERROR: Failed with SQLSTATE XJ001&gt; ij(USER1)&gt; &#8211; check delete failed&gt; select * from t1 where i = 6;194 207d204&lt; 1 |XYZ &lt; 1 row selected&lt; ij(USER2)&gt; set connection user1;&lt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &lt; for each STATEMENT mode db2sql call revoke_select_proc2();&lt; 0 rows inserted/updated/deleted&lt; ij(USER1)&gt; &#8211; should fail&lt; delete from t1 where i = 6;&lt; ERROR: Failed with SQLSTATE 38000&lt; ERROR: Failed with SQLSTATE 38002&lt; ij(USER1)&gt; &#8211; check delete failed&lt; select * from t1 where i = 6;&lt; I |B &lt; ---------------------------214a212 222&gt; ERROR: Failed with SQLSTATE 28508&gt; ij(USER2)&gt; set connection user1;&gt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &gt; for each STATEMENT mode db2sql call revoke_select_proc3();&gt; 0 rows inserted/updated/deleted&gt; ij(USER1)&gt; &#8211; should fail&gt; delete from t1 where i = 7;&gt; ERROR: Failed with SQLSTATE 38000&gt; ERROR: Failed with SQLSTATE XJ001&gt; ij(USER1)&gt; &#8211; check delete failed&gt; select * from t1 where i = 7;217 230d224&lt; 1 |XYZ &lt; 1 row selected&lt; ij(USER2)&gt; set connection user1;&lt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &lt; for each STATEMENT mode db2sql call revoke_select_proc3();&lt; 0 rows inserted/updated/deleted&lt; ij(USER1)&gt; &#8211; should fail&lt; delete from t1 where i = 7;&lt; ERROR: Failed with SQLSTATE 38000&lt; ERROR: Failed with SQLSTATE 38002&lt; ij(USER1)&gt; &#8211; check delete failed&lt; select * from t1 where i = 7;&lt; I |B &lt; ---------------------------237a232 242&gt; ERROR: Failed with SQLSTATE 28508&gt; ij(USER2)&gt; set connection user1;&gt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &gt; for each STATEMENT mode db2sql call revoke_select_proc4();&gt; 0 rows inserted/updated/deleted&gt; ij(USER1)&gt; &#8211; ok&gt; delete from t1 where i = 8;&gt; ERROR: Failed with SQLSTATE 38000&gt; ERROR: Failed with SQLSTATE XJ001&gt; ij(USER1)&gt; &#8211; check delete &gt; select * from t1 where i = 8;240 del&lt; 1 |XYZ 240a245&gt; 8 |XYZ 241a247 252&gt; ij(USER1)&gt; drop trigger revoke_select_trig;&gt; 0 rows inserted/updated/deleted&gt; ij(USER1)&gt; set connection user2;&gt; ij(USER2)&gt; &#8211; should fail&gt; select * from user1.t1 where i = 1;&gt; ERROR: Failed with SQLSTATE 28508243 260d253&lt; ij(USER1)&gt; create trigger revoke_select_trig AFTER delete on t1 &lt; for each STATEMENT mode db2sql call revoke_select_proc4();&lt; 0 rows inserted/updated/deleted&lt; ij(USER1)&gt; &#8211; ok&lt; delete from t1 where i = 8;&lt; 1 row inserted/updated/deleted&lt; ij(USER1)&gt; &#8211; check delete &lt; select * from t1 where i = 8;&lt; I |B &lt; ---------------------------&lt; 0 rows selected&lt; ij(USER1)&gt; drop trigger revoke_select_trig;&lt; 0 rows inserted/updated/deleted&lt; ij(USER1)&gt; set connection user2;&lt; ij(USER2)&gt; &#8211; should fail&lt; select * from user1.t1 where i = 1;&lt; ERROR: Failed with SQLSTATE 28508&lt; ij(USER2)&gt; set connection user1;Test Failed. End: grantRevokeDDL2 jdkJ2ME Foundation Specification v1.0 derbyall:derbylang 2006-09-10 11:42:33 ***", "id": "1849"}, "1866": {"ground_truth": "0", "bug_report": "Assert failure in sane mode for queries that used to work in 10.1.2.1\nDerby-1777 gives a database and a small program called 'ViewerInit' that prepares a bunch of large queries involving nested subqueries  unions  and join predicates. The actual bug described in DERBY-1777 is an NPE  and that's what the patch for DERBY-1777 addresses.However  once the NPEs are fixed  some of the queries in that same program now fail with ASSERT failures when running in SANE mode; this Jira issue is for addressing those assert failures.While this does constitute a regression  I don't know yet what the root cause of the problem is  so I hesitate to make it a 10.2 blocker--hence urgency is 'Normal'. I'm still investigating the queries to try to track down where the problem is  but all I've been able to deduce so far is that a) the assertion occurs for a scoped predicate and thus the pushing of join predicates into UNIONs is somehow involved  and b) in INSANE mode the query compiles without problem and appears (based on some early and very incomplete testing) to execute without problem. But more investigation is required to determine if the execution/results are actually correct  and to understand more about why the assertion is being thrown.I'm marking the fixin as 10.2.2.0 for now since I don't enough to make this a blocker for 10.2.1. Hopefully more info will be forthcoming...", "id": "1866"}, "1874": {"ground_truth": "0", "bug_report": "largeDataTests/LobLimits master needs update for new exception names\n&lt; EXPECTED SQL Exception: (XJ001) Java exception: 'Input stream did not have exact amount of data as the requested length.: java.io.IOException'.47a47&gt; EXPECTED SQL Exception: (XJ001) Java exception: 'Input stream did not have exact amount of data as the requested length.: org.apache.derby.iapi.services.io.DerbyIOException'.+ moreSee http://www.multinet.no/~solberg/public/Apache/LargeData/testlog/SunOS-5.10_i86pc-i386/448277-largeData_diff.txt", "id": "1874"}, "1885": {"ground_truth": "0", "bug_report": "The source distribution for 10.2.1.4 rc1 includes derby.log files\nThe db-derby-10.2.1.4-src release candidate built on 9/22/06 includes derby.log files. db-derby-10.2.1.4-src/derby.log db-derby-10.2.1.4-src/java/demo/toursdb/derby.logFile sizes: $ ls -l derby.log rw-rw-r- 1 jta jta 767545 Sep 22 16:12 derby.log $ ls -l java/demo/toursdb/derby.log rw-rr- 1 jta jta 542 Sep 22 14:28 java/demo/toursdb/derby.logIf the release candidates need to be rebuilt  it would be good to remove those derby.log files  but it doesn't harm anything to have them in there (just consumes a little space).The db-derby-10.2.1.4-lib and db-derby-10.2.1.4-bin distributions don't have these files.", "id": "1885"}, "1891": {"ground_truth": "0", "bug_report": "error 58009.C.19  refers to non-existent codepoint secktn - needs correcting\nerror 58009.C.19=Network protocol exception: secktn was not returned. The connection has been terminated.This is NET_SECTKN_NOT_RETURNED in org.apache.derby.drda.client.net.NetConnection.javaI searched in the drda specs but I could not find SECKTN  but I did find SECTKN.So...I think the error message should get changed to SECTKN.The same non-existent codepoint seems to be referred to in: XN002.U=secktn was not returned.This affects the following: English messages .properties file(s) Brazilian messages .properties file(s) documentation for SQLStates.I didn't find any masters with this.It should probably go into 10.2.1  although it's not important enough to hold up a release. Targeting for 10.2.2 for now.Myrna", "id": "1891"}, "1894": {"ground_truth": "0", "bug_report": "SQLSTATE 42X10 occurs when qualifying a column with a synonym in ORDER BY clause\nSQLSTATE 42X10 occurs when qualifying a column with a synonym in ORDER BY clause  where the synonym was declared in a different schema:ij version 10.3ij&gt; connect 'jdbc:derby:wombat;create=true';ij&gt; create schema test1;0 rows inserted/updated/deletedij&gt; create schema test2;0 rows inserted/updated/deletedij&gt; create table test1.testtable(id bigint not null);0 rows inserted/updated/deletedij&gt; create synonym test2.testtable for test1.testtable;0 rows inserted/updated/deletedij&gt; set schema test1;0 rows inserted/updated/deletedij&gt; select testtable.id from testtable;ID --------------------0 rows selectedij&gt; set schema test2;0 rows inserted/updated/deletedij&gt; select testtable.id from testtable;ID --------------------0 rows selectedij&gt; select testtable.id from testtable order by testtable.id;ERROR 42X10: 'TESTTABLE' is not an exposed table name in the scope in which it appears.ij&gt;", "id": "1894"}, "1899": {"ground_truth": "0", "bug_report": "10.2.1.5 source distribution is missing many files and includes some files that it should not.\nThe source distribution is missing the top-level bin and maven directories  as well as BUILDING.txt  README  index.html  and published-api-overview.html. Also  the tools directory is missing release/build.xml.In addition  tools/testing/derby contains a complete set of the Derby 10.1 jars  these should be removed from the -src distribution.", "id": "1899"}, "1900": {"ground_truth": "1", "bug_report": "The scripts under the /bin of the distribution does not have the executable permission\nThe scripts under the /bin directory of the distribution does not have the execute permission. Here is the dir listing:rw-rr- 1 rajeshk RD 1153 2006-09-15 12:12 dblookrw-rr- 1 rajeshk RD 1353 2006-09-15 12:20 dblook.batrw-rr- 1 rajeshk RD 2348 2006-09-15 12:12 derby_common.batrw-rr- 1 rajeshk RD 4853 2006-09-15 12:56 derby_common.shrw-rr- 1 rajeshk RD 1241 2006-09-15 12:12 ijrw-rr- 1 rajeshk RD 1345 2006-09-15 12:20 ij.bat....The issue was raised in the list earlierhttp://www.nabble.com/Questions-on-the-scripts-in--bin--directory-of-Derby-install-p6271633.htmlbut looks it is not fully resolved.", "id": "1900"}, "1909": {"ground_truth": "1", "bug_report": "ALTER TABLE DROP COLUMN needs to update GRANTed column privileges\nWhen ALTER TABLE DROP COLUMN is used to drop a column from a table  it needs to update the GRANTed column privileges on that table.The following behaviors need to be provided: DROP COLUMN needs to automatically revoke any privileges which have been granted on this column Privileges which have been granted on other columns in this table need to be adjusted due to changed column position numbersWhen this problem is fixed  the following additional cleanup steps should occur: The check that disables DROP COLUMN in sqlAuthorization mode needs to be removed There is a comment in AlterTableConstantAction that needs to be revised The tests in lang/altertableDropColumn.sql should be moved into altertable.sql altertableDropColumn.sql and altertableDropColumn.out should be deletedSearch for this JIRA issue number in the code to find the relevant places to change.", "id": "1909"}, "1921": {"ground_truth": "0", "bug_report": "Bring STATUS file up to date\nThe STATUS file is stale:1) Votes taken since February aren't mentioned.2) The development trunk is labelled as 10.23) The committer list is stale.", "id": "1921"}, "1922": {"ground_truth": "0", "bug_report": "readme.html under frameworks does not mention about Derby client and some minor typos in example.html\nThe readme.html file under frameworks mentions about the JCC driver but nothing about the Derbyclient.Also under the demo/programs/simple/example.html some minor issues/typos:Under the section 'Next run the SimpleApp demo in Derby client mode:' step 5 on classpath mentions:NOT FOUND IN CLASS PATH: Derby Client libraries (db2jcc.jar) (com.ibm.db2.jcc.DB2Driver not found.)The above show JCC info instead of Derby Client", "id": "1922"}, "1925": {"ground_truth": "0", "bug_report": "Add re-encrytion  of database test cases to the upgrade test..\nAdd a encryption of an un-encrypted database and re-encryption of encrypted database test case to the upgrade test. Please see DERBY-1156 for details about re-encryption feature. re-encrytpion test cases will be added to run only when test is executed using jar files. Upgrade test mixes the old version of derby classes in the jar files and the new classes when run under code-line using classes.; This cause boot time error when databases is encrypted ( This kind of mixing different version of classes is not supported   see DERBY-1898) .", "id": "1925"}, "1953": {"ground_truth": "0", "bug_report": "Make FOR EACH clause and MODE DB2SQL in CREATE TRIGGER statement optional\nAccording to SQL:2003 standard  section 11.39 &lt;trigger definition&gt;  under Syntax Rules item 8:If neither FOR EACH ROW nor FOR EACH STATEMENT is specified  then FOR EACH STATEMENT is implicit.[ FOR EACH { ROW | STATEMENT } ]", "id": "1953"}, "1956": {"ground_truth": "0", "bug_report": "Remove stale code from the statement classes in the client driver\nStatement and ParameterMetaData contain flags called escapedProcedureCallWithResult_. These flags might have had a function before  but now they are always false. They are used in many if-statements and make the code harder to read. Removing the flags and the code that is only executed when the flags are true  would simplify the code and make it more maintainable.", "id": "1956"}, "1958": {"ground_truth": "0", "bug_report": "improve XSDG3 error to print container  actual i/o operation  and file name.\nThe current error does not give enough information to know what container is the problem:ERROR XSDG3: Meta-data for Containerorg.apache.derby.impl.store.raw.data.RAFContainer@10632cd could not beaccessed", "id": "1958"}, "1963": {"ground_truth": "0", "bug_report": "Routine parameter names displayed by dblook are not escaped.\nAfter using this SQL to create a function with a delimited parameter nameCREATE FUNCTION FRED ('paramOne' INTEGER) RETURNS INTEGERLANGUAGE JAVA PARAMETER STYLE JAVA EXTERNAL NAME 'fred.foo' dblook will output a CREATE FUNCTION statement with the parameter name without quotes:CREATE FUNCTION 'APP'.'FRED' (paramOne INTEGER) RETURNS INTEGERLANGUAGE JAVA PARAMETER STYLE JAVAREADS SQL DATA CALLED ON NULL INPUTEXTERNAL NAME 'fred.foo';Using the output from dblook to re-create the function will result in a function with a different parameter name.", "id": "1963"}, "1974": {"ground_truth": "0", "bug_report": "Junit tests that require SQL authorization mode should use a different database to the default one.\nSince databases are re-used in the JUnit world having a single database for the two modes does not work.Not sure if there are any tests that need this yet. SQLAuthorizationPropTest actually tests setting the property so it really needs its own database (I think).", "id": "1974"}, "1987": {"ground_truth": "0", "bug_report": "Add Order Entry application/system/performance test/toolkit\nOrder Entry (OE) is an OLTP application/toolkit which is based upon the TPC-C specification but is not claiming to be a valid implementation. The TPC-C specification is used mainly forthe database schema &amp; population rules and the logic of the business transactions.http://www.tpc.org/tpcc/OE is set up so that the driving &amp; display of the business transactions is separated from the actual implementation which then allows different implementations to compare performance of Derby features. In all cases the implementationswould perform the logical functionality required by the TPC-C  but need not be strict implementations. As an examplethe new order number is obtained in a defined way in TPC-C  but Derby could use generated keys to perform thesame logical function. Testing the two ways would lead to see if there were performance problems with generated keys.Examples of the possible implementations of the business transactions are: direct - client executes SQL statements directly holding onto PreparedStatements for the lifetime of the client) procedure - client executes a procedure per business transaction EOD - implementation using JDBC 4^H5? EOD updateable ResultSets positioned updates etc.Other options include use of triggers use of generated keys etc.Possible values for the display (results of the transaction) nothing text HTML for servlets/JSPs etc.Also the loading of the data could support different options: load with/without contraints in place load using INSERT statements load using import load using import with a ResultSet class.OE allows the amount of data loaded initially to be varied very easily  just by setting the warehousescale factor  so a warehouse=1 creates a database of size N  and warehouse=100 a database of size 100N (roughly).This allows databases in the range 10-100Gb to be easily created.The general setup would that OE could be used as a function test  performance test  or stress test so it's seen as a toolkit.I hope also that the OE could be expanded beyond the TPC-C spec  for example: adding images (BLOBs) and descriptions (CLOBs) to the product ITEM table. adding triggers to send-email on various actions.These additions would be intended to test Derby functionality in a 'real-world' OLTP application.The top-level package under java/testing would be org.apache.derbyTesting.systemTests.oe", "id": "1987"}, "1988": {"ground_truth": "0", "bug_report": "Convert jdbc4/TestJDBC40Exception.java to JUnit\nTestJDBC40Exception is written in a JUnit-like style and could easily be converted into JUnit.", "id": "1988"}, "1989": {"ground_truth": "0", "bug_report": "Convert jdbc4/TestDbMetaData.java to JUnit\nRewrite the test in JUnit using the utility methods added in DERBY-1976.", "id": "1989"}, "1991": {"ground_truth": "0", "bug_report": "Misleading stack traces for exceptions raised by the JDBC 4.0 embedded driver\nWhen the embedded driver raises an SQLException  its stack trace alwayssays it is created in SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA().This is not correct.At some point  SQLExceptionFactory40.getSQLException() set the stack traceof the SQLException to the stack trace of the non-SQLException that causedit  if there were one. This was probably done to mimic the behaviour ofEmbedSQLException  which overrides printStackTrace() to achieve thesame. Later  code was added to ferry arguments over DRDA. This code createda dummy exception which the old code interpreted as a non-SQLExceptionwhose stack trace should be used for the main exception. Therefore  allexceptions now have the same stack trace as the dummy exception created inwrapArgsForTransportAcrossDRDA().I think the best solution is not to set the stack trace explicitly  noteven when the SQLException is caused by a non-SQLException.EmbedSQLException overrides printStackTrace() because throwables in Java1.3 didn't have initCause()/getCause()  so it was the only way to preservethe original stack trace. Since the SQLExceptions in JDBC 4.0 haveinitCause()/getCause()  there is no reason why the JDBC4 driver shouldmimic EmbedSQLException's workaround for not having these methods.", "id": "1991"}, "2003": {"ground_truth": "0", "bug_report": "Use a lower wait timeout in BlobClob4BlobTest\nThese test cases wait 60 seconds for a timeout: testLockingClob testLockingWithLongRowClob testLockingBlob testLockingWithLongRowBlobSince they run both in embedded and network client mode  BlobClob4BlobTest spends about eight minutes waiting for a timeout. Therefore  it would be good if its setUp() method lowered the timeout (and tearDown() reset it). TestJDBC40Exception shows how this could be achieved.", "id": "2003"}, "2008": {"ground_truth": "1", "bug_report": "NullPointerException with LTRIM  RTRIM and 2-argument SUBSTR() call in GROUP BY clause.\nThe following query  which fails with a syntax error in 10.1.3 (because functions are not allowed in a GROUP BY expression for 10.1) fails with a NullPointerException in 10.2 and in the codeline (10.3):create table dt (vc varchar(30)); insert into dt values ('1928-09-21')  ('1903-12-08'); select substr(vc  3) from dt group by substr(vc  3); Result (on trunk) is:java.lang.NullPointerException at org.apache.derby.impl.sql.compile.TernaryOperatorNode.isEquivalent(TernaryOperatorNode.java:924) at org.apache.derby.impl.sql.compile.GroupByList.findGroupingColumn(GroupByList.java:244) at org.apache.derby.impl.sql.compile.VerifyAggregateExpressionsVisitor.skipChildren(VerifyAggregateExpressionsVisitor.java:146) at org.apache.derby.impl.sql.compile.TernaryOperatorNode.accept(TernaryOperatorNode.java:497) at org.apache.derby.impl.sql.compile.ResultColumn.accept(ResultColumn.java:1515) at org.apache.derby.impl.sql.compile.QueryTreeNodeVector.accept(QueryTreeNodeVector.java:159) at org.apache.derby.impl.sql.compile.SelectNode.bindExpressions(SelectNode.java:619) at org.apache.derby.impl.sql.compile.FromSubquery.bindExpressions(FromSubquery.java:262) at org.apache.derby.impl.sql.compile.FromList.bindExpressions(FromList.java:337) at org.apache.derby.impl.sql.compile.SelectNode.bindExpressions(SelectNode.java:500) at org.apache.derby.impl.sql.compile.DMLStatementNode.bindExpressions(DMLStatementNode.java:249) at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(DMLStatementNode.java:162) at org.apache.derby.impl.sql.compile.CursorNode.bind(CursorNode.java:253) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:345) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:119) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:745) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:568) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517)", "id": "2008"}, "2016": {"ground_truth": "1", "bug_report": "ArrayIndexOutOfBoundsException for COALESCE with aggregate functions\nThe following statements produce an ArrayIndexOutOfBoundsException:CREATE TABLE t1 ( f1 INTEGER);SELECT COALESCE(MAX(f1) 0) FROM t1;Workaround: VALUES COALESCE( (SELECT MAX(f1) FROM t1)  0);Stack trace:----------------------------------------------------------------2006-10-29 14:52:53.765 GMT: Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.1.6 - (452058): instance c013800d-010e-948f-0faa-00000012f418on database directory C:/temp_sys/temp_Derby_TestErr_dbDatabase Class Loader started - derby.database.classpath=''2006-10-29 14:53:02.906 GMT Thread&#91;main 5 main&#93; (XID = 122)  (SESSIONID = 0)  (DATABASE = c:/temp_sys/temp_Derby_TestErr_db)  (DRDAID = null)  Cleanup action starting2006-10-29 14:53:02.906 GMT Thread&#91;main 5 main&#93; (XID = 122)  (SESSIONID = 0)  (DATABASE = c:/temp_sys/temp_Derby_TestErr_db)  (DRDAID = null)  Failed Statement is: SELECT COALESCE(MAX(f1) 0) FROM t1java.lang.ArrayIndexOutOfBoundsException: -1 at org.apache.derby.impl.services.bytecode.BCMethod.popStack(Unknown Source) at org.apache.derby.impl.services.bytecode.BCMethod.callMethod(Unknown Source) at org.apache.derby.impl.sql.compile.ResultColumnList.generateCore(Unknown Source) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(Unknown Source) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(Unknown Source) at org.apache.derby.impl.sql.compile.ScrollInsensitiveResultSetNode.generate(Unknown Source) at org.apache.derby.impl.sql.compile.CursorNode.generate(Unknown Source) at org.apache.derby.impl.sql.compile.StatementNode.generate(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)", "id": "2016"}, "2018": {"ground_truth": "1", "bug_report": "NullPointerException in CREATE VIEW ... VALUES NULL;\nThe following statement produces a NullPointerException: CREATE VIEW v1 (f1) AS VALUES NULL;Stack trace:----------------------------------------------------------------2006-10-30 12:39:31.750 GMT: Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.1.6 - (452058): instance c013800d-010e-993b-512f-00000012f418on database directory C:/temp_sys/temp_Derby_TestErr_dbDatabase Class Loader started - derby.database.classpath=''2006-10-30 12:39:38.484 GMT Thread&#91;main 5 main&#93; (XID = 122)  (SESSIONID = 0)  (DATABASE = c:/temp_sys/temp_Derby_TestErr_db)  (DRDAID = null)  Cleanup action starting2006-10-30 12:39:38.484 GMT Thread&#91;main 5 main&#93; (XID = 122)  (SESSIONID = 0)  (DATABASE = c:/temp_sys/temp_Derby_TestErr_db)  (DRDAID = null)  Failed Statement is: CREATE VIEW v1 (f1) AS VALUES NULLjava.lang.NullPointerException at org.apache.derby.impl.sql.catalog.SYSCOLUMNSRowFactory.makeRow(Unknown Source) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptorArray(Unknown Source) at org.apache.derby.impl.sql.execute.CreateViewConstantAction.executeConstantAction(Unknown Source) at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)", "id": "2018"}, "2022": {"ground_truth": "0", "bug_report": "jdbcapi.LobStreamsTest runs only in client (not embedded) but its suite() method gives no reason why.\nIt's essential to document why such decisions were made  makes life easier for subsequent deveopers as they try to understand the code and why it is not being used to test embedded.", "id": "2022"}, "2026": {"ground_truth": "0", "bug_report": "Setting a login timeout in client driver can lead to query timeout\nSetting the login timeout by using DriverManager.setLoginTimeout(intseconds) also affects the amount of time the client driver is waitingfor a query to finish. For instance  setting the login timeout to 10seconds will result in any queries taking more than 10 seconds to failwith the following exception:Exception thrown: java.sql.SQLException: A communications error has been detected: Read timed out.java.sql.SQLException: A communications error has been detected: Read timed out. at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:46) at org.apache.derby.client.am.SqlException.getSQLException(SqlException.java:345) at org.apache.derby.client.am.Statement.executeQuery(Statement.java:414) at LoginTimeout.main(LoginTimeout.java:53)Caused by: org.apache.derby.client.am.DisconnectException: A communications error has been detected: Read timed out. at org.apache.derby.client.net.NetAgent.throwCommunicationsFailure(NetAgent.java:408) at org.apache.derby.client.net.Reply.fill(Reply.java:176) at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Reply.java:215) at org.apache.derby.client.net.Reply.readDssHeader(Reply.java:317) at org.apache.derby.client.net.Reply.startSameIdChainParse(Reply.java:1147) at org.apache.derby.client.net.NetStatementReply.readPrepareDescribeOutput(NetStatementReply.java:51) at org.apache.derby.client.net.StatementReply.readPrepareDescribeOutput(StatementReply.java:40) at org.apache.derby.client.net.NetStatement.readPrepareDescribeOutput_(NetStatement.java:139) at org.apache.derby.client.am.Statement.readPrepareDescribeOutput(Statement.java:1341) at org.apache.derby.client.am.Statement.flowExecute(Statement.java:1977) at org.apache.derby.client.am.Statement.executeQueryX(Statement.java:420) at org.apache.derby.client.am.Statement.executeQuery(Statement.java:405) ... 1 moreCaused by: java.net.SocketTimeoutException: Read timed out at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.read(SocketInputStream.java:129) at org.apache.derby.client.net.Reply.fill(Reply.java:174) ... 11 more", "id": "2026"}, "2030": {"ground_truth": "0", "bug_report": "'set schema sys' followed by 'show tables' does not show tables in sys schema\nIf you create a new database in IJ  followed by 'set schema sys' and then 'show tables'  ij shows no tables in the schema. This is because ij's show tables command only shows system tables if a schema is provided.", "id": "2030"}, "2037": {"ground_truth": "0", "bug_report": "provide checking tool to flag possible errors in message translations\nIt would be useful to have a tool available that flags possible translation file issues  such as: missing translations for (new) English messages mismatched parameters between English and non-English messages translation of keywords quoting problems (i.e. use of double quotes when single quotes should be used  use of single quotes when double quotes should be used. This is based on what's described in the MessageFormat api doc) mismatched characters such as &lt; (when meaning smaller than)  &gt; (when meaning larger than)  % etc. identification of invalid characters  specifically characters in the range of 0x00-0x1f (which are ASCII) and 0x7f-0xffNote that such a tool cannot be definite (except about the missing messages) because the English messages are not following very strict formatting  and because what's acceptable syntax/grammar in one language may not work in another. A discussion about a first cut at such a tool can be found at:http://comments.gmane.org/gmane.comp.apache.db.derby.devel/32187", "id": "2037"}, "2040": {"ground_truth": "1", "bug_report": "Setting derby.database.classpath to contain installed jars causes the database to be unbootable when a Securitymanager is installed.\nIf the jars are sucessfully installed (without a security manager see DERBY-537) and the class path set then subsequent boots with a security manager fail with a SecurityException due to trying to install a class loader.Related to DERBY-537 but not the same.", "id": "2040"}, "2046": {"ground_truth": "0", "bug_report": "Make class org.apache.derby.iapi.store.raw.PageKey final\nThe methods of the PageKey class are called frequently both from the lock manager and the cache manager. Since no other classes extend it  it should be declared final to help the run-time compiler optimize the method calls.", "id": "2046"}, "2047": {"ground_truth": "0", "bug_report": "TestDataSourceFactory doesn't work correctly outside the old harness\nTestDataSourceFactory uses TestUtil to create DataSource  ConnectionPoolDataSource and XADataSource objects. TestUtil needs to run in the old harness in order to detect which framework it is running under  so it will create embedded data sources for all JUnit tests that are run outside the old harness.", "id": "2047"}, "2048": {"ground_truth": "0", "bug_report": "LangScripts JUnit test fails in views.sql\nLangScripts JUnit test fails in views.sqlThere was 1 failure:1) views(org.apache.derbyTesting.functionTests.tests.lang.LangScripts )junit.framework.ComparisonFailure: Output at line 104 expected:&lt;...T1' because VIEW 'SV&#91;1&#93;' is dependent on th...&gt; but was:&lt;...T1' because VIEW 'SV&#91;2&#93;' is dependent on th...&gt; at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:100) at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:117) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)FAILURES!!!Tests run: 2016  Failures: 1  Errors: 0Some observations:If org.apache.derbyTesting.functionTests.tests.lang.LangScripts is used to run views.sql as a single test  then it ran smoothly without a problem..Time: 7.109OK (1 test)But if views.sql is run as part of a suite  then the ordering diff occurs.", "id": "2048"}, "2052": {"ground_truth": "0", "bug_report": "JDBC.assertRowInResultSet compares the wrong value if using trimmed strings and a SMALLINT column exists.\nThere is a bug in assertRowInResultSet where a path through the loop does not set the variable obj.This leads to it being compared with the previous value.Using locally scoped variables within the loop would have most likely caught this bug at development time.Then the compiler sees that obj has one uninitialzed path through the code and throws an error.", "id": "2052"}, "2054": {"ground_truth": "0", "bug_report": "Rewrite 'derbynet/SuicideOfStreaming' to a JUnit test\nThe test 'derbynet/SuicideOfStreaming' should be rewritten to a JUnit test more in line with our newly created test system.It is one of the last tests still being run from the deprecated 'tests/junitTests/' directory  through a wrapper class.", "id": "2054"}, "2074": {"ground_truth": "1", "bug_report": "NullPointerException when two threads load sort factory concurrently\n12:34:45 323 ERROR &#91;pool-1-thread-3&#93; history.helpers.HistoryDataAccessHelper - failed to read measurements  filter = (fromTime=Mon Nov 06 12:34:00 MSK 2006  toTime=Mon Nov 13 12:34:00 MSK 2006    properties=2-6-2-value) org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL &#91;SELECT COUNT(DISTINCT sshis.measurement_time) FROM sshis_property_measurement sshis INNER JOIN sstmp_filter_3 filtertbl ON sshis.property_id = filtertbl.property_id WHERE sshis.measurement_time &gt;= ? AND sshis.measurement_time &lt; ?&#93;; SQL state &#91;XJ001&#93;; error code &#91;0&#93;; Java exception:': java.lang.NullPointerException'.; nested exception isorg.apache.derby.impl.jdbc.EmbedSQLException: Java exception: ': java.lang.NullPointerException'.java.lang.NullPointerException at java.util.Hashtable.put(Unknown Source) at org.apache.derby.impl.store.access.RAMAccessManager.registerAccessMethod(Unknown Source) at org.apache.derby.impl.store.access.RAMAccessManager.findMethodFactoryByImpl(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.createSort(UnknownSource) at org.apache.derby.impl.sql.execute.DistinctScalarAggregateResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.DistinctScalarAggregateResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(Unknown Source) at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:535) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:476) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:528) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:561) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:579) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:589) at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:619) at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:629) at org.springframework.jdbc.core.JdbcTemplate.queryForInt(JdbcTemplate.java:656) at com.meshnetics.wsn.ctrl.dispatcher.services.history.helpers.MeasurementsSaveGetHelper.getMeasurements(MeasurementsSaveGetHelper.java:81) at com.meshnetics.wsn.ctrl.dispatcher.services.history.helpers.HistoryDataAccessHelper$7.doInTransaction(HistoryDataAccessHelper.java:315) at com.meshnetics.wsn.ctrl.dispatcher.services.history.helpers.HistoryDataAccessHelper$7.doInTransaction(HistoryDataAccessHelper.java:314) at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:117) at com.meshnetics.wsn.ctrl.dispatcher.services.history.helpers.HistoryDataAccessHelper.getMeasurements(HistoryDataAccessHelper.java:313) at com.meshnetics.wsn.ctrl.dispatcher.services.history.asyncread.MeasurementsReadTask.executeTask(MeasurementsReadTask.java:127) at com.meshnetics.wsn.ctrl.dispatcher.services.history.asyncread.MeasurementsReadTask.run(MeasurementsReadTask.java:97) at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source) at java.util.concurrent.FutureTask.run(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source)", "id": "2074"}, "2079": {"ground_truth": "0", "bug_report": "store/BootAllTest.junit fails on wctme5.7 foundation  on 10.2\nFails on 10.2. wctme5.7 foundation                 Diff file derbyall/storeall/storemore/BootAllTest.diff             Start: BootAllTest jdkJ2ME Foundation Specification v1.0 storeall:storemore 2006-11-04 03:55:56 ***0 add&gt; .E&gt; There was 1 error:&gt; 1) testSettingBootAllPropertyWithHomePropertySet(org.apache.derbyTesting.functionTests.tests.store.BootAllTest)java.lang.NoClassDefFoundError: java.sql.DriverManager&gt; FAILURES!!!&gt; Tests run: 1  Failures: 0  Errors: 1Test Failed. End: BootAllTest jdkJ2ME Foundation Specification v1.0 storeall:storemore 2006-11-04 03:56:14 ***", "id": "2079"}, "2103": {"ground_truth": "0", "bug_report": "After a Lexical Error due to syntax error      even a simple create table does not work  on the same connection.\nconnect 'jdbc:derby:wombat;create=true';create table t1(a int ) ;create table 't2'(a int ) ;&#8211; this should fail. create table foo (a int   /'YEAR/' int ) ;&#8211; but this should not fail. But failingcreate table t4 ( b int ) ;FYI:$ java org.apache.derby.tools.ijij version 10.3ij&gt; run 'weird1.sql';ij&gt; connect 'jdbc:derby:wombat;create=true';ij&gt; create table t1(a int ) ;0 rows inserted/updated/deletedij&gt; create table 't2'(a int ) ;0 rows inserted/updated/deletedij&gt; &#8211; this should fail.create table foo (a int   /'YEAR/' int ) ;ERROR 42X02: Lexical error at line 2  column 28. Encountered: '' (92)  after: ''.ij&gt; &#8211; but this should not fail. But failingcreate table t4 ( b int ) ;ERROR 42X01: Syntax error: Encountered '' at line 2  column 21.ij&gt;", "id": "2103"}, "2108": {"ground_truth": "1", "bug_report": "Implement SSL/TLS communication between client and server\nImplement SSL/TLS communication between client and server", "id": "2108"}, "2114": {"ground_truth": "0", "bug_report": "Let Clock embed a HashMap rather than inherit from Hashtable\nClock currently inherits from Hashtable  but the use of Hashtable is really an implementation detail that would benefit from being hidden as private member. All access to the hashtable happens inside sychronized blocks so it is safe to substitute a HashMap. This change appears to trigger a small increase in throughput  as measured by the average TPS number obtained by running the select client from DERBY-1961 repeatedly.", "id": "2114"}, "2116": {"ground_truth": "0", "bug_report": "Test files missing svn:eol-style\nThe following files don't have the svn:eol-style property:functionTests/harness/ibm15.javafunctionTests/tests/i18n/MessageBundleTest.javafunctionTests/tests/store/LogDeviceTest.javafunctionTests/tests/storetests/st_derby1189.sqlfunctionTests/tests/tools/IJRunScriptTest.javajunit/SystemPropertyTestSetup.java", "id": "2116"}, "2117": {"ground_truth": "0", "bug_report": "Intermittent failure in lang/compressTable.sql\nlang/compressTable.sql has failed a number of times in the nightly regression tests. The diffs vary slightly:http://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/testlog/Linux-2.6.9-34.ELsmp_x86_64-x86_64/476241-derbylang_diff.txthttp://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/testlog/CYGWIN_NT-5.1_i686-unknown/476241-derbyall_diff.txt                 Diff file derbylang/derbylang/compressTable.diff             Start: compressTable jdk1.5.0_07 derbylang:derbylang 2006-11-17 20:10:12 ***1318 del&lt; T1 |1 |2 1318a1318&gt; T1 |3 |0 Test Failed. End: compressTable jdk1.5.0_07 derbylang:derbylang 2006-11-17 20:10:39 ***    http://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/testlog/CYGWIN_NT-5.1_i686-unknown/476584-derbyall_diff.txt                 Diff file derbyall/derbylang/compressTable.diff             Start: compressTable jdk1.5.0_05 derbyall:derbylang 2006-11-18 23:07:44 ***1318 del&lt; T1 |1 |2 1318a1318&gt; T1 |2 |1 Test Failed. End: compressTable jdk1.5.0_05 derbyall:derbylang 2006-11-18 23:08:11 ***", "id": "2117"}, "2118": {"ground_truth": "0", "bug_report": "Change some boundary checks in ArrayInputStream to ASSERTs to improve performance\nProfiling shows that a significant amount of CPU is spent doing boundary checking in ArrayInputStream.setPosition() and ArrayInputStream.setLimit(). These checks appear to be there to detect error conditions  so it seems more appropriate to make them ASSERTs. Especially since they are so expensive.DTrace analysis seems to confirm that these methods get called very frequently:Knut Anders Hatlen wrote the following in a message on derby-dev:FYI  I just ran the DERBY-1961 test clients and traced them with aDTrace script that printed how often each method was called. For thejoin client  ArrayInputStream.setPosition() was the most frequentlycalled method (43837.7 calls/tx). For the single-record select client it was third (58.4 calls/tx)  only beaten by Object.&lt;init&gt;() andDDMWriter.ensureLength(). I think this means that setPosition() is theengine method that is most frequently called  at least in read-mostlytransactions. ArrayInputStream.setLimit() also appeared near the topof the list. See http://wiki.apache.org/db-derby/Derby1961MethodCallsfor the details.", "id": "2118"}, "2134": {"ground_truth": "0", "bug_report": "Add long running System test for Derby\nI will use this place to add 2 long running system tests for Derby.", "id": "2134"}, "2149": {"ground_truth": "0", "bug_report": "Replace Vectors and Hashtables with ArrayLists and HashMaps in RAMTransaction\nIn org.apache.derby.impl.store.access.RAMTransaction  synchronized collection objects could be replaced with unsynchronized ones. See discussion here: http://www.nabble.com/Use-of-synchronized-containers-in-engine-code-tf2754469.html", "id": "2149"}, "2150": {"ground_truth": "0", "bug_report": "Reduce use of synchronized collections in GenericLanguageConnectionContext\nIn org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext  it is probably safe to replace some of the synchronized collections with unsynchronized ones. This should be investigated  and the unnecessary synchronization should be removed. See discussion here: http://www.nabble.com/Use-of-synchronized-containers-in-engine-code-tf2754469.html", "id": "2150"}, "2153": {"ground_truth": "0", "bug_report": "suites.All falls over with foundation after revision 482433; java.lang.NoClassFoundError: javax.xml.parsers.DocumentBuilderFactory\nWhen attempting to run:&lt;j9binpath&gt;/j9 -jcl:foun10 -Dderby.system.home=&lt;testhome&gt; -DderbyTesting.serverhost=localhost -DderbyTesting.clienthost=localhost -DderbyTesting.codeclasses=file:/&lt;classesdir&gt;/ -DderbyTesting.junit=file://unused -DderbyTesting.antjunit=file://unused -Djava.security.policy=file:/&lt;classesdir&gt;/org/apache/derbyTesting/functionTests/util/derby_tests.policy -Xbootclasspath/a:&lt;j9libpath&gt;/jdbc.jar -cp &lt;classesdir&gt;;junit.jar junit.textui.TestRunner org.apache.derbyTesting.functionTests.suites.All The textui.TestRunner keels over with the following error:Failed to invoke suite():java.lang.NoClassDefFoundError: javax.xml.parsers.DocumentBuilderFactoryThis happens after  but not before revision 482433.", "id": "2153"}, "2156": {"ground_truth": "0", "bug_report": "message XSDB8 and 42Y32 have references to db2j\ntrunk/messages.xml shows two messages that incorrectly refer to db2j:42Y32=Aggregator class ''{0}'' for aggregate ''{1}'' on type {2} does not implement com.ibm.db2j.aggregates.Aggregator. There is now no class Aggregator in Derby. This message is generated from the class: org.apache.derby.impl.sql.compile.AggregateNode.java. private void checkAggregatorClassName(String className) throws StandardException { className = verifyClassExist(className  false); if (!classInspector.assignableTo(className  'org.apache.derby.iapi.sql.execute.ExecAggregator')) { throw StandardException.newException (SQLState.LANG_BAD_AGGREGATOR_CLASS2  className  aggregateName  operand.getTypeId().getSQLTypeName()); } }The original in Cloudscape had a reference to an Aggregator class  the if looked like this: if (!classInspector.assignableTo(className  'com.ibm.db2j.aggregates.Aggregator') &amp;&amp; !classInspector.assignableTo  (className  'com.ibm.db2j.protocol.Database.Language.Execution.ExecAggregator')) { throw StandardException.newException(SQLState.LANG_BAD_AGGREGATOR_CLASS2   ....Maybe the message now needs to mention org.apache.derby.iapi.sql.execute.ExecAggregator?But  I think maybe this message cannot be obtained unless someone introduces a bug within the Derby code. I think the reference to another internal class should be removed. Or maybe the text of Cloudscape message 42Y31 can be used: 42Y31=LANG_BAD_AGGREGATOR_CLASS='Aggregator class ''{0}'' for aggregate ''{1}'' on type {2} is inaccessable or does not exist.'XSDB8.D=DATA_MULTIPLE_JBMS_FORCE_LOCK ='WARNING: Derby (instance {0}) is attempting to boot the database {1} even though Derby (instance {2}) may still be active. Only one instance of Derby should boot a database at a time. Severe and non-recoverable corruption can result if 2 instances of Derby boot on the same database at the same time. The db2j.database.forceDatabaseLock=true property has been set  so the database will not boot until the db.lck is no longer present. Normally this file is removed when the first instance of Derby to boot on the database exits  but it may be left behind in some shutdowns. It will be necessary to remove the file by hand in that case. It is important to verify that no other VM is accessing the database before deleting the db.lck file by hand.'John Embretsen commented on this in DERBY-1838:https://issues.apache.org/jira/browse/DERBY-1838#action_12434090Indicating that not only should the message refer to derby.database.forceDatabaseLock  but the replacement of parameters is not happening either. But I can not find a place where this message is generated  so maybe it can just be removed.", "id": "2156"}, "2183": {"ground_truth": "0", "bug_report": "Trigger recompilation problem when trigger action has its table not qualified with a schema\nTrigger recompilation problem when trigger action has its table not qualified with a schema.SPSs in SYS.SYSSTATEMENTS get invalidated for recompilation when sqlj.install_jar  sqlj.remove_jar  sqlj.replace_jar are called  or when a database upgrade is performed. The problem arises when the trigger action statement does not qualify the table with an explicit schema name. During recompilation it uses the default schema instead of using the original schema that was persisted in SYS.SYSSTATEMENTS causing an exception to occur. e.g.:C:/derby/trunk&gt;java -classpath classes;. org.apache.derby.tools.ijij version 10.3ij&gt; connect 'jdbc:derby:wombat;create=true';ij&gt; create table app.t1 (i int  j int);0 rows inserted/updated/deletedij&gt; insert into app.t1 values (1 10);1 row inserted/updated/deleted&#8211; notice trigger action's update statement did not qualify table t1 with a schema nameij&gt; create trigger app.tr1 after update of i on app.t1 update t1 set j = 1;0 rows inserted/updated/deletedij&gt; update app.t1 set i=i+1;1 row inserted/updated/deletedij&gt; select * from app.t1;I |J-----------------------2 |11 row selected&#8211; this action invalidates the SPS and mark for recompilationij&gt; call sqlj.install_jar('c:/derby/procs/Procs.jar'  'APP.Procs'  0);0 rows inserted/updated/deletedij&gt; disconnect;ij&gt; connect 'jdbc:derby:wombat' user 'user1';&#8211; recompilation occurs but uses 'USER1' as the schema to compile instead of 'APP'  resulting in errorij&gt; update app.t1 set i=i+1;ERROR 42Y07: Schema 'USER1' does not existij&gt;", "id": "2183"}, "2195": {"ground_truth": "0", "bug_report": "Nested triggers not working properly after maximum trigger count exception is thrown\nAfter the maximum allowed nested trigger exception is thrown  subsequent statement that result in nested trigger execution may result in the same error again even though it does not exceed the limit of nested triggers(16).e.g.:C:/derby/trunk&gt;java -classpath classes;. org.apache.derby.tools.ijij version 10.3ij&gt; connect 'jdbc:derby:wombat;create=true';ij&gt; create table t1 (i int);0 rows inserted/updated/deletedij&gt; insert into t1 values 1 2 3;3 rows inserted/updated/deletedij&gt; create trigger tr1 after update on t1 for each row update t1 set i=i+1;0 rows inserted/updated/deleted&#8211; force the 'maximum depth of nested triggers' error to occurij&gt; update t1 set i=i+1;ERROR 54038: Maximum depth of nested triggers was exceeded.ij&gt; drop trigger tr1;0 rows inserted/updated/deletedij&gt; create trigger tr1 after update on t1 referencing old as oldt for each row update t1 set i=i+1 where oldt.i=2;0 rows inserted/updated/deleted&#8211; this should have executed successfully instead of throwing the same error again!ij&gt; update t1 set i=i+1;ERROR 54038: Maximum depth of nested triggers was exceeded.ij&gt; disconnect;ij&gt; connect 'jdbc:derby:wombat';ij&gt; select * from t1;I-----------1233 rows selected&#8211; ok after reconnection  it looks like the trigger execution context(TEC) may not have been cleanup properly in the previous connectionij&gt; update t1 set i=i+1;3 rows inserted/updated/deletedij&gt; select * from t1;I-----------4563 rows selectedij&gt;", "id": "2195"}, "2200": {"ground_truth": "0", "bug_report": "Add performance tests to Derby using the junit perf framework\nThere is a simple performance junit framework that has been added as part of derby-1970. There are a number of improvements suggested for derby-1970  please see DERBY-1970.This jira is to add new performance tests to derby so that these tests are easily available for anyone to run   report issues  fix issues etc..", "id": "2200"}, "2202": {"ground_truth": "0", "bug_report": "DROP PROCEDURE depends on SET SCHEMA\nThis is possibly related to Bug https://issues.apache.org/jira/browse/DERBY-1304.Use ij to execute the following statements:CREATE SCHEMA datamgmt;CREATE PROCEDURE datamgmt.exit ( IN value INTEGER ) MODIFIES SQL DATA PARAMETER STYLE JAVA LANGUAGE JAVA EXTERNAL NAME 'java.lang.System.exit';DROP PROCEDURE datamgmt.exit;DROP SCHEMA datamgmt RESTRICT;Then execute exactly the same lines once again. Then statement 'DROP PROCEDURE datamgmt.exit' yields:ERROR 42X94: PROCEDURE 'EXIT' does not exist.However  if the DROP works if a default schema (SET SCHEMA) is used instead of the prefixed schemaName. That is  the following lines can be executed more than once in a row:CREATE SCHEMA datamgmt;CREATE PROCEDURE datamgmt.exit ( IN value INTEGER ) MODIFIES SQL DATA PARAMETER STYLE JAVA LANGUAGE JAVA EXTERNAL NAME 'java.lang.System.exit';SET SCHEMA datamgmt;DROP PROCEDURE exit;DROP SCHEMA datamgmt RESTRICT;Therefore  SET SCHEMA can be used as a workaround  hence minor importance.", "id": "2202"}, "2211": {"ground_truth": "0", "bug_report": "java/testing/README.htm needs to be updated with information on JUnit tests\nCurrently  the testing readme at java/testing/README.htm does not contain any information on running or developing Derby junit tests. This document should at least be updated with information on how to run Derby's junit tests. A description of the top-level suites and running the Ant junitreport target would be a good start.", "id": "2211"}, "2220": {"ground_truth": "0", "bug_report": "Uncommitted transactions executed throught XAResource will held locks after the application terminates (or crashes during the transaction).\nUsing this piece of code derby will not release a table lock of 'dummy' table. String query = 'insert into dummy (field1) values ('' + Integer.toString(value) + '')'; XAConnection xaConnection = createXAConnection('jdbc:derby://localhost:1527/TestDB'  ''  ''); XAResource xaResource = xaConnection.getXAResource(); conn = xaConnection.getConnection(); Xid xid = createXid(value);  xaResource.setTransactionTimeout(10); xaResource.start(xid  XAResource.TMNOFLAGS); Statement statement = conn.createStatement(); statement.execute(query);  // terminate the client application // this will not release any locks System.exit(0);", "id": "2220"}, "2222": {"ground_truth": "0", "bug_report": "'show indexes in SCHEMANAME' does not work with the client driver\nThe ij command 'show indexes in SCHEMANAME' does not work at all with the client driver.It does work with the embedded driver.Sample output from ij:ij&gt; connect 'jdbc:derby://localhost/myDB;create=true';ij&gt; create table test (id int primary key);0 rows inserted/updated/deletedij&gt; show indexes in app;ERROR XJ103: Table name can not be nullij&gt; show indexes from test;TABLE_NAME |COLUMN_NAME |NON_U&amp;|TYPE|ASC&amp;|CARDINA&amp;|PAGES----------------------------------------------------------------------------TEST |ID |0 |3 |A |NULL |NULL1 row selectedij&gt; show indexes from app.test;TABLE_NAME |COLUMN_NAME |NON_U&amp;|TYPE|ASC&amp;|CARDINA&amp;|PAGES----------------------------------------------------------------------------TEST |ID |0 |3 |A |NULL |NULL1 row selectedij&gt;Using delimited table and/or schema names does not work  but I think this is according to documentation.I.e.:ij&gt; show indexes from 'TEST';ERROR 42X01: Syntax error: Encountered 'show' at line 1  column 1.ij&gt; show indexes from 'APP'.test;ERROR 42X01: Syntax error: Encountered 'show' at line 1  column 1.ij&gt; show indexes from 'APP'.'TEST';ERROR 42X01: Syntax error: Encountered 'show' at line 1  column 1.ij&gt;", "id": "2222"}, "2223": {"ground_truth": "0", "bug_report": "Let BasePage.fetchFieldFromSlot use the special single-col FetchDescriptor ctor\nBasePage.fetchFieldFromSlot needs to construct a FetchDescriptor with single column. To do this it creates a FormatableBitSet that identifies the correct column and then passes this bitset to the FetchDescriptor constructor. But FetchDescriptor has a special constructor for the single column case  that doesn't need a bitset. Using this constructor instead makes the code simpler  and presumably more efficient as well.", "id": "2223"}, "2224": {"ground_truth": "0", "bug_report": "Test harness should support J2ME 1.1\nI would like to enable the 'old' test harness to support the new version of IBM's j2ME implementation  which is based on j2ME jdk spec version 1.1. This is available with a product named Websphere Everyplace Micro Edition 6.1. from IBM.We already support j9_foundation  which matches to j2ME jdk spec 1.0. I'd like to add j9_foundation11  which then matches to j2ME jdk spec 1.1.I'm proposing to switch my automated tests over to the newer version going forward  and to minimize complexity of the change  I'd like to make the canons reflect behavior of the new version. The differences are minimal. However  I want to be able to still run with the old (except where the results differ  failures would occur with the old version).One of the reasons for moving to the new version is that there is a bug with the older version in regards to security manager  preventing a smooth run of the junit tests  and I'd like to run all short-running tests (suites.All and derbyall) with at least one of the versions. Another reason is that the j2ME spec 1.0 is really old.", "id": "2224"}, "2241": {"ground_truth": "0", "bug_report": "compatibilitytest fails after DERBY-2121 change.\nClient-server compatibility testing with JVM 1.3 is not relevant on trunk/10.3 following DERBY-2121See e.g. http://dbtg.thresher.com/derby/test/tinderbox_trunk15/jvm1.5/testing/Limited/testSummary-495558.htmlhttp://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/Limited/testSummary-495683.html", "id": "2241"}, "2254": {"ground_truth": "1", "bug_report": "Assert during log file switch: log file position exceeded max log file size\nWhen running simple tpc-b like transactions against a embedded Derby based on a SANE build of trunk the following assertion occurs for the background thread and all user threads: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED log file position exceeded max log file sizeThis seems to occur during a switch to a new log file.derby.log contains the following call stack for the background thread:Exception trace: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED log file position exceeded max log file size at org.apache.derby.shared.common.sanity.SanityManager.ASSERT(SanityManager.java:120) at org.apache.derby.impl.store.raw.log.LogCounter.makeLogInstantAsLong(LogCounter.java:120) at org.apache.derby.impl.store.raw.log.LogToFile.switchLogFile(LogToFile.java:1900) at org.apache.derby.impl.store.raw.log.LogToFile.appendLogRecord(LogToFile.java:3530) at org.apache.derby.impl.store.raw.log.FileLogger.logAndDo(FileLogger.java:345) at org.apache.derby.impl.store.raw.xact.Xact.logAndDo(Xact.java:1185) at org.apache.derby.impl.store.raw.log.LogToFile.checkpointWithTran(LogToFile.java:1540) at org.apache.derby.impl.store.raw.log.LogToFile.checkpoint(LogToFile.java:1357) at org.apache.derby.impl.store.raw.RawStore.checkpoint(RawStore.java:439) at org.apache.derby.impl.store.raw.log.LogToFile.performWork(LogToFile.java:3416) at org.apache.derby.impl.services.daemon.BasicDaemon.serviceClient(BasicDaemon.java:331) at org.apache.derby.impl.services.daemon.BasicDaemon.work(BasicDaemon.java:668) at org.apache.derby.impl.services.daemon.BasicDaemon.run(BasicDaemon.java:394) at java.lang.Thread.run(Thread.java:619)2007-01-17 23:09:48.638 GMT Thread&#91;derby.rawStoreDaemon 5 derby.daemons&#93; Cleanup action startingorg.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED log file position exceeded max log file size at org.apache.derby.shared.common.sanity.SanityManager.ASSERT(SanityManager.java:120) at org.apache.derby.impl.store.raw.log.LogCounter.makeLogInstantAsLong(LogCounter.java:120) at org.apache.derby.impl.store.raw.log.LogToFile.switchLogFile(LogToFile.java:1900) at org.apache.derby.impl.store.raw.log.LogToFile.appendLogRecord(LogToFile.java:3530) at org.apache.derby.impl.store.raw.log.FileLogger.logAndDo(FileLogger.java:345) at org.apache.derby.impl.store.raw.xact.Xact.logAndDo(Xact.java:1185) at org.apache.derby.impl.store.raw.log.LogToFile.checkpointWithTran(LogToFile.java:1540) at org.apache.derby.impl.store.raw.log.LogToFile.checkpoint(LogToFile.java:1357) at org.apache.derby.impl.store.raw.RawStore.checkpoint(RawStore.java:439) at org.apache.derby.impl.store.raw.log.LogToFile.performWork(LogToFile.java:3416) at org.apache.derby.impl.services.daemon.BasicDaemon.serviceClient(BasicDaemon.java:331) at org.apache.derby.impl.services.daemon.BasicDaemon.work(BasicDaemon.java:668) at org.apache.derby.impl.services.daemon.BasicDaemon.run(BasicDaemon.java:394) at java.lang.Thread.run(Thread.java:619)Cleanup action completedFor my user threads the call stack is similar:Database Class Loader started - derby.database.classpath=''2007-01-17 23:09:36.401 GMT Thread&#91;Thread-51 5 main&#93; (XID = 12632406)  (SESSIONID = 51)  (DATABASE = /export/home/tmp/derby-db)  (DRDAID = null)  Cleanup action starting2007-01-17 23:09:36.401 GMT Thread&#91;Thread-51 5 main&#93; (XID = 12632406)  (SESSIONID = 51)  (DATABASE = /export/home/tmp/derby-db)  (DRDAID = null)  Failed Statement is: UPDATE accounts SET abal = abal + ? WHERE aid = ? AND bid = ?org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED log file position exceeded max log file size at org.apache.derby.shared.common.sanity.SanityManager.ASSERT(SanityManager.java:120) at org.apache.derby.impl.store.raw.log.LogCounter.makeLogInstantAsLong(LogCounter.java:120) at org.apache.derby.impl.store.raw.log.LogToFile.switchLogFile(LogToFile.java:1900) at org.apache.derby.impl.store.raw.log.LogToFile.appendLogRecord(LogToFile.java:3530) at org.apache.derby.impl.store.raw.log.FileLogger.logAndDo(FileLogger.java:345) at org.apache.derby.impl.store.raw.xact.Xact.logAndDo(Xact.java:1185) at org.apache.derby.impl.store.raw.data.LoggableActions.doAction(LoggableActions.java:221) at org.apache.derby.impl.store.raw.data.LoggableActions.actionUpdate(LoggableActions.java:85) at org.apache.derby.impl.store.raw.data.StoredPage.doUpdateAtSlot(StoredPage.java:8521) at org.apache.derby.impl.store.raw.data.BasePage.updateAtSlot(BasePage.java:1108) at org.apache.derby.impl.store.access.conglomerate.GenericConglomerateController.replace(GenericConglomerateController.java:479) at org.apache.derby.impl.sql.execute.RowChangerImpl.updateRow(RowChangerImpl.java:523) at org.apache.derby.impl.sql.execute.UpdateResultSet.collectAffectedRows(UpdateResultSet.java:566) at org.apache.derby.impl.sql.execute.UpdateResultSet.open(UpdateResultSet.java:260) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:358) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1182) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at com.sun.derby.perf.clients.tpcb.DBConnection.performTransaction(DBConnection.java:595) at com.sun.derby.perf.clients.tpcb.Client.run(Client.java:218)After this it seems like no user threads are able to connect to the database (not surpricing).This happend using a SANE build and I am unsure by just looking at the assertion in the code whether this situation would have been fatal also if I had been using an INSANE build.", "id": "2254"}, "2258": {"ground_truth": "0", "bug_report": "DatabaseMetaData.getTypeInfo() does not list supported Derby SQL types correctly.\nThese types are returned but not supported by Derby.LONG NVARCHARNATIONAL CHARNATIONAL CHAR VARYINGThe XML type is supported by Derby but not returned.", "id": "2258"}, "2262": {"ground_truth": "0", "bug_report": "DatabaseMetaData.getTypeInfo returns incorrect MAXIMUM_SCALE value for DECIMAL and NUMERIC types\nMaximum scale is returned as 32767 but maximum scale for numerics is 31.", "id": "2262"}, "2265": {"ground_truth": "1", "bug_report": "bad logic in jvm:guessWSHome() in old test harness affects j9 runs\nRunning derbyall using either wcmte5.7_foundation or weme6.1 results in the following stack trace.Exception in thread 'main' java.lang.StringIndexOutOfBoundsException at java.lang.String.substring(String.java:1043) at org.apache.derbyTesting.functionTests.harness.jvm.guessWSHome(jvm.java:301) at org.apache.derbyTesting.functionTests.harness.jvm.getSecurityProps(jvm.java:356) at org.apache.derbyTesting.functionTests.harness.jvm.setSecurityProps(jvm.java:336) at org.apache.derbyTesting.functionTests.harness.RunTest.buildTestCommand(RunTest.java:2350) at org.apache.derbyTesting.functionTests.harness.RunTest.testRun(RunTest.java:498) at org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:368)I think this code was not reached until various security related changes recently  but the code is just bad.I think this code was used at one point to attempt to kick off another jvm to run a server with  but that is now defunct.Rather than try to make the code work  or try to clean it up  I'd rather spend time converting tests to the junit framework  so I will just fix this up so we don't hit the error.The bad code is:  wshome = jhome.substring(0 jhome.indexOf(sep + 'jre')); wshome = wshome.substring(0 wshome.lastIndexOf(sep));If the jhome ( System.getProperty('java.home')) does not contain 'jre'  we will get -1 as the 2nd parameter in jhome.substring  and thus cause the ArrayIndexOutOfBounds.I propose to fix this piece of code as follows: int havejre=jhome.indexOf(sep + 'jre'); if (havejre &gt; 0) { wshome = jhome.substring(0 jhome.indexOf(sep + 'jre')); wshome = wshome.substring(0 wshome.lastIndexOf(sep)); } else wshome = jhome.substring(0 jhome.lastIndexOf(sep));", "id": "2265"}, "2268": {"ground_truth": "1", "bug_report": "AccessControlException when exiting junit.swingui.TestRunner\nWhen the JUnit tests are run with junit.swingui.TestRunner  one gets the following exception when the test runner window is closed:Exception in thread 'AWT-EventQueue-0' java.security.AccessControlException: access denied (java.io.FilePermission /home/kh160127/.junitsession write)", "id": "2268"}, "2278": {"ground_truth": "0", "bug_report": "Add a generic utility tool to drive the Order Entry load phase.\nAdd a generic utility program that can take in the driver name and the database connection url to populate the order entry database. Currently the load phase for OE is completed and hence this driver program should allow one to be able to populate the database.Maybe once OE run is completed  we can add the driving of the transactions also. This driver can be in org.apache.derbyTesting.system.oe.runsee DERBY-1987 and sub-tasks for details.", "id": "2278"}, "2294": {"ground_truth": "0", "bug_report": "Missing sql script: '/org/apache/derbyTesting/functionTests/tests/lang/altertableDropColumn.sql'\nSeen since svn r503550 2007-02-05 06:02:19 CET.First occurence in http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/Limited/testSummary-503550.html .Also in http://dbtg.thresher.com/derby/test/Daily/jvm1.5/testing/Limited/testSummary-503767.html (all platforms except windows!?).derbyall/derbyall_fail.txt shows:------------------------------------------derbyall/derbyall:derbylang.fail:lang/altertableDropColumn.sql derbyall/derbyall_diff.txt does not show a diff.butderbyall.sum shows:---------------------------     Start: altertable jdk1.6.0 derbyall:derbylang 2007-02-05 06:38:55 *** End: altertable jdk1.6.0 derbyall:derbylang 2007-02-05 06:39:08 ***Could not locate lang/altertableDropColumn.sqlException in thread 'main' java.io.FileNotFoundException: /org/apache/derbyTesting/functionTests/tests/lang/altertableDropColumn.sql at org.apache.derbyTesting.functionTests.harness.RunTest.setDirectories(RunTest.java:701) at org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:266)    On windows I found that derbyall.sum contained:-----------------------------------------------------------------     Start: altertable jdk1.5.0_07 derbyall:derbylang 2007-02-05 19:21:24 *** End: altertable jdk1.5.0_07 derbyall:derbylang 2007-02-05 19:21:55 ***Could not locate lang/altertableDropColumn.sqlException in thread 'main' java.io.IOException: The filename  directory name  or volume label syntax is incorrect at java.io.WinNTFileSystem.canonicalize0(Native Method) at java.io.Win32FileSystem.canonicalize(Win32FileSystem.java:395) at java.io.File.getCanonicalPath(File.java:531) at org.apache.derbyTesting.functionTests.harness.RunTest.addToListFile(RunTest.java:2187) at org.apache.derbyTesting.functionTests.harness.RunTest.addToFailures(RunTest.java:2159) at org.apache.derbyTesting.functionTests.harness.RunTest.setDirectories(RunTest.java:700) at org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:266)", "id": "2294"}, "2315": {"ground_truth": "0", "bug_report": "compatibility/testScript.xml should include 10.2.2 in the server/client combinations\nAdd SERVER_10.2.2.0 and CLIENT_10.2.2.0 in the combinations to be tested.", "id": "2315"}, "2316": {"ground_truth": "0", "bug_report": "Convert compatibility/testScript.xml to JUnit\nI have started converting compatibility/testScript.xml to JUnit to1) be able to more dynamically specify which combinations to test  2) get standard JUnit reports from the test  and3) more easily include the compatibility test in the regression test runs.I plan to use a property file (patterened after the current ant.property file for the compatibility test)  to specify jvm and derby library locations.With the growing number of jvm and derby versions I also think that it should be possible to specify a number of different kinds of compatibility test combinations for example:a) the current way  which is all combinations of derby and jvm on both  server and client. &#91;(derbys*jvms)*(derbys*jvms)&#93;b) Current trunk client and jvms vs. all server derbys and jvms. &#91;(1*jvms)*(derbys*jvms)&#93;c) All clients and jvms vs. current trunk server and jvms. &#91;(derbys*jvms)*(1*jvms)&#93;d) Exact specification of the combinations to be tested. &#91;(N*M)*(X*Y)&#93;Which kind of test to run should be specified in the property file.", "id": "2316"}, "2339": {"ground_truth": "0", "bug_report": "org.apache.derbyTesting.functionTests.suites.All is extremely CPU intensive since ~svn 507489\nRun org.apache.derbyTesting.functionTests.suites.All.http://www.nabble.com/org.apache.derbyTesting.functionTests.suites.All-is-extremely-CPU-intensive%21-tf3230539.htmlSee e.g. http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/Limited/testSummary-507489.htmlhttp://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/Limited/testSummary-507650.htmlThese logs also include thread dumps.", "id": "2339"}, "2349": {"ground_truth": "0", "bug_report": "Accessing a BLOB column twice in an INSERT trigger leads to errors in the value on-disk\nEither the BLOB is stored with the incorrect value or the value on disk does not match the stored length on disk and an exception is raised. The BLOB was supplied as a stream value.See this with the new TriggersTest. The text fixture will have a comment with this bug number showing how to reproduce the problem.", "id": "2349"}, "2350": {"ground_truth": "0", "bug_report": "Use of XML values in the action statement of a trigger throw exceptions.\nA trigger like  where V  V1 and V2 are columns of type XML will thrown an exception when fired.CREATE TRIGGER AIS AFTER INSERT ON T_MAIN  REFERENCING NEW_TABLE AS N FOR EACH STATEMENT  INSERT INTO T_ACTION_STATEMENT(A  V1  ID  V2)  SELECT 'I'  V  ID  V FROM NERROR 38000: The exception 'java.sql.SQLException: An attempt was made to get a data value of type 'java.lang.Object' from a data value of type 'XML'.' was thrown while evaluating an expression.Most likely because triggers are implementing using VTIs and hence JDBC ResultSets and XML is not supported through JDBC yet.TriggerTest shows this issue  see the comment with the bug number to reproduce.", "id": "2350"}, "2351": {"ground_truth": "0", "bug_report": "ORDER BY with expression with distinct in the select list returns incorrect result\nWhen distinct is in the select list and the query has order by with expression  the resultset produced contains an additional column. ij&gt; create table t1 (c1 int  c2 varchar(10))0 rows inserted/updated/deletedij&gt; insert into t1 values (1 'a') (2 'b') (3 'c');3 rows inserted/updated/deletedselect distinct c1  c2 from t1 order by c1;C1 |C2----------------------1 |a2 |b3 |c3 rows selectedij&gt; select distinct c1  c2 from t1 order by c1+1;C1 |C2 |3 &lt;=====returns 3 columns  incorrect result returned----------------------------------1 |a |22 |b |33 |c |43 rows selected", "id": "2351"}, "2354": {"ground_truth": "0", "bug_report": "Unable to perform select query using DISTINCT on a read-only database\nIt is not possible to perform queries using DISTINCT on a read-only database packaged in a zip file. This generates the following error:ERROR 40XD1: Container was opened in read-only mode.  at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.store.raw.data.BaseContainer.use(Unknown Source) at org.apache.derby.impl.store.raw.data.BaseContainerHandle.useContainer(Unknown Source) at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(Unknown Source) at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(Unknown Source) at org.apache.derby.impl.store.raw.xact.Xact.openContainer(Unknown Source) at org.apache.derby.impl.store.raw.data.BaseDataFileFactory.addContainer(Unknown Source) at org.apache.derby.impl.store.raw.xact.Xact.addContainer(Unknown Source) at org.apache.derby.impl.store.access.heap.Heap.create(Unknown Source) at org.apache.derby.impl.store.access.heap.HeapConglomerateFactory.createConglomerate(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.createConglomerate(Unknown Source) at org.apache.derby.iapi.store.access.DiskHashtable.&lt;init&gt;(Unknown Source) at org.apache.derby.iapi.store.access.BackingStoreHashtable.spillToDisk(Unknown Source) at org.apache.derby.iapi.store.access.BackingStoreHashtable.add_row_to_hash_table(Unknown Source) at org.apache.derby.iapi.store.access.BackingStoreHashtable.put(Unknown Source) at org.apache.derby.impl.store.access.btree.BTreeForwardScan.fetchRows(Unknown Source) at org.apache.derby.impl.store.access.btree.BTreeScan.fetchSet(Unknown Source) at org.apache.derby.impl.store.access.BackingStoreHashTableFromScan.&lt;init&gt;(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.createBackingStoreHashtableFromScan(Unknown Source) at org.apache.derby.impl.sql.execute.HashScanResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) at DerbyTest.main(DerbyTest.java:29)The problem can be reproduced using the attached java program and the following database file:http://ftp2.bigcat.unimaas.nl/~thomas.kelder/derbytest/testdb.zip.Both the 'derby.storage.tempDirectory' and 'derby.stream.error.file' properties are set to writable locations  as advised in the help file.Also see derby-user mailing list thread: http://article.gmane.org/gmane.comp.apache.db.derby.user/6123'This appears to be a bug  possibly a regression. When I converted yourDB to10.0 everything worked fine even when I did NOT set the propertiesfor tempDirectory and error.file (hmmm..). When I switched to using the10.1 or 10.2 jars and accessed the very same database the 40XD1 ERRORhappened.' (Stanley Bradbury)", "id": "2354"}, "2359": {"ground_truth": "0", "bug_report": "Code cleanups for the org.apache.derby.impl.store.access.* packages\nWhen trying to learn more about the access layer  it was discovered that some code improvements could easily be made to increase the readability of the code.Patches attached to this issue will be cleanup patches only  and no functionality should be changed. Changes the will/may be made: remove unused imports remove unused methods fix JavaDoc errors tighter encapsulation and removal of unused variables where appropriate", "id": "2359"}, "2368": {"ground_truth": "0", "bug_report": "Modify compatibility/testScript.xml to not run embedded/jvm1.3 case any more - not valid after r509863\nAfter svn r509863(DERBY-1983 Remove some uses of java13compile.classpath that do not require code changes.) the 'compatibility test' for embedded/jvm1.3 should be removed.ERROR XBM02: Startup failed due to missing functionality for org.apache.derby.iapi.types.DataValueFactory. Please ensure your classpath includes the correct Derby software.compatibility diff -------------------------------------------------------------                 Start: embedded_VM-1.3java.sql.SQLException: Failed to start database 'compatDB'  see the next exception for details. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source) at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)Exception in thread 'main' java.lang.Exception: Error lookup up server info: Failed to start database 'compatDB'  see the next exception for details.             End: embedded_VM-1.3    compatibility/embedded_VM-1.3:---------------------------------------------VM Version = 1.3Driver org.apache.derby.jdbc.AutoloadedDriver Version = 10.3java.sql.SQLException: Failed to start database 'compatDB'  see the next exception for details. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(Unknown Source) at org.apache.derby.jdbc.Driver20.getNewEmbedConnection(Unknown Source) at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source) at org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:141) at org.apache.derbyTesting.functionTests.util.DerbyJUnitTest.getConnection(DerbyJUnitTest.java:378) at org.apache.derbyTesting.functionTests.util.DerbyJUnitTest.getConnection(DerbyJUnitTest.java:357) at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.findServer(CompatibilitySuite.java:283) at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.main(CompatibilitySuite.java:130)ERROR XBM02: Startup failed due to missing functionality for org.apache.derby.iapi.types.DataValueFactory. Please ensure your classpath includes the correct Derby software. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.iapi.services.monitor.Monitor.missingImplementation(Unknown Source) at org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(Unknown Source) at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Unknown Source) at org.apache.derby.impl.db.BasicDatabase.boot(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source) at org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(Unknown Source) at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(Unknown Source) at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(Unknown Source) at org.apache.derby.jdbc.Driver20.getNewEmbedConnection(Unknown Source) at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source) at org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source) at java.sql.DriverManager.getConnection(DriverManager.java:512) at java.sql.DriverManager.getConnection(DriverManager.java:141) at org.apache.derbyTesting.functionTests.util.DerbyJUnitTest.getConnection(DerbyJUnitTest.java:378) at org.apache.derbyTesting.functionTests.util.DerbyJUnitTest.getConnection(DerbyJUnitTest.java:357) at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.findServer(CompatibilitySuite.java:283) at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.main(CompatibilitySuite.java:130)Exception in thread 'main' java.lang.Exception: Error lookup up server info: Failed to start database 'compatDB'  see the next exception for details. at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.findServer(CompatibilitySuite.java:295) at org.apache.derbyTesting.functionTests.tests.junitTests.compatibility.CompatibilitySuite.main(CompatibilitySuite.java:130)", "id": "2368"}, "2370": {"ground_truth": "0", "bug_report": "EXISTS may return the wrong value for sub-queries involving set operations\nIt seems like EXISTS on a SELECT returning zero rows returns false (asexpected)  but EXISTS on INTERSECT of two disjunct sets returns true e.g EXISTS (values 1 intersect values 2).Yip Ng wrote on derby-dev:I believe its probably got to do with the EXISTS subquery transformingthe original RCL toa TRUE boolean value for the INTERSECT. So during row comparison atexecution timefor INTERSECT processing since true == true(thus intersects)  so itwill always return 'BAD'. Likewise select * from ( values 'OK' ) as T where exists (values 1 except values 2);This supposedly should return 'OK' but because of the booleantransformation mentionedabove for EXISTS subquery  it will return no rows for EXCEPTprocessing.", "id": "2370"}, "2371": {"ground_truth": "0", "bug_report": "Setting a default value for a VARCHAR column fails when column contains data\nI'm seeing a problem updating the default value for a VARCHAR column when the column already contains data. I'm  using:alter table TABLE_NAME alter column COL_NAME DEFAULT 'new value'and with some VARCHAR columns I get an error like this:Invalid character string format for type long.; nested exception is java.sql.SQLException: Invalid character string format for type long.Caused by: ERROR 22018: Invalid character string format for type long. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.iapi.types.SQLChar.getLong(Unknown Source) at org.apache.derby.impl.sql.execute.AlterTableConstantAction.getColumnMax(Unknown Source) at org.apache.derby.impl.sql.execute.AlterTableConstantAction.modifyColumnDefault(Unknown Source) at org.apache.derby.impl.sql.execute.AlterTableConstantAction.execGuts(Unknown Source) at org.apache.derby.impl.sql.execute.AlterTableConstantAction.executeConstantAction(Unknown Source) at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)This only happens on VARCHAR columns containing data. Columns that are entirely NULL update fine. This was discussed on users mailing list:http://www.nabble.com/problem-with-ALTER-COLUMN-DEFAULT-on-VARCHAR-column-tf3274046.htmland the conclusion was that it is related to this statement being run internally as part of the updata process:SELECT MAX(COL_NAME) FROM TABLE_NAME As reported in that discussion:-bash-2.05b$ java org.apache.derby.tools.ijij version 10.3ij&gt; connect 'jdbc:derby:brydb';ij&gt; create table t (a varchar(10));0 rows inserted/updated/deletedij&gt; alter table t alter column a default 'my val';0 rows inserted/updated/deletedij&gt; insert into t (a) values ('hi');1 row inserted/updated/deletedij&gt; alter table t alter column a default 'another val';ERROR 22018: Invalid character string format for type long.", "id": "2371"}, "2381": {"ground_truth": "1", "bug_report": "ParameterMappingTest fails due to ArrayIndexOutOfBoundsException  executing a procedure\nThe test ParameterMappingTest fails due to a connection reset error during tearDown. Commenting out the teardown actions I see that the real cause of the connection reset is an ArrayIndexOutOfBoundsException executing a callable statement. I have not narrowed it down more than this. Currently the test runs only for embedded. It should be reenabled for client once this bug is fixed. Below is the stack trace:java.lang.ArrayIndexOutOfBoundsException at java.lang.System.arraycopy(Native Method) at org.apache.derby.client.net.Reply.shiftBuffer(Reply.java:107) at org.apache.derby.client.net.Reply.ensureSpaceInBufferForFill(Reply.java:153) at org.apache.derby.client.net.Reply.fill(Reply.java:165) at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Reply.java(Compiled Code)) at org.apache.derby.client.net.Reply.readDssHeader(Reply.java:317) at org.apache.derby.client.net.Reply.peekCodePoint(Reply.java:1008) at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(NetStatementReply.java:324) at org.apache.derby.client.net.NetStatementReply.readExecuteCall(NetStatementReply.java:105) at org.apache.derby.client.net.StatementReply.readExecuteCall(StatementReply.java:75) at org.apache.derby.client.net.NetStatement.readExecuteCall_(NetStatement.java:176) at org.apache.derby.client.am.Statement.readExecuteCall(Statement.java:1464) at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2151) at org.apache.derby.client.am.PreparedStatement.executeX(PreparedStatement.java:1571) at org.apache.derby.client.am.PreparedStatement.execute(PreparedStatement.java:1556) at org.apache.derbyTesting.functionTests.tests.jdbcapi.ParameterMappingTest.testParameterMapping(ParameterMappingTest.java:487) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at java.lang.reflect.Method.invoke(Method.java:391) at junit.framework.TestCase.runTest(TestCase.java:154) at junit.framework.TestCase.runBare(TestCase.java:127) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76) at junit.framework.TestResult$1.protect(TestResult.java:106) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.framework.TestResult.run(TestResult.java:109) at junit.framework.TestCase.run(TestCase.java:118) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:128) at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)", "id": "2381"}, "2406": {"ground_truth": "0", "bug_report": "XAResource.end does not set the XA transaction state correctly when the XAException is thrown\nAs the comments in DERBY-2360 show when calling the XAResource.end the XAException may be thrown even when the transaction was successfully disassociated from the connection but the transaction was marked as rollback only. The code at the end of XAResource.end function does not handle this correctly. It either throws an XAException or sets the connection state to XA_T0_NOT_ASSOCIATED. The corresponding code from NetXAResource.end method is if (rc != XAResource.XA_OK) { throwXAException(rc  false); }else { conn_.setXAState(Connection.XA_T0_NOT_ASSOCIATED); }", "id": "2406"}, "2416": {"ground_truth": "0", "bug_report": "Provide collation sensitive subclasses for SQLChar  SQLVarchar  SQLLongvarchar and SQLClob which will use the passed Collator to do the collation rather than the default collation of UCS_BASIC\nThis jira entry is one of the tasks involved in implementing DERBY-2336.The existing SQLChar datatype has the Derby's default collation which is UCS_BASIC defined on them. With Derby 10.3  we want to support an additional collation for char datatypes which will be based on the territory. This jira issue is the placeholder for creating subclass of SQLChar which will use the passed Collator to do the collation. The current use of this class in Derby 10.3 will be for territory based collation but this class can be used in future for other kinds of collations like case-insensitive etc.", "id": "2416"}, "2447": {"ground_truth": "0", "bug_report": "ejbql and floattypes in org.apache.derbyTesting.functionTests.tests.lang.LangScripts intermittently fails with 'expected: but was:<[-0.0]  '\nSeen intermittently on Linux since 2007-02-27.Seen on Solaris 2007-03-12.&lt;signature&gt;ejbql(org.apache.derbyTesting.functionTests.tests.lang.LangScripts)junit.framework.ComparisonFailure: Output at line 454 expected:&lt;&#91;0.0 &#93; &gt; but was:&lt;&#91;-0.0&#93; &gt; at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:100) at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:124) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:80) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/signature&gt;&lt;signature&gt;floattypes(org.apache.derbyTesting.functionTests.tests.lang.LangScripts)junit.framework.ComparisonFailure: Output at line 1823 expected:&lt;&#91;0.0 &#93; &gt; but was:&lt;&#91;-0.0&#93; &gt; at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:100) at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:124) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:80) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/signature&gt;", "id": "2447"}, "2450": {"ground_truth": "0", "bug_report": "Clob.Position returning wrong value when operating on Reader\nClob.Position returning wrong value when operating on Reader", "id": "2450"}, "2456": {"ground_truth": "0", "bug_report": "File stream is left open when an exception occurs while setting up a character stream for data export.\nThe JUnit test tools/ImportExportTest.java has been failing since it was first contributed with the following error:ImportExportTest:embeddedjunit.framework.AssertionFailedError: extinout/T1.datat org.apache.derbyTesting.junit.DropDatabaseSetup.removeDir(DropDatabaseSetup.java:102)at org.apache.derbyTesting.junit.DropDatabaseSetup.access$000(DropDatabaseSetup.java:38)at org.apache.derbyTesting.junit.DropDatabaseSetup$1.run(DropDatabaseSetup.java:77)at java.security.AccessController.doPrivileged1(Native Method)at java.security.AccessController.doPrivileged(AccessController.java:287)at org.apache.derbyTesting.junit.DropDatabaseSetup.removeDirectory(DropDatabaseSetup.java:74)at org.apache.derbyTesting.junit.SupportFilesSetup.tearDown(SupportFilesSetup.java:107)at junit.extensions.TestSetup$1.protect(TestSetup.java:20)at junit.extensions.TestSetup.run(TestSetup.java:23)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)at junit.extensions.TestSetup$1.protect(TestSetup.java:19)at junit.extensions.TestSetup.run(TestSetup.java:23)Also fails with the client  as well. Per the comment posted by Suresh to DERBY-2295  it looks like the cause of this failure is that the 'openFile()' method of java/engine/org/apache/derby/impl/load/ExportWriteData.java does not close the file stream in cases where an invalid encoding is specified.", "id": "2456"}, "2462": {"ground_truth": "0", "bug_report": "org.apache.derby.impl.store.access.BackingStoreHashTableFromScan does not honor ResultSet holdability\nAfter an unrelated statement on the same connection commits  and after some number of successful calls to ResultSet.next()  a subsequent call to ResultSet.next() throws an SQLException with a message like: The heap container with container id Container(-1  1173965368428) is closed. This seems to be related to the hard-coded passing of false to the super in the constructor of org.apache.derby.impl.store.access.BackingStoreHashTableFromScan.Steps to reproduce:1. Execute a statement on a connection that returns a result set.2. Execute a second statement on the same connection that modifies the database and commits.3. Call next() on the first result set until the exception is thrown.Note that the number of rows that can be successfully retrieved from the result set seems to be related to the amount of data per row. Increasing the number of columns in the result set or the length of the columns causes the exception to be taken sooner.The attached test program demonstrates the issue.", "id": "2462"}, "2478": {"ground_truth": "0", "bug_report": "'Invalid transaction state...' in jdbcapi.SetTransactionIsolationTest\nSee e.g. http://dbtg.thresher.com/derby/test/Daily/jvm1.5/testing/testlog/sles/520949-suitesAll_diff.txt1) testIsolation(org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest)ERROR X0X03: Invalid transaction state - held cursor requires same isolation level at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.setIsolationLevel(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.setTransactionIsolation(Unknown Source) at org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest.checkIsolationLevelNoTimeout(SetTransactionIsolationTest.java:113) at org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest.testIsolation(SetTransactionIsolationTest.java:50) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:80) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;method&gt;org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest&lt;/method&gt;&lt;signature&gt;Invalid transaction state - held cursor requires same isolation level&lt;/signature&gt;", "id": "2478"}, "2480": {"ground_truth": "1", "bug_report": "DriverManager.getConnection leaks memory when connecting to a non-existent database\nRepeated calls to java.sql.DriverManager.getConnection('jdbc:derby:C:DOES_NOT_EXIST') leak memory and eventually lead to an OutOfMemoryError.This bug is similar to DERBY-1947 in that ContextManager objects are not getting removed from the HashSet. The attached test program demonstrates the issue. When run with VM options -Xms8m -Xmx8m  it throws an OutOfMemoryError after 19022 calls to DriverManager.getConnection.", "id": "2480"}, "2484": {"ground_truth": "0", "bug_report": "Convert syscat.sql to junit\nConvert syscat.sql to junit", "id": "2484"}, "2487": {"ground_truth": "0", "bug_report": "Enhance Derby with EXPLAIN Functionality\nThis enhancement extends Derby with EXPLAIN functions. Users want to have more feedback than they're getting with the current RuntimeStatistics facility. This extension is based on the RuntimeStatistics/ResultSetStatistics functions / classes.", "id": "2487"}, "2501": {"ground_truth": "0", "bug_report": "Batch scripts in bin/ report extraneous errors when DERBY_HOME is invalid\nIf DERBY_HOME is set to an invalid location (for example a directory that does not contain lib/derby.jar)  most .bat scripts in the bin directory (the ones that call derby_common.bat) report three distinct error messages  of which only one is of value to the user. Reproduction:C:/Derby_10/db-derby-10.2.2.0-bin&gt;set DERBY_HOME=c:/tempC:/Derby_10/db-derby-10.2.2.0-bin&gt;echo %DERBY_HOME%c:/tempC:/Derby_10/db-derby-10.2.2.0-bin&gt;bin/sysinfoDERBY_HOME is set incorrectly or derby.jar could not be located. Please set DERBY_HOME.The system cannot find the batch label specified - end'''' is not recognized as an internal or external command operable program or batch file.The distinct error messages are:1) DERBY_HOME is set incorrectly or derby.jar could not be located. Please set DERBY_HOME.2) The system cannot find the batch label specified - end3) '''' is not recognized as an internal or external command  operable program or batch file.Only 1) is relevant for the user  and should ideally be the only one displayed.", "id": "2501"}, "2502": {"ground_truth": "0", "bug_report": "Unclosed ResultSets choke JUnit lang _Suite on java 6\nThe lang suite fail for me from UnaryArithmeticParameterTest on. The tests can't drop table T1 because a ResultSet is open.", "id": "2502"}, "2516": {"ground_truth": "0", "bug_report": "Network Client allows execution of callable statement when one of the parameters is not set\nIf the second input parameter is set and the first is not. Client allows execution of the stored procedure. See the following code in LangProcedureTest.java with a reference to this bug. op.clearParameters(); op.setString(2  '2'); try { // a not set op.execute(); fail('FAIL - a not set'); } catch (SQLException sqle) { assertSQLState('07000'  sqle); }", "id": "2516"}, "2525": {"ground_truth": "0", "bug_report": "Convert lang/grantRevokeDDL and grantRevokeDDL2 to JUnit\nConvert lang/grantRevokeDDL and grantRevokeDDL2 to JUnit", "id": "2525"}, "2532": {"ground_truth": "0", "bug_report": "Client does not return SQLException on XAConnection.getXAResource() on a closed connection  Embedded does\nIn the following scenario from converted test DataSourceTest:(non-tested code based on the test code)---------------- ClientXADataSource dsx = new ClientXADataSource(); dsx.setDatabaseName('tstdb'); XAConnection xac = dsx.getXAConnection(); XAConnection xac2 = dsx.getXAConnection(); XAResource xar2 = xac2.getXAResource(); xac2.close(); // allow close on already closed XAConnection xac2.close(); try { xac2.getXAResource(); // Network Server does not think this is worth an exception. } catch (SQLException sqle) { System.out.println('expect a 08003 as with Embedded'); }------------------With DerbyNetClient  the xac2.getXAResource() does not return an SQLException.This ought to be documented if expected  or fixed.", "id": "2532"}, "2535": {"ground_truth": "0", "bug_report": "Make Locale available in DataValueFactory(DVF). This Locale object will be used to construct Collator object if the user has requested territory based collation.\nAdd a new api on DVF which will make Locale object available to DVF. This new api on DVF will get called by the boot method of BasicDatabase after BasicDatabase has finished booting DVF. This Locale will be either the Locale obtained from the territory attribute supplied by the user on the JDBC url at database create time or if user didn't provide the territory attribute at database create time  then it will be set to the default JVM locale. This Locale object will be used by DVF to construct the Collator object if user has requested territory based collation.The new api will look like following void setLocale(Locale localeOfTheDatabase);", "id": "2535"}, "2543": {"ground_truth": "1", "bug_report": "testVirtualMemoryHeap junit test fails with 'Virtual memory heap test failed! Got unexpected value. expected: but was:'\njunit suite fails with the following error:2) testVirtualMemoryHeap(org.apache.derbyTesting.functionTests.tests.lang.UpdateCursorTest)junit.framework.AssertionFailedError: Virtual memory heap test failed! Got unexpected value. expected:&lt;202&gt; but was:&lt;103&gt; at org.apache.derbyTesting.functionTests.tests.lang.UpdateCursorTest.testVirtualMemoryHeap(UpdateCursorTest.java:178) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)", "id": "2543"}, "2556": {"ground_truth": "1", "bug_report": "Code paths for db restore do not use doPrivileged-calls  causing SecurityException\nWhen using 'createFrom' or 'restoreFrom' in the JDBC url to restore a database from a backup image  a SecurityException is thrown even though the policyfile for codebase derby.jar is correctly configured (giving Derby access to the backup image).A few comments on this issue can be found here (and in subsequent comments): https://issues.apache.org/jira/browse/DERBY-1001#action_12439811A workaround is wrapping the connection call in doPrivileged at the 'application-level code'  or granting the required permissions to the application codebase as well.", "id": "2556"}, "2560": {"ground_truth": "0", "bug_report": "Missing asserts in ProcedureInTriggerTest\nProcedureInTriggerTest sometimes executes queries without checking the results. The comments indicate that the results should have been checked.line 258-259 and line 263-264: //--- Check that insert successful and trigger fired.  rs = s.executeQuery('select * from t1');line 408-410: //--- check delete failed rs = s.executeQuery('select * from t1'); expectedRows = new String[][] { {'5' 'two'} {'6' 'four'} {'8' 'eight'}};line 421-422: //--- check trigger is not dropped rs = s.executeQuery('select count from SYS.SYSTRIGGERS where triggername='TEST_TRIG'');line 431-432: // &#8211; check index is not created rs = s.executeQuery('select count from SYS.SYSCONGLOMERATES where CONGLOMERATENAME='IX' and ISINDEX=1');line 438-440: // &#8211; check delete failed rs = s.executeQuery('select * from t1'); expectedRows = new String[][] { {'5' 'two'} {'6' 'four'} {'8' 'eight'}};", "id": "2560"}, "2564": {"ground_truth": "1", "bug_report": "ContextService.notifyAllActiveThreads()  and network server code need a privileged block around the calls to Thread.interrupt()\nIt looks to me as though the call to interrupt() can raise a SecurityException. I think this may give rise to another permission that we need to add to our template policy file and to our security documentation.", "id": "2564"}, "2570": {"ground_truth": "0", "bug_report": "Create a utility which generates Release Notes\nThis proposal summarizes an off-list conversation among Myrna van Lunteren  Bernt Johnsen  Andrew McIntyre  and myself.Currently  there is a template for release notes in the top level directory of the code tree. Actually filling in this template is a time-consuming  error-prone process. We would like to automate this process as much as possible. We believe it ought to be possible to generate the Release Notes given the following inputs:1) A high-level description of the release. The Release Manager would write this description  based on a template.2) An xml report produced by a JIRA filter. The filter would list all of the JIRAs addressed by the release.In order for this to work  we would need for the community to agree on conventions for the release notes which are attached to JIRAs  viz.  the JIRAs whose 'Release Note Needed' toggles are turned on. These JIRA-specific notes become items in the Issues section of the final Release Notes. Each of these items calls the reader's attention to a significant topic involving Derby's behavior  that behavior's compatibility with previous releases  and adjustments which the user may need to make to her applications.The following approach makes sense to us:A) The community will agree on an html template for these notes.B) The note-writer will fill in this template and attach it to the JIRA using a canonical file name  say 'releaseNote.html'.C) Various iterations of the note may be needed.D) The utility for generating Release Notes will grab the latest rev of 'releaseNote.html' attached to the JIRA.This effort involves at least two major steps:I) Getting the community to agree to these note-writing conventions.II) Writing the Release Note generator.", "id": "2570"}, "2579": {"ground_truth": "0", "bug_report": "AssertFailure class should use JDK's built-in chaining of exceptions\nCurrently  AssertFailure implements its own chaining of exceptions. It should use the chaining mechanism provided by the JDK.", "id": "2579"}, "2583": {"ground_truth": "0", "bug_report": "At code generation time  look at collation type to determine what kind of DVD should get generated for character types.\nCurrently  in Derby 10.2  we generate SQLChar/SQLVarchar/SQLLongvarchar/SQLClob for various SQL character types. All these DVDs have the default collation of UCS_BASIC. Starting 10.3  we should look at the collation type of the DTD before deciding what kind of DVD gets generated for SQL character types. If the collation type of the character type is terriotry based collation  then we should generate CollatorSQLChar/CollatorSQLVarchar/CollatorSQLLongvarchar/CollatorSQLClob rather than SQLChar/SQLVarchar/SQLLongvarchar/SQLClob. The CollatorSQLxxx DVDs will have the territory based collator associated with them and hence the collation order of these DVDs will be different than the DVDs with default collation of UCS_BASIC.", "id": "2583"}, "2592": {"ground_truth": "0", "bug_report": "Wrong description of IndexName field in public JavaDoc for LockTable\nThe public JavaDoc for LockTable says the following in the description of the INDEXNAME retrieved from SYSCS_DIAG.LOCK_TABLE: INDEXNAME varchar(128) - normally null. If non-null  a lock is held on the index  this can only happen if this is not a user transaction.I think the last part is wrong. Normal user transactions might also have a value in the INDEXNAME. For example  here is part of the lock table for three user transactions:XID |TYPE |MODE|TABLENAME |LOCKNAME |STATE|TABLETYPE|INDEXNAME---------------------------------------------------------------------186 |ROW |X |T2 |(1 9) |GRANT|T |NULL184 |ROW |S |T2 |(1 9) |WAIT |T |NULL188 |ROW |X |T1 |(1 11) |GRANT|T |NULL 186 |ROW |S |T1 |(1 11) |WAIT |T |NULL186 |ROW |S |T1 |(1 1) |GRANT|T |SQL070425023213370 188 |ROW |S |T1 |(1 1) |GRANT|T |SQL070425023213370 184 |ROW |X |T1 |(1 7) |GRANT|T |NULL 188 |ROW |S |T1 |(1 7) |WAIT |T |NULL Two of the lock entries have an index. I expect this to be the Scan lock that have been set during traversal of the B-tree.Proposed fix: remove the last part of the sentence.", "id": "2592"}, "2602": {"ground_truth": "0", "bug_report": "TIMESTAMP value is truncated  when return to client\nIn ParameterMappingTest I see the following differences between embedded and client. Client is truncating the TIMESTAMP value. Look for this bug number in the test for reproduction. case java.sql.Types.TIMESTAMP: if (param == 2) if (usingEmbedded()) assertEquals('2004-03-12 21:14:24.938222433'  val.toString()); else assertEquals('2004-03-12 21:14:24.938222'  val.toString()); else if (param == 3) if (usingEmbedded()) assertEquals('2004-04-12 04:25:26.462983731'  val.toString()); else assertEquals('2004-04-12 04:25:26.462983'  val.toString()); break;", "id": "2602"}, "2606": {"ground_truth": "1", "bug_report": "Derby should print the parameters to failed statements to the derby.log when it logs the error\nIt would be good if when derby dumped an error to derby.log it printed the parameters for the failed statement. Currently the default behaviour is that only the statement text will print. Users have to set derby.language.logStatementText=true if they want to see the parameters. It would be useful if any errors included the parameters as well as the statement text.To reproduce put derby.stream.error.logSeverityLevel=0 in your derby.properties and run this script: connect 'jdbc:derby:wombat;create=true';create table t (i int);prepare p as 'insert into t values'; execute p using 'values(1)';execute p using 'values(10000000000000000000000000000000000000000000)';", "id": "2606"}, "2607": {"ground_truth": "0", "bug_report": "DatabaseMetaData is not consistent about throwing SqlException when tablename=null\nAccording to java.sql.DatabaseMetaData  the following DatabaseMetaData methods should not allow tablename=null:getBestRowIdentifier  getColumnPrivileges  getIndexInfo  getVersionColumns  getPrimaryKeys  getImportedKeys  getExportedKeys. In the five former methods  SqlExceptions are thrown if tablename == null  but this check is not performed in the latter two.The method calls eventually end up in EmbedDatabaseMetaData  which performs this check. Hence  an exception is thrown either way. If we want the exception to be thrown as early as possible  the two latter methods should do so as well. If not  the check should be removed from the former methods.", "id": "2607"}, "2610": {"ground_truth": "0", "bug_report": "Queries in metadata.properties allow tablepattern for JDBC methods that do not allow patterns\nThe DatabaseMetaData methods getBestRowIdentifier  getColumnPrivileges  getIndexInfo  getVersionColumns  getPrimaryKeys  getImportedKeys  getExportedKeys do not allow table name patterns. However  the SQL in metadata.properties implement these with 'table like ?'  thus allowing patterns. The SQL for these methods should be modified to 'table=?'.", "id": "2610"}, "2611": {"ground_truth": "0", "bug_report": "upgrade test incorrectly tries to test in place compress in 10.0 release.\nWhen trying to run upgrade test in trunk with all releases available for upgrade to test found at:https://svn.apache.org/repos/asf/db/derby/jars/10.2.2.0/I got 4 errors (not including those that are part of DERBY-2598).:1) testNegValueSupportedLogRecord(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3)java.sql.SQLException: 'SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE' is not recognized as a function or procedure. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:305) at org.apache.derby.impl.sql.compile.StaticMethodCallNode.bindExpression(StaticMethodCallNode.java:224) at org.apache.derby.impl.sql.compile.JavaToSQLValueNode.bindExpression(JavaToSQLValueNode.java:243) at org.apache.derby.impl.sql.compile.CallStatementNode.bindStatement(CallStatementNode.java:145) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:314) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:742) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:567) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:516) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.checkDataToCase606(Changes10_3.java:177) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.testNegValueSupportedLogRecord(Changes10_3.java:118) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)2) testGetTablesModify(org.apache.derbyTesting.functionTests.tests.jdbcapi.DataaseMetaDataTest)java.sql.SQLException: Use of 'XML' requires database to be upgaded from version 10.0 to version 10.1 or later. at org.apache.derby.iapi.error.StandardException.newException(StandardExcepion.java:356) at org.apache.derby.impl.sql.catalog.DD_Version.checkVersion(DD_Version.jav:788) at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.checkVersion(DataDitionaryImpl.java:8487) at org.apache.derby.impl.sql.compile.SQLParser.checkVersion(SQLParser.java:00) at org.apache.derby.impl.sql.compile.SQLParser.XMLType(SQLParser.java:4181) at org.apache.derby.impl.sql.compile.SQLParser.dataTypeCommon(SQLParser.jav:3607) at org.apache.derby.impl.sql.compile.SQLParser.dataTypeDDL(SQLParser.java:337) at org.apache.derby.impl.sql.compile.SQLParser.columnDefinition(SQLParser.jva:3400) at org.apache.derby.impl.sql.compile.SQLParser.tableElement(SQLParser.java:368) at org.apache.derby.impl.sql.compile.SQLParser.tableElementList(SQLParser.jva:3209) at org.apache.derby.impl.sql.compile.SQLParser.tableDefinition(SQLParser.jaa:10992) at org.apache.derby.impl.sql.compile.SQLParser.createStatements(SQLParser.jva:1811) at org.apache.derby.impl.sql.compile.SQLParser.StatementPart(SQLParser.java1718) at org.apache.derby.impl.sql.compile.SQLParser.Statement(SQLParser.java:163) at org.apache.derby.impl.sql.compile.ParserImpl.parseStatement(ParserImpl.jva:151) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.jva:280) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java88) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareIternalStatement(GenericLanguageConnectionContext.java:742) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:56) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:51) at org.apache.derbyTesting.functionTests.tests.jdbcapi.DatabaseMetaDataTestcreateTablesForTest(DatabaseMetaDataTest.java:1123) at org.apache.derbyTesting.functionTests.tests.jdbcapi.DatabaseMetaDataTesttestGetTablesModify(DatabaseMetaDataTest.java:912) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessormpl.java:43) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)3) testNegValueSupportedLogRecord(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3)ERROR 42Y03: 'SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE' is not recognized as a function or procedure. at org.apache.derby.iapi.error.StandardException.newException(StandardException.java) at org.apache.derby.impl.sql.compile.StaticMethodCallNode.bindExpression(StaticMethodCallNode.java) at org.apache.derby.impl.sql.compile.JavaToSQLValueNode.bindExpression(JavaToSQLValueNode.java) at org.apache.derby.impl.sql.compile.CallStatementNode.bind(CallStatementNode.java) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.checkDataToCase606(Changes10_3.java:177) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.testNegValueSupportedLogRecord(Changes10_3.java:122) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)4) Upgrade Phase: UPGRADEjava.sql.SQLException: Failed to start database 'singleUse/oneuse0'  see the next exception for details. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:94) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:173) at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(EmbedConnection.java:2119) at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:1783) at org.apache.derby.impl.jdbc.EmbedConnection.&lt;init&gt;(EmbedConnection.java:249) at org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Driver30.java:74) at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:209) at org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:479) at org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:423) at org.apache.derbyTesting.functionTests.tests.upgradeTests.PhaseChanger.setUp(PhaseChanger.java:94) at junit.extensions.TestSetup$1.protect(TestSetup.java:18) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)FAILURES!!!Tests run: 505  Failures: 0  Errors: 4", "id": "2611"}, "2616": {"ground_truth": "0", "bug_report": "intermittent network startup related errors in running junit nightly test suite\nI intermitently get network startup related errors in running the nightly full test suite on my laptop  running XP  with a firewall and a VPN - I am not sure what if any of those environmental factors is causing it. I have been mostly ignoring the errors as it seemed like it usually was only one test. I my latest run it was more like 7 or 8. I'll append exact tests as a comment on this issue.To debug the problem I picked one - org.apache.derbyTesting.functionTests.tests.derbynet.NSSecurityMechanismTest and ran it in a loop. When I did this it failed everytime after the first one (and the first one intermittently failed). When I bumped the WAIT_TIME up to 300000 and the SLEEP_TIME to 500 injava/testing/org/apache/derbyTesting/junit/NetworkServerTestSetup.java then the test passed everytime . In 30 runs theentire test took varying times from 2 minutes to 6 minutes  mostly in the 4 minute range.", "id": "2616"}, "2631": {"ground_truth": "0", "bug_report": "Expose existing auto-generated key functionality through more JDBC APIs in embedded mode.\nDerby currently supports the following JDBC methods for auto-generated keys: // Indicate that we want to retrieve auto-generated key values. Connection.prepareStatement(String sql  int autoGeneratedKeys); Statement.execute(String sql  int autoGeneratedKeys); Statement.executeUpdate(String sql  int autoGeneratedKeys); // Retrieve the auto-generated values (only applies to INSERT statements). ResultSet rs = Statement.getGeneratedKeys();The current implementation of getGeneratedKeys() internally maps to the 'IDENTITY_VAL_LOCAL()' method  which means that Derby's implementation only returns generated keys for autoincrement columns (no other default columns are supported). Further: 1. The generated key result set only ever has a single column. This is because Derby only allows one autoincrement column per table. 2. The type of the single column in the result set will be DECIMAL(31 0). This is defined by IDENTITY_VAL_LOCAL(). 3. The generated key result set will only ever have a single row. This is because IDENTITY_VAL_LOCAL() only returns values that were assigned as the result of a single row INSERT statement using a VALUES clause. For a single row INSERT statement  at most one autoincrement value will be generated.All of that said  JDBC 3.0 also defines the following methods  which allow the user to explicitly indicate  via column position or column name  the columns for which the auto-generated keys should be made available: Connection.prepareStatement(String sql  String[] columnNames); Connection.prepareStatement(String sql  int[] columnIndexes); Statement.execute(String sql  String[] columNames); Statement.execute(String sql  int[] columIndexes); Statement.executeUpdate(String sql  String[] columnNames); Statement.executeUpdate(String sql  int[] columnIndexes);Derby currently throws a 'Feature not supported' error for all of these methods. However  it seems like the above methods could be 'mapped' onto the existing Derby behavior with relatively little effort (in embedded mode). Most of the required code is already in place.Doing so would make it easier for applications that rely on the columnNames and/or columnIndexes APIs to work with Derby (assuming the app just wants generated keys for identity (autoincrement) columns).Note that this Jira does not entail removing any of the restrictions nor changing any of the behavior outlined above. All of that will remain exactly as it is. This Jira simply exposes the existing functionality (restrictions and all) through additional (standard) API methods. In particular this means that any column specified by index (position) or name must be an auto-increment column for the INSERT table; otherwise Derby should throw an error. Or put differently  a user who specifies a column name/position will get-in the absence of errors-the exact same results as s/he would get from invoking the '(String sql  int autoGeneratedKeys)' method.Note also: This Jira is specifically for embedded mode. I think it would be harder to support these methods for Derby Client and so do not plan to address that.", "id": "2631"}, "2632": {"ground_truth": "0", "bug_report": "upgrade tests fail through BlobStoredProcedureTest and ClobStoredProcedureTest with JSR169\nThe 10.3 upgrade tests (Changes_10.3) add the ClobStoredProcedureTest and BlobStoredProcedureTest.class.However these tests should not run with JSR169  for the stored procedures use DriverManager to obtain the default connection.This should be unimportant with JSR169  because the procedures are internal procedures that are only intended to be exercised by client code  and client/server is not currently supported with JSR169.For reference  the stack trace is (for example) like so:33) testClobGetLengthSP(org.apache.derbyTesting.functionTests.tests.jdbcapi.ClobStoredProcedureTest)java.sql.SQLException: The exception 'java.lang.NoClassDefFoundError: java.sql.DriverManager' was thrown while evaluating an expression. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.iapi.error.StandardException.unexpectedUserException(Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(Unknown Source) at org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(Unknown Source) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(Unknown Source) at org.apache.derby.impl.jdbc.EmbedResultSet.next(Unknown Source) at org.apache.derby.impl.jdbc.EmbedCallableStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(Unknown Source) at org.apache.derbyTesting.functionTests.tests.jdbcapi.ClobStoredProcedureTest.setUp(ClobStoredProcedureTest.java:77) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)", "id": "2632"}, "2642": {"ground_truth": "0", "bug_report": "Convert lang/dynamicLikeOptimization.sql to JUnit\nConvert lang/dynamicLikeOptimization.sql to JUnit", "id": "2642"}, "2645": {"ground_truth": "0", "bug_report": "upgrade test failures with weme 6.1.\nSince activating the upgrade tests for weme6.1 (and resolving some of the failures) I can now see 1 new error and 13 new failures. Some of these may warrant their own bug; some are probably caused by the initial problem.(In the section below  I'm skipping the junit.extensions.* part of the stack.)error:2) testProcedureSignature(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_1)java.sql.SQLException: PROCEDURE 'GC' already exists. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.sql.execute.CreateAliasConstantAction.executeConstantAction(Unknown Source) at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_1.testProcedureSignature(Changes10_1.java:87) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ....------------------failures: 6) testProcedureSignature(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_1)junit.framework.AssertionFailedError: Expected error 'XCL47' but no error was thrown. at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:703) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_1.testProcedureSignature(Changes10_1.java:82) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...2) and  11) testOldVersion(org.apache.derbyTesting.functionTests.tests.upgradeTests.BasicSetup)junit.framework.AssertionFailedError: Old minor (driver): expected:&lt;0&gt; but was:&lt;3&gt; at org.apache.derbyTesting.functionTests.tests.upgradeTests.BasicSetup.testOldVersion(BasicSetup.java:61) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...--------------------3)  7) and 12)  with a variation in originating line number in Changes10_2:(marked (#) in the stack below).and expected error numbertestGrantRevokeStatements(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2)(3  12) junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;...X01&gt; but was:&lt;...Z60&gt;(7)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;XCL47&gt; but was:&lt;42Z60&gt; at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:523) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:585) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:706)(3  12) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.testGrantRevokeStatements(Changes10_2.java:241)(7) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.testGrantRevokeStatements(Changes10_2.java:250) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...Caused by: java.sql.SQLException: GRANT not allowed unless database property derby.database.sqlAuthorization has value 'TRUE'. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.sql.compile.SQLParser.checkSqlStandardAccess(Unknown Source) at org.apache.derby.impl.sql.compile.SQLParser.grantStatement(Unknown Source) at org.apache.derby.impl.sql.compile.SQLParser.StatementPart(Unknown Source) at org.apache.derby.impl.sql.compile.SQLParser.Statement(Unknown Source) at org.apache.derby.impl.sql.compile.ParserImpl.parseStatement(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:701)(3  12) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.testGrantRevokeStatements(Changes10_2.java:241)(7) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.testGrantRevokeStatements(Changes10_2.java:250) at at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) ... 64 more------------------4)  8) and 13) testDatabaseOwnerChange(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2)junit.framework.ComparisonFailure: AUTHORIZATIONID not valid for SYSIBM expected:&lt;DBA&gt; but was:&lt;APP&gt; at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.checkSystemSchemasOwner(Changes10_2.java:300) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_2.testDatabaseOwnerChange(Changes10_2.java:282) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...------------------5)   10) and 14)testPolicyReloadingProcedure(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3)junit.framework.AssertionFailedError: Reloading results. expected:&lt;false&gt; but was:&lt;true&gt; at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.tryReloading(Changes10_3.java:362) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.assertPolicyReloaderDoesNotExist(Changes10_3.java:340) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.testPolicyReloadingProcedure(Changes10_3.java:311) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...------------------9) testImportExportLobsProcedures(org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3)junit.framework.AssertionFailedError: Expected error '42Y03' but no error was thrown. at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:703) at org.apache.derbyTesting.functionTests.tests.upgradeTests.Changes10_3.testImportExportLobsProcedures(Changes10_3.java:252) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) ...------------------", "id": "2645"}, "2658": {"ground_truth": "0", "bug_report": "Convert jdbcapi/parameterMetaDataJdbc30.java to JUnit\nConvert jdbcapi/parameterMetaDataJdbc30.java to JUnit.", "id": "2658"}, "2671": {"ground_truth": "0", "bug_report": "Errors/messages early in starting the network server through NetworkServerControl.start() are not reported to the PrintWriter passed into start().\nCause seems to be not calling setLogWriter() in NetworkServerControlImpl.start() before calling startNetworkServer.", "id": "2671"}, "2699": {"ground_truth": "0", "bug_report": "performance of like in territory based collation databases may be improved by changing way collation elements are calculated.\nWorkHorseForCollatorDatatypes.java has a method getCollationElementsForString() which currently getscalled when processing like clauses in databases that have been created with territory based collation  this isnot an issue in pre-10.3 databases or post 10.3 default databases.getCollationElementsForString gets the collation elements for the entire value of the String held bythe datatype using the class.If you take the case of pattern 'A%' and the value of datatype is 'BXXXXXXXXXXXXXXXXXXXXXXX'  then it would have been better to better to get collation elements one character of the String value at a timeto avoid the process of getting collation elements for the entire string when we don't really need it One could imagine this might have a huge performance impact on running like against a long clob wherethe like pattern has leading fixed-length pattern to match.Comments on this from Dan and Dag can be found in DERBY-2416.", "id": "2699"}, "2712": {"ground_truth": "0", "bug_report": "If large clob is updated after Reader. the reader continues to point to old data\nIf a Reader is fetched from a large clob (obtained from ResultSet) a reader linked to the dvd stream is returned once a set method is called on it the clob data is materialized in control class but the Reader returned previously continues to point to old data.", "id": "2712"}, "2713": {"ground_truth": "0", "bug_report": "Ensure that a temporary file is not created for a lob obtained from resultset unless user updates it.\nCurrently LOBStreamControl has a buffer limit of 4k if the lob is larger than this a temporary file is created. Ensure that lob data is kept in memory unless user start to update it.", "id": "2713"}, "2730": {"ground_truth": "0", "bug_report": "Implement not implemented Embedded methods Blob.getBinaryStream(long pos  long length) and Clob. getCharacterStream(long pos  long length)\nThe following methods were introduced in the java.sql.Clob and java.sql.Blob interface as part of JDBC 4.0 and need to be implemented.Clob------getCharacterStream(long pos  long length)Blob------getBinaryStream(long pos  long length)The implementation on the Network Client is already done as part of Derby-2444", "id": "2730"}, "2740": {"ground_truth": "0", "bug_report": "LIKE parameter marker combined with index multi-probing leads to ASSERT failure with sane jars  wrong results with insane jars.\nIn cases where the optimizer chooses to do index multi-probing for an IN list (DERBY-47)  the presence of a LIKE condition whose argument is a parameter marker leads to an ASSERTion failure with sane jars. With insane jars  the same query returns incorrect results (it only returns rows matching the first argument in the IN list).As an example  if we have the following DDL: create table ct (i int  c1 char(25)  c2 char(40)); insert into ct values 1  2  3  4  5  6  7  8  9; insert into ct values 0  10  11  12  13  14  15  16  17  18  19; insert into ct select 7 * i from ct; insert into ct select 13 * i from ct; update ct set c1 = cast(i as char(25)); update ct set c2 = c1 || c1; create index idx2 on ct (c1  c2);Then we see the following results:&#8211; This one works.select i c1 c2 from ct where c1 in ('1' '2') and c2 like '%' order by i;&#8211; These all work  too.prepare p1 as 'select i c1 c2 from ct where c1 in (''2'' ''1'') and c2 like ''%''';execute p1;prepare p1 as 'select i c1 c2 from ct where c1 in (? ?) and c2 like ''%''';execute p1 using 'values (''1''  ''2'')';&#8211; But these all fail. Something about having a parameter in the LIKE is triggering the assertion...prepare p1 as 'select i c1 c2 from ct where c1 in (? ?) and c2 like ? order by i';execute p1 using 'values (''1''  ''2''  ''%'')';prepare p1 as 'select i c1 c2 from ct where c1 in (? ?) and c2 like ?';execute p1 using 'values (''1''  ''2''  ''%'')';prepare p1 as 'select i c1 c2 from ct where c1 in (''2'' ''1'') and c2 like ?';execute p1 using 'values (''%'')';prepare p1 as 'select i c1 c2 from ct where c1 in (''2'' ?) and c2 like ?';execute p1 using 'values (''1''  ''%'')';The actual assertion is thrown because multiprobing expects the start and stop keys to be same value. But something about the LIKE parameter violates that expectation:ERROR XJ001: Java exception: 'ASSERT FAILED All multi-probing result sets are expected to have a single key that is both the start key AND the stop key  but that is not the case.: org.apache.derby.shared.common.sanity.AssertFailure'.This is a regression introduced by the DERBY-47 changes; everything runs fine in 10.2 and earlier.", "id": "2740"}, "2744": {"ground_truth": "0", "bug_report": "jdbcapi/metadata.java and jdbcapi/odbc_metadata.java fail because of new procedure SYSCS_UTIL SYSCS_GET_USER_ACCESS\nThe following failure occurs with Rev: 543499  likely due to checkin of DERBY-2735failure Details:                 Diff file derbyall/derbylang/metadata.diff             Start: metadata jdk1.6.0_01 derbyall:derbylang 2007-06-01 12:37:31 ***59a60&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx78a80&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx93a96&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx107a111&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx136a141 142&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS  4 12 VARCHAR 128 256 null null 1 null 256 0 YES xxxxGENERATED-IDxxxx 1 -1&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS USERNAME 1 12 VARCHAR 128 256 null null 1 null 256 1 YES xxxxGENERATED-IDxxxx 1 0Test Failed. End: metadata jdk1.6.0_01 derbyall:derbylang 2007-06-01 12:37:40 ***            Diff file derbyall/derbylang/odbc_metadata.diff             Start: odbc_metadata jdk1.6.0_01 derbyall:derbylang 2007-06-01 12:37:45 ***89a90&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx108a110&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx123a126&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx137a141&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS org.apache.derby.catalog.SystemProcedures.SYSCS_GET_USER_ACCESS xxxxGENERATED-IDxxxx166a171 172&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS  4 12 VARCHAR 128 256 null null 1 null 256 0 YES xxxxGENERATED-IDxxxx 1 -1&gt; null SYSCS_UTIL SYSCS_GET_USER_ACCESS USERNAME 1 12 VARCHAR 128 256 null null 1 null 256 1 YES xxxxGENERATED-IDxxxx 1 0Test Failed. End: odbc_metadata jdk1.6.0_01 derbyall:derbylang 2007-06-01 12:37:55 ***", "id": "2744"}, "2751": {"ground_truth": "0", "bug_report": "testLoadJavaClassIndirectly & als fails on JVM 1.4 with 'Unexpected SQL state. expected: but was:'  'Jar file 'MY_JAVA' already exists in Schema 'EMC''\n1) testLoadJavaClassDirectly(org.apache.derbyTesting.functionTests.tests.lang.DatabaseClassLoadingTest)java.sql.SQLException: Jar file 'MY_JAVA' already exists in Schema 'EMC'.2) testLoadJavaClassDirectly2(org.apache.derbyTesting.functionTests.tests.lang.DatabaseClassLoadingTest)java.sql.SQLException: Jar file 'MY_JAVA' already exists in Schema 'EMC'.3) testLoadJavaClassDirectly3(org.apache.derbyTesting.functionTests.tests.lang.DatabaseClassLoadingTest)java.sql.SQLException: Jar file 'MY_JAVA' already exists in Schema 'EMC'.4) testLoadDerbyClassIndirectly(org.apache.derbyTesting.functionTests.tests.lang.DatabaseClassLoadingTest)java.sql.SQLException: Jar file 'MY_JAVA' already exists in Schema 'EMC'.1) testLoadJavaClassIndirectly(org.apache.derbyTesting.functionTests.tests.lang.DatabaseClassLoadingTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;&#91;38000&#93;&gt; but was:&lt;&#91;XJ001&#93;&gt;See e.g.http://dbtg.thresher.com/derby/test/Daily/jvm1.4/testing/Limited/testSummary-543922.htmlhttp://dbtg.thresher.com/derby/test/trunk16/jvmAll/testing/Limited/testSummary-543945.html", "id": "2751"}, "2753": {"ground_truth": "0", "bug_report": "org.apache.derby.impl.drda.DDMWriter might swallow unexpected exceptions\nSome methods in org.apache.derby.impl.drda.DDMWriter catch Exception and print a message about unsupported encoding. They should instead catch the specific exception UnsupportedEncodingException and let all other exceptions propagate up the call stack.", "id": "2753"}, "2754": {"ground_truth": "1", "bug_report": "Client connections should not fail if permission is not granted to read derby.client.traceLevel  and derby.client.traceDirectory\nRunning the 10.2 network server tests with the 10.3 server  most tests fail with:AccessControlException: Access denied java.util.Property derby.client.traceLevel readdue to DERBY-1275. This can break existing applications that don't have this permission and should be a non-fatal warning if permission is not granted.", "id": "2754"}, "2770": {"ground_truth": "0", "bug_report": "testBlobAfterCommit(....jdbcapi.BlobClob4BlobTest) fails with 'Unexpected SQL state. expected: but was:'\ntestBlobAfterCommit(org.apache.derbyTesting.functionTests.tests.jdbcapi.BlobClob4BlobTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;XJ&#91;073&#93;&gt; but was:&lt;XJ&#91;215&#93;&gt;after r544777 / DERBY-2729See http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/544778-org.apache.derbyTesting.functionTests.suites.All_diff.txt", "id": "2770"}, "2785": {"ground_truth": "0", "bug_report": "ij 'describe' built in command cannot describe a table named 'run'\nsteps to duplicate:(attach ij to any database)ij&gt; create table run (i int);0 rows inserted/updated/deletedij&gt; desc run;ERROR 42X01: Syntax error: Encountered 'desc' at line 1  column 1.ij&gt; I think this is a parser problem within ij where the 'run' is taken as a token and that token is not included in the definition of a tablename expression in the grammer (should be an easy fix).", "id": "2785"}, "2787": {"ground_truth": "0", "bug_report": "make entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback\nmake entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback", "id": "2787"}, "2789": {"ground_truth": "0", "bug_report": "DatabaseMetaData .locatorsUpdateCopy() should return true\nSince updates made to a BLOB or CLOB value in Derby is made on a copy  DatabaseMetaData .locatorsUpdateCopy() call should return true. For the embedded driver the functionality to update a LOB value is new in 10.3. For the client driver  updates have been possible in prior releases  and locatorsUpdateCopy() has returned false. That behavior was wrong since the client updated a main-memory copy  not the values in the database. For 10.3  the client will use a locator based implementation which will rely on the behavior of the embedded driver. Hence  locatorsUpdateCopy() should return true in both cases.", "id": "2789"}, "2796": {"ground_truth": "1", "bug_report": "Obscure error messages when using SSL in various combinations\nI ran clients with various ssl configurations on their urls and startup options against servers with various ssl configurations. I will attach an html file recording my results. I feel that many of the error conditions raised diagnostics which were too obscure to be helpful. I think this will be burdensome to tech support.", "id": "2796"}, "2805": {"ground_truth": "0", "bug_report": "ASSERT failure with sane build if DISTINCT and ORDER BY are present in a query that selects from a diagnostic table function.\nAttempts to execute the following query will lead to an ASSERT failure with sane jars:ij&gt; select distinct * from table(syscs_diag.space_table('T1')) X order by 3;ERROR XJ001: Java exception: 'ASSERT FAILED markOrderingDependent() not expected to be called for org.apache.derby.impl.sql.compile.FromVTI: org.apache.derby.shared.common.sanity.AssertFailure'.Stack trace is: at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147) at ResultSetNode.markOrderingDependent(ResultSetNode.java:1881) at SingleChildResultSetNode.markOrderingDependent(SingleChildResultSetNode.java:578) at SingleChildResultSetNode.markOrderingDependent(SingleChildResultSetNode.java:578) at SingleChildResultSetNode.markOrderingDependent(SingleChildResultSetNode.java:578) at SelectNode.genProjectRestrict(SelectNode.java:1409) at SelectNode.modifyAccessPaths(SelectNode.java:1816) at SingleChildResultSetNode.modifyAccessPaths(SingleChildResultSetNode.java:439) at DMLStatementNode.optimizeStatement(DMLStatementNode.java:307) at CursorNode.optimizeStatement(CursorNode.java:515)I was able to avoid this by adding an empty implementation of 'markOrderingDependent' to the FromVTI class  so that's probably the fix that I will post (after looking a bit more closely at the code to see if this makes sense).", "id": "2805"}, "2806": {"ground_truth": "0", "bug_report": "calling getByteLength on org.apache.derby.impl.jdbc.StoreStreamClob makes BinaryStream  fetched before this call  unusable\nStoreStreamClob.getByteLength first resets the internal stream and then reads the entire stream. Due to this any read on Stream obtained by StoreStreamClob.getRawByteStream returns -1.StoreStreamClob is a read only InternalClob  so probably keeping the length in a variable will be good idea.", "id": "2806"}, "2812": {"ground_truth": "0", "bug_report": "Assessing blob (when its linked to DVD stream  ie large blob) corrupts stream fetched prior to this access.\nAssessing blob (when its linked to DVD stream  ie large blob) corrupts stream fetched prior to this access.", "id": "2812"}, "2815": {"ground_truth": "0", "bug_report": "ij doesn't start with J2ME / JSR169 / weme6.1 because attempting to find java.sql.Driver if ij.protocol property is specified\nWhen starting ij with the following command:ij -jcl:foun11 -Xbootclasspath/a:&lt;path_to_jdbc.jar&gt; org.apache.derby.tools.ij -p derby.propertiesand derby.properties contains the following:-----------------ij.database=jdbc:derby:bladb;create=trueij.protocol=jdbc:derby:ij.showNoConnectionsAtStart=trueij.showNoCountForSelect=true DataSource properties  only used if ij.dataSource is setij.dataSource.databaseName=bladbij.dataSource.createDatabase=createij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource------------------ij does not start and instead gives the following stack trace:Exception in thread 'main' java.lang.NoClassDefFoundError: java.sql.Driver at java.lang.ClassLoader.defineClassImpl(Native Method) at java.lang.ClassLoader.defineClass(ClassLoader.java:226) at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:109) at java.net.URLClassLoader.findClassImpl(URLClassLoader.java:1029) at java.net.URLClassLoader$4.run(URLClassLoader.java:549) at java.security.AccessController.doPrivileged(AccessController.java:213) at java.net.URLClassLoader.findClass(URLClassLoader.java:547) at com.ibm.oti.vm.URLSystemClassLoader.findClass(URLSystemClassLoader.java:27) at java.lang.ClassLoader.loadClass(ClassLoader.java:606) at com.ibm.oti.vm.URLSystemClassLoader.loadClass(URLSystemClassLoader.java:60) at java.lang.ClassLoader.loadClass(ClassLoader.java:563) at java.lang.Class.forNameImpl(Native Method) at java.lang.Class.forName(Class.java:114) at org.apache.derby.impl.tools.ij.util.loadDriver(util.java:849) at org.apache.derby.impl.tools.ij.util.loadDriverIfKnown(util.java:833) at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:476) at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:585) at org.apache.derby.impl.tools.ij.ConnectionEnv.init(ConnectionEnv.java:64) at org.apache.derby.impl.tools.ij.utilMain.initFromEnvironment(utilMain.java:179) at org.apache.derby.impl.tools.ij.Main.&lt;init&gt;(Main.java:230) at org.apache.derby.impl.tools.ij.Main.getMain(Main.java:193) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:178) at org.apache.derby.impl.tools.ij.Main.main(Main.java:73) at org.apache.derby.tools.ij.main(ij.java:67)The properties file is an example of the 'old test harness' properties files. The test harness would get sql scripts tested with J2ME by stripping away the ij.protocol and ij.database specifications.In another bug - DERBY-1218 - it was suggested ij.protocol be blanked out (in tools/ij/util.java?) with J2ME.Another approach would be to check for ij.protocol or ij.database setting when we have a datasource and we're using J2ME.", "id": "2815"}, "2817": {"ground_truth": "0", "bug_report": "Error messages for deadlocks contain less information than in 10.2\nIn 10.2  an error message for a deadlock would look like this:ERROR 40001: A lock could not be obtained due to a deadlock  cycle of locks and waiters is:Lock : ROW  T  (1 8) Waiting XID : {235  S}   APP  select * from t where id = 2 Granted XID : {238  X} Lock : ROW  T  (1 7) Waiting XID : {238  S}   APP  select * from t where id = 1 Granted XID : {235  X} . The selected victim is XID : 235.On trunk  the same deadlock would be reported asjava.sql.SQLException: A lock could not be obtained due to a deadlock  cycle of locks and waiters is:Lock : ROW  T  (1 8) Waiting XID : {org.apache.derby.impl.services.locks.LockSpace@94884d  S}  Granted XID : {org.apache.derby.impl.services.locks.LockSpace@da6bf4  X} Lock : ROW  T  (1 7) Waiting XID : {org.apache.derby.impl.services.locks.LockSpace@da6bf4  S}  Granted XID : {org.apache.derby.impl.services.locks.LockSpace@94884d  X} . The selected victim is XID : org.apache.derby.impl.services.locks.LockSpace@94884d.That is  the transaction id and the failing statement are not shown.", "id": "2817"}, "2818": {"ground_truth": "0", "bug_report": "Rewrite ClobUpdatableReader constructors\nWhen the fix for DERBY-2806 is in place  the current implementation of ClobUpdateableReader will fail.This patch is a preparation for the mentioned issue  and I have also removed some 'internal' (package private) methods from EmbedClob and replaced it with a single one. Instead of writing methods that forwards calls to the underlying InternalClob  the method getInternalClob will return the internal clob itself. This seems more in place  since the method getByteLength does not belong in EmbedClob. It also comes with a warning that using the reference to the internal clob object requires the caller to take more care. Second  isWritable() does not belong to EmbedClob either  as a Clob is always writable (unless the database/connection itself is read/only). However  the internal clob representation may be read-only  in case EmbedClob must clone the content and create a writable representation.The fix leaves more of the handling of implementation details to the InternalClob itself.", "id": "2818"}, "2824": {"ground_truth": "0", "bug_report": "Improve error reporting  fix whitespace/formatting issues and replace tabs in UTF8Reader\nI plan to do the following changes to UTF8Reader: Improve the error reporting when hitting a UTF8 decoding error (currently an UTFDataFormatException with no message). This might also lead to deleting one helper method for generating an exception (the one with no message). Improve error reporting for trying to use the reader after it has been closed (currently an IOException with no message). Remove trailing spaces  and add a few newlines here and there. Replace tabs in the file with spaces.Now  the last point can be discussed  but here are my arguments for doing it: The file now has a mix of tabs and spaces (but still more tabs). Spaces are the preferred/required method of indentation. I want to get it fixed before the branch is cut  which makes it easier to port fixes from trunk/10.3-NEXT to 10.3. If I don't make it for 10.3  I won't do it. I don't see it as very likely that we will back-port major fixes to this class on the 10.2 branch. If we have to  I will volunteer  Since so much else of the Clob 'infrastructure' has changed recently  this seems like a good time to do the clean-up.Please raise your concern as soon as possible if you want to veto these changes. I do plan to commit them tomorrow.", "id": "2824"}, "2827": {"ground_truth": "0", "bug_report": "Rename ClobStreamControl to TemporaryClob\nSince the original submission  the situation has changed quite a lot and the original name no longer fits as well as it did before.The class is changed to TemporaryClob  signalling that the Clob object is living temporarily outside the database. This is true for all scenarios  except for small Clobs that are stored as non-stream objects in the database. The general contract is that as soon as a change is made to the Clob  it becomes a temporary Clob. Unless the user reinserts the Clob (i.e. updateRow  updateClob + execute)  the changes will be lost. This is also true for Clobs created with Connection.createClob. If it is not explicitly inserted into the database  it is lost.", "id": "2827"}, "2862": {"ground_truth": "0", "bug_report": "ParameterMetaDataJdbc30 fails for weme6.1  which prevents rest of suites.All from completing.\nWith the addtion of the ParameterMetaDataJdbc30 JUnit test (DERBY-2658)  suites.All has been failing with weme6.1. It turns out the that new ParameterMetaDataJdbc30Test fails with the following error: Failed to invoke suite():java.lang.NoClassDefFoundError: java.sql.ParameterMetaData which prevents suites.All from continuing and thus no results can be gathered.It might be good to disable the test for weme6.1 at least in the short term so that rest of suites.All can run cleanly again. Not sure if that's a complete solution or just a temporary one until the test can be fixed...", "id": "2862"}, "2868": {"ground_truth": "0", "bug_report": "BUILDING.txt doesn't mention junit.jar in list of jars installed in tools/java\nBUILDING.txt contains this paragraph:Note: After following the steps in sections 2.2.4-2.2.8 of thisdocument  you should have the following:${derby.source}/tools/java/empty.jar${derby.source}/tools/java/geronimo-spec-servlet-2.4-rc4.jar${derby.source}/tools/java/jakarta-oro-2.0.8.jar${derby.source}/tools/java/javacc.jar${derby.source}/tools/java/osgi.jar----Since section 2.2.5 mentions how to install junit.jar into ${derby.source}/tools/java  the list should also include junit.jar.Also  since the paragraph refers to sections 2.2.4-2.2.8  it should be located below section 2.2.8 (currently  it's between 2.2.7 and 2.2.8).", "id": "2868"}, "2870": {"ground_truth": "0", "bug_report": "iepnegativetests_ES.sql fails: new canon needed?\nSee http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/Limited/testSummary-550528.html / w2003&lt;method&gt;i18n/iepnegativetests_ES.sql&lt;/method&gt;&lt;signature&gt;&lt; ERROR XJ001: Excepci EnC:&gt;243&lt; n de Java: 'extout/nodir/t1.dat (No such file or directory): java.io.FileNotFoundException'.49a49&gt; ERROR XJ001: Excepci EnC:&gt;243&lt; n de Java: 'extout/nodir/t1.dat (The system cannot find the path specified): java.io.FileNotFoundException'.&lt;/signature&gt;", "id": "2870"}, "2874": {"ground_truth": "1", "bug_report": "NetworkServer not accepting connections with default security manager on Ipv6 machines\nWhile running tests on Ipv6 machines using the 10.3 jars with the default security manager  I had the following findings/questionsI started the server like this java org.apache.derby.drda.NetworkServerControl start -h 2002:92a:8f7a:13:9:42:74:19and the server started with the following commandSecurity manager installed using the Basic server security policy.Apache Derby Network Server - 10.3.1.0 beta - (548006) started and ready to accept connections on port 1527 at 2007-06-25 23:44: 36.835 GMTSo I think the server is using the default security manager. Then when I tried to get conenction though ijgot the following error messageAccess denied (java.net.SocketPermission &#91;2002:92a:8f7a:13:9:42:73:218&#93;:34016 accept resolve)java.security.AccessControlException: Access denied (java.net.SocketPermission &#91;2002:92a:8f7a:13:9:42:73:218&#93;:34016 accept resolve)  at java.security.AccessController.checkPermission(AccessController.java:104) at java.lang.SecurityManager.checkPermission(SecurityManager.java:547) at java.lang.SecurityManager.checkAccept (SecurityManager.java:1172) at java.net.ServerSocket.implAccept(ServerSocket.java:466) at java.net.ServerSocket.accept(ServerSocket.java:433) at org.apache.derby.impl.drda.ClientThread$1.run (Unknown Source) at java.security.AccessController.doPrivileged(AccessController.java:242) at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)I had the derby.properties file like thisderby.database.sqlAuthorization=truederby.connection.requireAuthentication=truederby.infolog.append=truederby.authentication.provider=BUILTINderby.stream.error.logSeverityLevel=0#derby.language.logStatementText=true User's Definitionsderby.user.user2=pass2", "id": "2874"}, "2879": {"ground_truth": "0", "bug_report": "CREATE TABLE AS  does not maintain the collation for character types.\ncreate table t as select tablename from sys.systables with no data;This creates a column TABLENAME with collation based upon the user schema  but the type of sys.systables.tablename has collation UCS_BASIC.The required behaviour should be verified with the SQL standard (11.3 SR6)  but since collation is an attribute of a type it seems logical that the collation is maintained by the create.Fixing this to keep the collation of the system column will cause problems though as there would be no way to recreate this table through a regular create table  say if the schema is dumped and recreated using ddlutils.I think this is critical as fixing it after a release would lead to a change in behaviour for applications.", "id": "2879"}, "2885": {"ground_truth": "0", "bug_report": "Wrong connection object used in EmbedConnection.clearLOBMapping()\nI think there are two bugs in EmbedConnection.clearLOBMapping(): 1) It checks if lobHashMap is non-null  but it should have checked rootConnection.lobHashMap. 2) It calls getlobHMObj().clear() regardless of whether there is a HashMap. This creates a HashMap object even though it's not needed  and all the subsequent transactions on that connection have to perform cleanup on that object.", "id": "2885"}, "2892": {"ground_truth": "0", "bug_report": "Closing a resultset after retrieving a large > 32665 bytes value with Network Server does not release locks\nThis is the same issue as DERBY-255 (https://issues.apache.org/jira/browse/DERBY-255). The test attached to DERBY-255 shows the locks being not released. Everything is fine when using Derby 10.1.3.1 .I would think it's a regression bug.Output from sysinfo:------------------ Java-Informationen ------------------Java-Version: 1.6.0_01Java-Anbieter: Sun Microsystems Inc.Java-Home: C:/work/applications/development/java/jdk1.6u1-SE/jreJava-Klassenpfad: C:/work/applications/development/derby-10.2.2.0/lib/derby.jar;C:/work/applications/development/derby-0.2.2.0/lib/derbynet.jar;C:/work/applications/development/derby-10.2.2.0/lib/derbyclient.jar;C:/work/applications/develpment/derby-10.2.2.0/lib/derbytools.jarName des Betriebssystems: Windows XPArchitektur des Betriebssystems: x86Betriebssystemversion: 5.1Java-Benutzername: thomas.niessenJava-Benutzerausgangsverzeichnis: C:/Dokumente und Einstellungen/thomas.niessenJava-Benutzerverzeichnis: C:/work/applications/development/derby-10.2.2.0java.specification.name: Java Platform API Specificationjava.specification.version: 1.6--------- Derby-Informationen --------JRE - JDBC: Java SE 6 - JDBC 4.0&#91;C:/work/applications/development/derby-10.2.2.0/lib/derby.jar&#93; 10.2.2.0 - (485682)&#91;C:/work/applications/development/derby-10.2.2.0/lib/derbytools.jar&#93; 10.2.2.0 - (485682)&#91;C:/work/applications/development/derby-10.2.2.0/lib/derbynet.jar&#93; 10.2.2.0 - (485682)&#91;C:/work/applications/development/derby-10.2.2.0/lib/derbyclient.jar&#93; 10.2.2.0 - (485682)----------------------------------------------------------------------- Informationen zur Lndereinstellung -----------------Aktuelle Lndereinstellung: [Deutsch/Deutschland &#91;de_DE&#93;]Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;cs&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;de_DE&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;es&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;fr&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;hu&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;it&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;ja_JP&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;ko_KR&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;pl&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;pt_BR&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;ru&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;zh_CN&#93; Version: 10.2.2.0 - (485682)Es wurde Untersttzung fr die folgende Lndereinstellung gefunden: &#91;zh_TW&#93; Version: 10.2.2.0 - (485682)", "id": "2892"}, "2893": {"ground_truth": "1", "bug_report": "INSERT and UPDATES succeed when permission has not been granted.\nGrantRevokeTest had assert methods (assertInsertPrivilege etc.) of the formtry { s.execute(command)} catch (SQLException sqle){ if (!hasPrivilege)  assertSQLState('42502'  e); else fail(...);}Note that no fail() assert was in the try portion after the SQL execution. The statement should not work if hasPrivilege is false  but the test will incorrectly pass if the statement succeeds. I added fail asserts with revision 552922 like:if (!hasPrivilege) fail('expected no INSERT permission on table');but these two for INSERT and UPDATE caused the test to fail (about 6 fixtures fail) indicating that the statement succeeds even if the permission is not granted.It could be a test problem but needs some investigation.The asserts for assertInsertPrivilege and asserUpdatePrivilege are commented out to stop the test failing.", "id": "2893"}, "2902": {"ground_truth": "0", "bug_report": "AS IDENTITY (START WITH -9223372036854775808) fails\nWhen creating a tableAS IDENTITY (START WITH -9223372036854775808)fails butAS IDENTITY (START WITH -9223372036854775807)succeeds.Guess this is a parsing SQL problem as the absolute value appears to be held in a long  which is not quite long enough at the positive end.", "id": "2902"}, "2910": {"ground_truth": "0", "bug_report": "SimpleStringOperatorNode in it's bindExpression method generates a character string CAST if required but does not set the correct collation.\nFollowing query should run into error if run in a territory based database SELECT TABLENAME FROM SYS.SYSTABLES WHERE UPPER(CURRENT_DATE) = TABLENAME;When a CAST node is generated on top of CURRENT_DATE to create a character string type  we do not set the collation of that character string type and hence it always ends up getting the default which is collation derivation IMPLICIT and collation type UCS_BASIC. That does not sound right. There might be other places where we generate CAST node to create a character string type. We should check if the collation is set correctly for them.", "id": "2910"}, "2911": {"ground_truth": "0", "bug_report": "Implement a buffer manager using java.util.concurrent classes\nThere are indications that the buffer manager is a bottleneck for some types of multi-user load. For instance  Anders Morken wrote this in a comment on DERBY-1704: 'With a separate table and index for each thread (to remove latch contention and lock waits from the equation) we (...) found that org.apache.derby.impl.services.cache.Clock.find()/release() caused about 5 times more contention than the synchronization in LockSet.lockObject() and LockSet.unlock(). That might be an indicator of where to apply the next push'.It would be interesting to see the scalability and performance of a buffer manager which exploits the concurrency utilities added in Java SE 5.", "id": "2911"}, "2935": {"ground_truth": "0", "bug_report": "DDMReader.readLengthAndCodePoint() decodes long integer incorrectly\nDDMReader.readLengthAndCodePoint() contains code to decode a long integer from a byte array. This code is broken since it uses int operations and not long operations in the decoding. The long might be encoded using four  six or eight bytes  and since Derby currently always uses the four bytes encoding  the bug is not exposed in the current code.", "id": "2935"}, "2937": {"ground_truth": "0", "bug_report": "ERROR 22011: The second or third argument of the SUBSTR function is out of range   with data concatenation in group by query.\nCREATE TABLE A (C CHAR(10) NOT NULL  D DATE NOT NULL  DC DECIMAL(6 2));INSERT INTO A VALUES ('aaa'  DATE('2007-07-10')  500.00); SELECT A.C  SUBSTR (MAX(CAST(A.D AS CHAR(10)) || CAST(A.DC AS CHAR(8)))  11  8) AS BUG FROM A GROUP BY A.C;results in a 22011 error on the select.ij&gt; C |BUG-------------------ERROR 22011: The second or third argument of the SUBSTR function is out of rangeNote that the ResultSetMetaData seems to indicate to ij that the column width of 'BUG' is four instead of 18.", "id": "2937"}, "2946": {"ground_truth": "0", "bug_report": "In soft upgrade mode  the metadata queries do not get compiled in SYS schema. This will cause problems in future releases of Derby.\nEmbedDatabaseMetaData implements metadata queries. The implementation of metadata queries in EmbedDatabaseMetaData checks if we are in soft upgrade mode (getPreparedQuery() has following code)if (notInSoftUpgradeMode()) s = getPreparedQueryUsingSystemTables(queryName  net);else { try { //Can't use stored prepared statements because we are in soft upgrade //mode and hence need to get metadata sql from metadata.properties file //or metadata_net.properties String queryText = getQueryFromDescription(queryName  net); s = getEmbedConnection().prepareMetaDataStatement(queryText); } catch (Throwable t) { throw handleException(t); } }So  when running in soft upgrade mode  we do not go through SYSSTATEMENT but this will cause the metadata query to run in whatever the current schema may be rather than in SYS schema. This is not a problem in Derby 10.3 release because during soft upgarde  the collation will always be UCS_BASIC and hence collation mismatch can't happen.But in Derby 10.3  a user can create a database with territory based collation. When such a database will be in soft upgrade mode for say Derby 10.4  the metadata queries will run into problem if they are run in a user schema. This is because in soft upgrade mode  we do not go through SYSSTATEMENTS and instead compile the metadata queries in current schema. If the current schema is user schema  then character string literals in metadata queries will get the collation type of territory based and when compared with character string colunms from SYS tables with collation type of UCS_BASIC  we will end up getting compilation error for the metadata queries. So  before the next release  we will have to fix this problem. One solution may be to somehow make the current compilation schema as SYS when running the metadata queries in soft upgrade mode.", "id": "2946"}, "2951": {"ground_truth": "0", "bug_report": "BatchUpdateTest.testAssociatedParams test fails with collation with exception: Java exception: 'ASSERT FAILED type of inserted column[0] = org.apache.derby.iapi.types.CollatorSQLChartype of template column[0] = org.apache.derby.iapi.types.SQLChar:\nBatchUpdateTest.testAssociatedParams test fails with collation with exception: java.sql.SQLException: Java exception: 'ASSERT FAILED type of inserted column&#91;0&#93; = org.apache.derby.iapi.types.CollatorSQLChartype of template column&#91;0&#93; = org.apache.derby.iapi.types.SQLChar: org.apache.derby.shared.common.sanity.AssertFailure'.Full trace below:Java exception: 'ASSERT FAILED type of inserted column&#91;0&#93; = org.apache.derby.iapi.types.CollatorSQLChartype of template column&#91;0&#93; = org.apache.derby.iapi.types.SQLChar: org.apache.derby.shared.common.sanity.AssertFailure'.at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:245) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1572) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1293) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.derbyTesting.functionTests.tests.jdbcapi.BatchUpdateTest.testAssociatedParams(BatchUpdateTest.java:416) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:615) at junit.framework.TestCase.runTest(TestCase.java:154) at junit.framework.TestCase.runBare(TestCase.java:127) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.framework.TestResult$1.protect(TestResult.java:106) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.framework.TestResult.run(TestResult.java:109) at junit.framework.TestCase.run(TestCase.java:118) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:128) at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)Caused by: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED type of inserted column&#91;0&#93; = org.apache.derby.iapi.types.CollatorSQLChartype of template column&#91;0&#93; = org.apache.derby.iapi.types.SQLChar at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147) at org.apache.derby.impl.store.access.btree.OpenBTree.isIndexableRowConsistent(OpenBTree.java:529) at org.apache.derby.impl.store.access.btree.BTreeController.doIns(BTreeController.java:385) at org.apache.derby.impl.store.access.btree.BTreeController.insert(BTreeController.java:1035) at org.apache.derby.impl.store.access.btree.index.B2IController.insert(B2IController.java:211) at org.apache.derby.impl.sql.execute.IndexChanger.insertAndCheckDups(IndexChanger.java:455) at org.apache.derby.impl.sql.execute.IndexChanger.doInsert(IndexChanger.java:398) at org.apache.derby.impl.sql.execute.IndexChanger.insert(IndexChanger.java:605) at org.apache.derby.impl.sql.execute.IndexSetChanger.insert(IndexSetChanger.java:268) at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:453) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1024) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) ... 54 more", "id": "2951"}, "2955": {"ground_truth": "0", "bug_report": "ERROR 42ZA2 creating table with check constraint with literal comparison\nI cannot create the following table with a collated database. EMPNAME should be TERRITORY_BASED collation I think  but perhaps is not initialized in time for the check constraint processing.ij&gt; connect 'jdbc:derby:nordb;create=true;territory=no_NO;collation=TERRITORY_BASED';ij&gt; CREATE TABLE STAFF9 (EMPNUM CHAR(3) NOT NULL CONSTRAINT STAFF9_PK PRIMARY KEY  EMPNAME CHAR(20)  GRADE DECIMAL(4)  CITY CHAR(15)  CONSTRAINT STAFF9_EMPNAME CHECK (EMPNAME NOT LIKE 'T%'));ERROR 42ZA2: Operand of LIKE predicate with type CHAR(20) and collation UCS_BASIC is not compatable with LIKE pattern operand with type CHAR(2) and collation TERRITORY_BASED.", "id": "2955"}, "2961": {"ground_truth": "0", "bug_report": "TriggerTest.testTypesINActionStatement fails with 'ASSERT FAILED col1.getClass() (class org.apache.derby.iapi.types.SQLClob) expected to be the same as col2.getClass() (class org.apache.derby.iapi.types.CollatorSQLClob)\nI have not yet been able to create a stand-alone repro but the test TriggerTest.testTypesINActionStatement fails with 'ASSERT FAILED col1.getClass() (class org.apache.derby.iapi.types.SQLClob) expected to be the same as col2.getClass() (class org.apache.derby.iapi.types.CollatorSQLClob)Failed statement is: sqlMain = 'SELECT ID  XMLSERIALIZE(V AS CLOB)  ' + 'XMLSERIALIZE(V AS CLOB) FROM T_MAIN ORDER BY 1';2) testTypesInActionStatement(org.apache.derbyTesting.functionTests.tests.lang.TriggerTest)java.sql.SQLException: Java exception: 'ASSERT FAILED col1.getClass() (class org.apache.derby.iapi.types.SQLClob) expected to be the same as col2.getClass() (class org.apache.derby.iapi.types.CollatorSQLClob): org.apache.derby.shared.common.sanity.AssertFailure'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:245) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1572) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1293) at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:596) at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(EmbedStatement.java:153) at org.apache.derbyTesting.functionTests.tests.lang.TriggerTest.actionTypesCompareMainToAction(TriggerTest.java:769) at org.apache.derbyTesting.functionTests.tests.lang.TriggerTest.actionTypesInsertTest(TriggerTest.java:546) at org.apache.derbyTesting.functionTests.tests.lang.TriggerTest.actionTypeTest(TriggerTest.java:445) at org.apache.derbyTesting.functionTests.tests.lang.TriggerTest.testTypesInActionStatement(TriggerTest.java:427) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)Caused by: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED col1.getClass() (class org.apache.derby.iapi.types.SQLClob) expected to be the same as col2.getClass() (class org.apache.derby.iapi.types.CollatorSQLClob) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147) at org.apache.derby.impl.store.access.sort.MergeSort.checkColumnTypes(MergeSort.java:467) at org.apache.derby.impl.store.access.sort.MergeInserter.insert(MergeInserter.java:98) at org.apache.derby.impl.sql.execute.SortResultSet.loadSorter(SortResultSet.java:317) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(SortResultSet.java:268) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(BasicNoPutResultSetImpl.java:258) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) ... 45 more", "id": "2961"}, "2966": {"ground_truth": "0", "bug_report": "rs.moveToInsertRow() causes loss of connection with TERRITORY_BASED collation.\nIn the attached test case  rs.moveToInsertRow() causes loss of the connection with a TERRITORY_BASED collation database. With UCS_BASIC it is fine.", "id": "2966"}, "2981": {"ground_truth": "0", "bug_report": "Convert jdbcapi/prepStamtNull.java to JUnit\nConvert jdbcapi/prepStamtNull.java to JUnit", "id": "2981"}, "2983": {"ground_truth": "0", "bug_report": "The ResultSet returned by DatabaseMetaData.getFunctions() does not contain a required column named FUNCTION_TYPE.\nThe FUNCTION_TYPE column  sandwiched between REMARKS and SPECIFIC_NAME  is supposed to describe the return type of the function.", "id": "2983"}, "2986": {"ground_truth": "0", "bug_report": "Query involving CASE statement significantly slower in 10.3.1.4 than in 10.2.2.0\nA select of a CASE statement that performed acceptably in 10.2.2.0 is very slow in 10.3.1.4 the first time it is executed.The following example ij script:ELAPSEDTIME ON;CREATE table test1(id integer);CREATE table test2(id varchar(10));SELECT CASE WHEN t.id = 1 THEN 'a' WHEN t.id = 2 THEN 'b' WHEN t.id = 3 THEN 'c' WHEN t.id = 4 THEN 'd' WHEN t.id = 5 THEN 'e' WHEN t.id = 6 THEN 'f' WHEN t.id = 7 THEN 'g' WHEN t.id = 8 THEN 'h' WHEN t.id = 11 THEN 'i' WHEN t.id = 12 THEN 'j'  WHEN t.id = 15 THEN 'k' WHEN t.id = 16 THEN 'l' WHEN t.id = 23 THEN 'm'  WHEN t.id = 24 THEN 'n' WHEN t.id = 27 THEN 'o' WHEN t.id = 31 THEN 'p' WHEN t.id = 41 THEN 'q' WHEN t.id = 42 THEN 'r' WHEN t.id = 50 THEN 's' ELSE (SELECT t2.id FROM test2 t2 ) ENDFROM test1 t;When run on 10.2.2.0 the select results in ELAPSED TIME = 187 milliseconds.When run on 10.3.1.4 the select results in ELAPSED TIME = 62281 milliseconds.", "id": "2986"}, "2989": {"ground_truth": "0", "bug_report": "Insert into table with constraints fails if the table name is 'indicator' (or any other SQL keyword)\nI've runned the testcase against both 10.2.2.0 (latest stable) and 10.4.0.0 alpha (trunk) and results are the same.Sysinfo output:------------------ Java ------------------Java: 1.5.0_11 Java: Sun Microsystems Inc.  Java: C:/java/jre-1.5.0 Java: D:/dev/workspaces/DerbyQuery/bin;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbytools.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derby.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyclient.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_cs.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_de_DE.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_es.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_fr.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_hu.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_it.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_ja_JP.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_ko_KR.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_pl.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_pt_BR.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_zh_CN.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyLocale_zh_TW.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbynet.jar;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyrun.jar: Windows XP : x86: 5.1Java: dmitrygusev  Java: C:/Documents and Settings/dmitrygusev Java: D:/dev/workspaces/DerbyQueryjava.specification.name: Java Platform API Specificationjava.specification.version: 1.5--------- Derby --------JRE - JDBC: J2SE 5.0 - JDBC 3.0&#91;D:/dev/src/db-derby-trunk-20070802/jars/sane/derby.jar&#93; 10.4.0.0 alpha - (???)&#91;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbytools.jar&#93; 10.4.0.0 alpha - (???)&#91;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbynet.jar&#93; 10.4.0.0 alpha - (???)&#91;D:/dev/src/db-derby-trunk-20070802/jars/sane/derbyclient.jar&#93; 10.4.0.0 alpha - (???)-----------------------------------------------------------------------   ------------------ [/&#91;ru_RU&#93;]  : &#91;cs&#93;  10.4.0.0 alpha - (???)  : &#91;de_DE&#93;  10.4.0.0 alpha - (???)  : &#91;es&#93;  10.4.0.0 alpha - (???)  : &#91;fr&#93;  10.4.0.0 alpha - (???)  : &#91;hu&#93;  10.4.0.0 alpha - (???)  : &#91;it&#93;  10.4.0.0 alpha - (???)  : &#91;ja_JP&#93;  10.4.0.0 alpha - (???)  : &#91;ko_KR&#93;  10.4.0.0 alpha - (???)  : &#91;pl&#93;  10.4.0.0 alpha - (???)  : &#91;pt_BR&#93;  10.4.0.0 alpha - (???)  : &#91;ru&#93;  10.4.0.0 alpha - (???)  : &#91;zh_CN&#93;  10.4.0.0 alpha - (???)  : &#91;zh_TW&#93;  10.4.0.0 alpha - (???)------------------------------------------------------How to reproduce the bug:1. Create a table with name 'indicator' (or any other SQL keyword as the name  i.e. 'select') and one field of any type  for instance CHAR(1)  like this:CREATE TABLE /'indicator/'(c CHAR(1) DEFAULT 'N')2. Add constraint to the field:ALTER TABLE /' indicator /' ADD CONSTRAINT /'MY_CONSTRAINT/' CHECK ((c IN ('Y' 'N')))3. Try to insert any row to that table:INSERT INTO /'indicator/' VALUES ('N')The INSERT statement will throw an exception:java.sql.SQLException: Java exception: ': java.util.EmptyStackException'.Also  see the program (Main.java) attached to this issue and derby.log contained the exception's stacktace output.I've also created and attached the patch that may fix this issue. Hope this help to improve Derby.", "id": "2989"}, "2991": {"ground_truth": "1", "bug_report": "Index split deadlock\nAfter doing dome research on the mailing list  it appears that the index split deadlock is a known behaviour  so I will start by describing the theoretical problem first and then follow with the details of my test case.If you have concurrent select and insert transactions on the same table  the observed locking behaviour is as follows: the select transaction acquires an S lock on the root block of the index and then waits for an S lock on some uncommitted row of the insert transaction the insert transaction acquires X locks on the inserted records and if it needs to do an index split creates a sub-transaction that tries to acquire an X lock on the root block of the indexIn summary: INDEX LOCK followed by ROW LOCK + ROW LOCK followed by INDEX LOCK = deadlockIn the case of my project this is an important issue (lack of concurrency after being forced to use table level locking) and I would like to contribute to the project and fix this issue (if possible). I was wondering if someone that knows the code can give me a few pointers on the implications of this issue: Is this a limitation of the top-down algorithm used? Would fixing it require to use a bottom up algorithm for better concurrency (which is certainly non trivial)? Trying to break the circular locking above  I would first question why does the select transaction need to acquire (and hold) a lock on the root block of the index. Would it be possible to ensure the consistency of the select without locking the index?The attached test (InsertSelectDeadlock.java) tries to simulate a typical data collection application  it consists of:  an insert thread that inserts records in batch a select thread that 'processes' the records inserted by the other thread: 'select * from table where id &gt; ?'The derby log provides detail about the deadlock trace and stacktraces_during_deadlock.txt shows that the inser thread is doing an index split.The test was run on 10.2.2.0 and 10.3.1.4 with identical behaviour.Thanks Bogdan Calmac.", "id": "2991"}, "2992": {"ground_truth": "0", "bug_report": "getBinaryStream returns incorrect result (truncated value) if underlying blob is deleted\nIf getBinaryStream is reading a value (READ_UNCOMMITTED) and the row is deleted by another connection  a truncated value will be returned without error. I believe instead either the whole value or an IOException should occur.With 10.2 and higher with the repro attahed we get:&gt; java TruncatedBlobEmbedded:Read 32669 bytes0 rows in BLOBCLOBWith 10.1Embedded:Read 40000 bytes (OK)0 rows in BLOBCLOB Note network server returns the full value for both 10.1 and 10.2 but gives a lock timeout for 10.2+. I will file a separate issue for that.", "id": "2992"}, "2996": {"ground_truth": "0", "bug_report": "iepnegativetests_ES.diff fails with J2ME Foundation\nDiff file derbyall/i18nTest/iepnegativetests_ES.diff             Start: iepnegativetests_ES jdkJ2ME Foundation Specification v1.1 derbyall:i18nTest 2007-08-03 01:28:49 ***54a55 58&gt; ij&gt; --export table is null&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  null  'extinout/t1.dat'  &gt; null  null  null) ;&gt; ERROR XIE06: Nombre de entidad nulo.64a69 72&gt; ij&gt; --export query is null &gt; call SYSCS_UTIL.SYSCS_EXPORT_QUERY(null &gt; 'extinout/t1.dat'   null  null  null) ;&gt; ERROR XIE06: Nombre de entidad nulo.70 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('XXXX'  'T1'   'extinout/t1.dat'   70a78&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('XXXX'  'T1'   'extinout/t2.dat'   76 del&lt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   76a84&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   79 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   79a87&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   83 del&lt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   83a91&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   87 del&lt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   87a95&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   90 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   90a98&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   95 del&lt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   95a103&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   98 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   98a106&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   104 del&lt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   104a112&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   110 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   110a118&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   115 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE('IEP'  'T1'   'extinout/t1.dat'   115a123&gt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE('IEP'  'T1'   'extinout/t2.dat'   131 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE('IEP'  'T1'   'extin/nodir/t1.dat'   131a139&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE('IEP'  'T1'   'extin/nodir/t2.dat'   136 del&lt; ERROR XIE04: Archivo de datos no encontrado: extin/nodir/t1.dat136a144&gt; ERROR XIE04: Archivo de datos no encontrado: extin/nodir/t2.dat138 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'NOTABLE'   'extinout/t1.dat'   138a146&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'NOTABLE'   'extinout/t2.dat'   142 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('XXXX'  'T1'   'extinout/t1.dat'   142a150&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('XXXX'  'T1'   'extinout/t2.dat'   145 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   145a153&gt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   154 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   154a162&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   160 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   160a168&gt; ij&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   167 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t1.dat'   167a175&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('IEP'  'T1'   'extinout/t2.dat'   288 del&lt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T3'   'extinout/t3.dat'   288a296&gt; ij&gt; call SYSCS_UTIL.SYSCS_EXPORT_TABLE ('IEP'  'T3'   'extinout/t3_1.dat'   293 del&lt; 'extinout/t3.dat'   293a301&gt; 'extinout/t3_1.dat'   297 del&lt; 'extinout/t3.dat'   297a305&gt; 'extinout/t3_1.dat'   302 del&lt; 'extinout/t3.dat'   302a310&gt; 'extinout/t3_1.dat'   307 del&lt; 'extinout/t3.dat'   307a315&gt; 'extinout/t3_1.dat'   313 del&lt; 'extinout/t3.dat'   313a321&gt; 'extinout/t3_1.dat'   317 del&lt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('SYS'  'SYSTABLES'   'extinout/t3.dat'   317a325&gt; call SYSCS_UTIL.SYSCS_IMPORT_TABLE ('SYS'  'SYSTABLES'   'extinout/t3_1.dat'   Test Failed. End: iepnegativetests_ES jdkJ2ME Foundation Specification v1.1 derbyall:i18nTest 2007-08-03 01:29:03 ***", "id": "2996"}, "2999": {"ground_truth": "0", "bug_report": "convert lang/lockTable.sql to Junit\nconvert lang/lockTable.sql to Junit", "id": "2999"}, "3027": {"ground_truth": "0", "bug_report": "CollationTest fails with 'Unexpected row count: expected: but was:' when Xalan 2.7 jars are in classpath\nWhen I have the Xalan jars in the classpath  testEnglishCollation()  testNorwayCollation() and testPolishCollation() fail with this stack trace:1) testEnglishCollation(org.apache.derbyTesting.functionTests.tests.lang.CollationTest)junit.framework.AssertionFailedError: Unexpected row count: expected:&lt;0&gt; but was:&lt;1&gt; at org.apache.derbyTesting.junit.JDBC.assertDrainResults(JDBC.java:540) at org.apache.derbyTesting.junit.JDBC.assertEmpty(JDBC.java:468) at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.checkLangBasedQuery(CollationTest.java:1129) at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.commonTestingForTerritoryBasedDB(CollationTest.java:1056) at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.testEnglishCollation(CollationTest.java:512) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)If I remove the Xalan jars from the classpath  the test runs cleanly.", "id": "3027"}, "3032": {"ground_truth": "0", "bug_report": "java.lang.ClassCastException returning null from a case statement  in subquery\nThe following query returning NULL date from a case statement in a subquery causees a ClassCastException in 10.3.The query works fine in 10.2ij&gt; create table t (d date  vc varchar(30));0 rows inserted/updated/deletedij&gt; insert into t values(CURRENT_DATE  'hello');1 row inserted/updated/deletedij&gt; SELECT d from t where d = (SELECT CASE WHEN 1 = 1 THEN CURRENT_DATE ELSE NULL END from t);D----------2007-08-281 row selectedij&gt; SELECT d from t where d = (SELECT CASE WHEN 1 = 0 THEN CURRENT_DATE ELSE NULL END from t);D----------ERROR 38000: The exception 'java.lang.ClassCastException: org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue' was thrown while evaluating an expression.java.sql.SQLException: The exception 'java.lang.ClassCastException: org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue' was thrown while evaluating an expression. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:224) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:398) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1572) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4323) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:464) at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:368) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:382) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:338) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:241) at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:229) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:449) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:523) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:364) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:262) at org.apache.derby.impl.tools.ij.Main.go(Main.java:215) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:56) at org.apache.derby.tools.ij.main(ij.java:71)Caused by: java.sql.SQLException: Java exception: 'org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue: java.lang.ClassCastException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:245) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) ... 19 moreCaused by: java.lang.ClassCastException: org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue at org.apache.derby.exe.ac12564092x0114xaec2x9627x0000002183d82.g0(Unknown Source) at org.apache.derby.exe.ac12564092x0114xaec2x9627x0000002183d82.e1(Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:141) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(ProjectRestrictResultSet.java:267) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:468) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:424) ... 13 moreERROR XJ001: Java exception: 'org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue: java.lang.ClassCastException'.java.sql.SQLException: Java exception: 'org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue: java.lang.ClassCastException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:245) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:398) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1572) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4323) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:464) at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:368) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:382) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:338) at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:241) at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:229) at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:449) at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:523) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:364) at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:262) at org.apache.derby.impl.tools.ij.Main.go(Main.java:215) at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181) at org.apache.derby.impl.tools.ij.Main14.main(Main14.java:56) at org.apache.derby.tools.ij.main(ij.java:71)Caused by: java.lang.ClassCastException: org.apache.derby.iapi.types.SQLChar incompatible with org.apache.derby.iapi.types.DateTimeDataValue at org.apache.derby.exe.ac12564092x0114xaec2x9627x0000002183d82.g0(Unknown Source) at org.apache.derby.exe.ac12564092x0114xaec2x9627x0000002183d82.e1(Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:141) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(ProjectRestrictResultSet.java:267) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:468) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:424) ... 13 more", "id": "3032"}, "3033": {"ground_truth": "1", "bug_report": "select query results in nullpointer exception in skipScan()\nThe following error was repeatedly thrown when we tried to run a select query via JDBC. Strangely  the exact same select query did not trigger any error when run from the command line console. After we added an index  the error went away completely. java.lang.NullPointerException at org.apache.derby.impl.sql.execute.NoPutResultSetImpl.skipScan(Unknown Source) at org.apache.derby.impl.sql.execute.TableScanResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.IndexRowToBaseRowResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.JoinResultSet.openRight(Unknown Source) at org.apache.derby.impl.sql.execute.JoinResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.drda.DRDAStatement.execute(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)", "id": "3033"}, "3043": {"ground_truth": "0", "bug_report": "'Schema  does not exist' when constraint used in table definition\nhttps://issues.apache.org/jira/browse/DERBY-568#action_12524420In the response to my original comment post  which you can find via the permalink above  I was encouraged to file this as a new issue.verified this back to 10.1.2.1 with the following ij script.connect 'jdbc:derby:wombat;create=true;user=blogs';CREATE TABLE BLOGSCOM_BLOGSUSERS(PK INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY username VARCHAR(16) NOT NULL CONSTRAINT BLOGSCOMBLOGSUSERS_UNIQUE_username UNIQUE CONSTRAINT BLOGSCOMBLOGS_USERS_PASSWORD_username CHECK(LENGTH(username)&gt;7) password VARCHAR (32672) NOT NULL   PRIMARY KEY(PK));", "id": "3043"}, "3054": {"ground_truth": "0", "bug_report": "lang/synonym.sql fails with weme 6.1 with junit.framework.ComparisonFailure: Output at line 383 expected: but was:\nsynonym(org.apache.derbyTesting.functionTests.tests.lang.LangScripts) failed:junit.framework.ComparisonFailure: Output at line 383 expected:&lt;...1...&gt; but was:&lt;...2...&gt; at junit.framework.Assert.assertEquals(Assert.java:81) at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:100) at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:124) at junit.framework.TestCase.runBare(TestCase.java:127) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.framework.TestResult$1.protect(TestResult.java:106) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.framework.TestResult.run(TestResult.java:109) at junit.framework.TestCase.run(TestCase.java:118) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.framework.TestResult.runProtected(TestResult.java:124) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at junit.framework.TestSuite.runTest(TestSuite.java:208) at junit.framework.TestSuite.run(TestSuite.java:203) at TimeRunner.main(TimeRunner.java:31)", "id": "3054"}, "3068": {"ground_truth": "0", "bug_report": "testImportExportProcedureNegative(org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected: but was:\n1) testImportExportProcedureNegative(org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;38000&gt; but was:&lt;XIE0S&gt; at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:668) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:717) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:898) at org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest.testImportExportProcedureNegative(ImportExportProcedureTest.java:1933) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)Caused by: java.sql.SQLException: The export operation was not performed  because the specified output file (extinout/t1.dat) already exists. Export processing will not overwrite an existing file  even if the process has permissions to write to that file  due to security concerns  and to avoid accidental file damage. Please either change the output file name in the export procedure arguments to specify a file which does not exist  or delete the existing file  then retry the export operation. at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source) at org.apache.derby.client.am.PreparedStatement.execute(Unknown Source) at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:893) ... 45 moreCaused by: org.apache.derby.client.am.SqlException: The export operation was not performed  because the specified output file (extinout/t1.dat) already exists. Export processing will not overwrite an existing file  even if the process has permissions to write to that file  due to security concerns  and to avoid accidental file damage. Please either change the output file name in the export procedure arguments to specify a file which does not exist  or delete the existing file  then retry the export operation. at org.apache.derby.client.am.Statement.completeExecute(Unknown Source) at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source) at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source) at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source) at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source) at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source) at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source) at org.apache.derby.client.am.PreparedStatement.executeX(Unknown Source) ... 47 more", "id": "3068"}, "3069": {"ground_truth": "0", "bug_report": "Derby does not resolve functions bound to methods with varargs.\nVarargs were added in Java 5. It would be nice if Derby let you invoke a function bound to a method with a variable length argument list. The Reference Guide states a small number of restrictions for methods which can be invoked as Derby functions: They must be public  static  and not have arguments which are long datatypes. I see no reason that Derby shouldn't be able to resolve and invoke functions which are bound to methods which don't suffer these limitations but which have variable argument lists.", "id": "3069"}, "3077": {"ground_truth": "0", "bug_report": "Trying to reconnect with derby client after bringing server down throws SQL Exception 58009 rather than 08XXX exception\nThis issue was discussed in DERBY-401  because the case where the server is brought down and an application tries to reconnect does not throw a SQLNonTransientException. Discussion is still underway about whether 58XXX exceptions should be SQLNonTransientExceptions  but at least for this case changing the exception to 08006 per Knut's suggestion should correct the problem for this case. See https://issues.apache.org/jira/browse/DERBY-401#action_12527400Below is current stack and test case.Apache Derbygot connection now sleepnow try to use the connection after you killed the nSException in thread 'main' java.sql.SQLException: A communications error has been detected: Software caused connection abort: recv failed.at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)at org.apache.derby.client.am.Connection.prepareStatement(Unknown Source)at org.apache.derby.client.am.LogicalConnection.prepareStatement(Unknown Source)at DerbyClientNonXA.main(DerbyClientNonXA.java:48)Caused by: org.apache.derby.client.am.DisconnectException: A communications error has been detected: Software caused connection abort: recv failed.at org.apache.derby.client.net.NetAgent.throwCommunicationsFailure(Unknown Source)at org.apache.derby.client.net.Reply.fill(Unknown Source)at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Unknown Source)at org.apache.derby.client.net.Reply.readDssHeader(Unknown Source)at org.apache.derby.client.net.Reply.startSameIdChainParse(Unknown Source)at org.apache.derby.client.net.NetStatementReply.readPrepareDescribeOutput(Unknown Source)at org.apache.derby.client.net.StatementReply.readPrepareDescribeOutput(Unknown Source)at org.apache.derby.client.net.NetStatement.readPrepareDescribeOutput_(Unknown Source)at org.apache.derby.client.am.Statement.readPrepareDescribeOutput(Unknown Source)at org.apache.derby.client.am.PreparedStatement.readPrepareDescribeInputOutput(Unknown Source)at org.apache.derby.client.am.PreparedStatement.flowPrepareDescribeInputOutput(Unknown Source)at org.apache.derby.client.am.PreparedStatement.prepare(Unknown Source)at org.apache.derby.client.am.Connection.prepareStatementX(Unknown Source)... 3 moreCaused by: java.net.SocketException: Software caused connection abort: recv failedat java.net.SocketInputStream.read(SocketInputStream.java:129)... 15 moreimport java.sql.Connection;import java.sql.DatabaseMetaData;import java.sql.PreparedStatement;import java.sql.SQLException;import java.sql.Statement;import javax.sql.PooledConnection;public class DerbyClientNonXA{public static void main(String args[]) throws Exception{org.apache.derby.jdbc.ClientConnectionPoolDataSource40 ds = new org.apache.derby.jdbc.ClientConnectionPoolDataSource40();Connection conn = null;ds.setDatabaseName('e://temp//sampl127;create=true');PooledConnection pooledCon = ds.getPooledConnection();conn = pooledCon.getConnection();DatabaseMetaData md = conn.getMetaData();System.out.println(md.getDatabaseProductVersion());System.out.println(md.getDatabaseProductName());System.out.println('got connection now sleep. Bring down network server.');Statement st = null;PreparedStatement ps1 = null;st = conn.createStatement();try{st.executeUpdate('drop table TAB1');}catch (SQLException x){System.out.println('no table exists');}Thread.sleep(15000);System.out.println('now try to use the connection after you killed the nS');ps1 = conn.prepareStatement('CREATE TABLE TAB1(COL1 INT NOT NULL)');ps1.executeUpdate();conn.commit();System.out.println('done');}}", "id": "3077"}, "3092": {"ground_truth": "0", "bug_report": "Use java.util.concurrent in TransactionTable to improve scalability\nRunning scalability tests with the client and buffer manager from DERBY-2911 shows that access to the TransactionTable.trans (a Hashtable) and XactFactory.tranId (a shared long) are the next major sources of contention.", "id": "3092"}, "3093": {"ground_truth": "0", "bug_report": "Intermittent transaction failure caused by internal duplicate savepoint name for triggers\nWhile running our app overnight  performing some intensive database operations (primarily deletes)  we experienced a transaction failure  with error message 'A SAVEPOINT with the passed name already exists in the current transaction'. This failure appears to be very intermittent  as I've run the same operation successfully for hours and hours without failure. Some more information:1. I see that there are four JIRA issues which report the same message (DERBY-2773  DERBY-1457  DERBY-2808  DERBY-2804). I am not sure to what extent if any  the problem I experienced is related to these issues. At least three of the above JIRA issues are related to triggers. Our transaction failure occurred while performing a delete in a table which has delete triggers. We aren't using savepoints explicitly. Of course  it can be seen in the stack trace that the trigger operation is setting a savepoint. One of the JIRA issues mentions exceeding maximum depth of nested triggers. Not sure what a nested trigger is  but the trigger we are performing should not (in theory) cause another trigger event.2. Here's the stack trace:Caused by: java.sql.SQLException: A SAVEPOINT with the passed name already exists in the current transaction. at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(Unknown Source) at com.referentia.sdf.monitor.samplebase.derby.DerbySampleBase$3.perform(DerbySampleBase.java:682) at com.referentia.sdf.monitor.samplebase.derby.DerbySampleBase.performInTransaction(DerbySampleBase.java:2747) ... 7 moreCaused by: java.sql.SQLException: A SAVEPOINT with the passed name already exists in the current transaction. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source) ... 18 moreCaused by: ERROR 3B501: A SAVEPOINT with the passed name already exists in the current transaction. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.store.raw.xact.Xact.setSavePoint(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.setSavePoint(Unknown Source) at org.apache.derby.impl.sql.conn.GenericStatementContext.setSavePoint(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(Unknown Source) at org.apache.derby.impl.sql.execute.RowTriggerExecutor.fireTrigger(Unknown Source) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(Unknown Source) at org.apache.derby.impl.sql.execute.DeleteResultSet.fireAfterTriggers(Unknown Source) at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) ... 12 more3. Here are the relevant tables and triggers. We have different tables for different 'sample' data types in our application (currently int  long  float  double  Boolean  string). I have shown the int_sample table; the other tables are identical but have a different data type for the value field. Sample records are first class; time records are second class - they only exist to support sample records. When there are no remaining sample records for a given time record  the time record can be removed. It is the job of the trigger to perform this cleanup: when a record is deleted from any of the sample tables  the time record corresponding to *_sample.fk_time_id is deleted only if there are no remaining records in any of the sample tables which have the same fk_time_id. So although there are cascading deletes (deleting a time record deletes all of its samples)  the trigger should not recurse because the trigger only deletes when there are no associated records.create table time ( id int not null generated always as identity  time timestamp not null  constraint time_pk primary key (id)  constraint time_unique unique (time));create table int_sample ( fk_band_id int not null  fk_time_id int not null  value int not null  constraint int_sample_pk primary key (fk_band_id  fk_time_id)  constraint int_sample_fk_band foreign key (fk_band_id) references band (id) on delete cascade  constraint int_sample_fk_time foreign key (fk_time_id) references time (id) on delete cascade);create trigger cascade_delete_unused_time_for_int_sample_trigger after delete on int_sample referencing old as oldrow for each row delete from time where  time.id = oldrow.fk_time_id and id not in (select fk_time_id from int_sample)  and id not in (select fk_time_id from long_sample)  and id not in (select fk_time_id from float_sample)  and id not in (select fk_time_id from double_sample)  and id not in (select fk_time_id from boolean_sample)  and id not in (select fk_time_id from string_sample);4. Invocation. This is very rough pseudocode focusing on the core logic. In reality  there's a lot more code  but I'm doing the usual stuff  such as using prepared statements  and closing all resources when done. The key thing is that I'm using two statements in a nested fashion; in the outer statement  I iterate over records in the time table  and in the inner loop I use a second statement to delete records in one of the sample tables. I can provide the actual code if desired.deleteSamples(int bandId  String sampleTable  Object someQueryCriteria) { within transaction { create stmt1 iterating over time ids in time table (restricted by someQueryCriteria) for (time_id in stmt1) { PreparedStatement stmt2 = conn.prepareStatement(String.format( 'delete from %s where fk_band_id = ? and fk_time_id = ?'  sampleTable)); set stmt2 parameters and executeUpdate() } }}", "id": "3093"}, "3098": {"ground_truth": "0", "bug_report": "LOB locks are not released after free().\nWhen getBlob/getClob is called on the ResultSet  the current row islocked if the JDBC driver does not cache the entire LOB value inmemory. This is done to prevent the Blob/Clob object from beingchanged. Until now  this lock has been held to the end of thetransaction.JDBC4 introduced free() methods for the Blob/Clob class. The lockingshould be changed so that the locks is releases when the Blob/Clobobject is freed.", "id": "3098"}, "3100": {"ground_truth": "0", "bug_report": "java.lang.NumberFormatException in test lang.TableFunctionTest on specific machines (Win2003  Vista)\nThis failure is gleaned from the nightly tests posted to the list. The test started failing on September 13.The stack is:1) testTableFunctions(org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest)java.lang.NumberFormatException: For input string: '13 00' at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:1224) at java.lang.Double.parseDouble(Double.java:510) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.readDoubleTag(TableFunctionTest.java:1647) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.vtiCosting(TableFunctionTest.java:1124) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.testTableFunctions(TableFunctionTest.java:797) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)", "id": "3100"}, "3107": {"ground_truth": "0", "bug_report": "On client  Clob.free() does not release locators.\nOn client  Clob.free() does not call the stored procedure to release the locator associated with the Clob. Hence  server-side Clob objects are not freed until the transaction terminates.", "id": "3107"}, "3116": {"ground_truth": "0", "bug_report": "totalSpace not properly initialized in AllocPage\nThere are some problems with the initialization of totalSpace in AllocPage. It is initialized in StoredPage.initSpace() which is again called from StoredPage.usePageBuffer()  and it is set to the value returned from AllocPage.getMaxFreeSpace(). The problems are: 1) The calculation in getMaxFreeSpace() uses borrowedSpace  but when createIdentity() is called on an AllocPage  borrowedSpace has not been initialized when getMaxFreeSpace() is called and the calculated size is wrong. 2) When a page object is reused  usePageBuffer() is only called if a new byte array must be allocated (because the new page has a different size than the old page). This means that the totalSize field gets the same value as in the old page if their sizes are equal  which is not necessarily correct.", "id": "3116"}, "3117": {"ground_truth": "0", "bug_report": "Adjust master build script to require the Java 5 compiler to build Derby\nRequire the Java 5 compiler in order to build Derby as approved by the community recently: http://www.nabble.com/-VOTE--Require-Java-5-%28or-later%29-compiler-to-build-Derby-tf4522491.html#a13030783", "id": "3117"}, "3136": {"ground_truth": "0", "bug_report": "Cut down on object creations in LIKE clause implementation of territory based characters.\nThe LIKE clause for territory based characters was implemented correctly based on SQL standards in DERBY-2967 but the object (String and CollationElementIterator) creations introduced in DERBY-2967 can be cut down by following Knut's simple solution. I am copying that solution from DERBY-2967. We should implement that solution to improve the performance of LIKE for territory based characters.*********copied from DERBY-2967*********************************************************Another simple way to cut down the string allocations... I think you could express iapi.types.Like:checkEquality() like this:  if (val&#91;vLoc&#93; == pat&#91;pLoc&#93;) { // same character  so two strings consisting of this // single character must be equal regardless of territory return true; } else if (collator == null) { // not same character  must be unequal in UCS_BASIC return false; }  String s1 = new String(val  vLoc  1);  String s1 = new String(pat  pLoc  1);  return collator.compare(s1  s2) == 0; This would only allocate new objects if the characters are not equal.", "id": "3136"}, "3145": {"ground_truth": "0", "bug_report": "ComparisonFailure in synonym(org.apache.derbyTesting.functionTests.tests.lang.LangScripts)\nSince r587553 'synonym(org.apache.derbyTesting.functionTests.tests.lang.LangScripts)' has failed with 'junit.framework.ComparisonFailure: Output at line 18 expected:&lt;[]&gt; but was:&lt;&#91;-- When we decide to convert this test to junit test  the converted tests can &#93;&gt;'&lt;method&gt;org.apache.derbyTesting.functionTests.tests.lang.LangScripts&lt;/method&gt;&lt;signature&gt;Output at line 18 expected:&lt;[]&gt; but was:&lt;&#91;-- When we decide to convert this test to junit test  the converted tests can &#93;&gt;&lt;/signature&gt;", "id": "3145"}, "3148": {"ground_truth": "0", "bug_report": "IllegalArgumentException: Malformed /uxxxx encoding while trying to find Xalan version running tests via ant\nFollowing stack trace after executing:ant -propertyfile ant.properties junit-all-codeline-jars &#91;junit&#93; Unexpected exception while trying to find Xalan version: &#91;junit&#93; java.lang.IllegalArgumentException: Malformed /uxxxx encoding. &#91;junit&#93; at java.util.Properties.loadConvert(Properties.java:531) &#91;junit&#93; at java.util.Properties.load(Properties.java:370) &#91;junit&#93; at org.apache.derbyTesting.junit.XML.checkXalanVersion(XML.java:329) &#91;junit&#93; at org.apache.derbyTesting.junit.XML.&lt;clinit&gt;(XML.java:116)", "id": "3148"}, "3151": {"ground_truth": "0", "bug_report": "Reduce dependency on NetworkServerControl in TestConfiguration\nCode has been added in TestConfiguration to allow for starting and stopping a Derby network server.Even if you know will not need this functionality  or you simply don't want to have this functionality available  you must include derbynet.jar (or point to classes/).I think this dependency should be reduced  by not having any instance variables and by not importing the class with an explicit import statement. The existing instance variables are not used.With this planned change  you can run tests without including derbynet.jar on the classpath  as long as they don't call 'startNetworkServer' or 'stopNetworkServer'. Most often these methods will be called by a decorator.The downside of this change  is that you won't get any error messages before the mentioned methods are actually executed.A typical error message:Failed to invoke suite():java.lang.NoClassDefFoundError: org/apache/derby/drda/NetworkServerControlI'm sure there are other solutions as well  but this one is really easy.Any opinions on this change?", "id": "3151"}, "3153": {"ground_truth": "1", "bug_report": "AccessControlException when running junit tests under the ant harness in ant 1.7.0\nThe following AccessControlException occurs on junit tests run under the ant harness if the ant version is 1.7.0: &#91;junit&#93; Running org.apache.derbyTesting.functionTests.tests.jdbcapi.AutoloadTest &#91;junit&#93; Tests run: 3  Failures: 0  Errors: 1  Time elapsed: 1.029 sec &#91;junit&#93; Exception in thread 'main' java.security.AccessControlException: access denied (java.io.FilePermission /Users/rh161140/derby/mainline/trunk/junitvmwatcher520156310.properties write) &#91;junit&#93; at java.security.AccessControlContext.checkPermission(AccessControlContext.java:264) &#91;junit&#93; at java.security.AccessController.checkPermission(AccessController.java:427) &#91;junit&#93; at java.lang.SecurityManager.checkPermission(SecurityManager.java:532) &#91;junit&#93; at java.lang.SecurityManager.checkWrite(SecurityManager.java:962) &#91;junit&#93; at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:169) &#91;junit&#93; at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:70) &#91;junit&#93; at java.io.FileWriter.&lt;init&gt;(FileWriter.java:46) &#91;junit&#93; at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.registerNonCrash(JUnitTestRunner.java:924) &#91;junit&#93; at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:772) &#91;junit&#93; Running org.apache.derbyTesting.functionTests.tests.jdbcapi.AutoloadTest &#91;junit&#93; Tests run: 1  Failures: 0  Errors: 1  Time elapsed: 0 secI haven't looked at the ant source  but here is my theory about what is going on:1) Ant 1.7.0 is trying to write a file to the directory where the ant script lives2) The write is not wrapped in a privileged block3) So all code domains above it on the stack need to be granted write permission on the directory where the ant script livesI will attach a modified version of derby_tests.policy which allows me to start up the tests without tripping across this security exception.", "id": "3153"}, "3160": {"ground_truth": "1", "bug_report": "SYSCS_GET_USER_ACCESS incorrectly treats the passed in user name as a SQL identifier and thus can reports the wrong user information\nVALUES SYSCS_GET_USER_ACCESS(CURRENT_USER) will report the wrong user information if the user name needs to be a delimited identifier when used in a SQL statement such as GRANT. E.g. user fred@derby.com  123 etc.Passing the user name as a VARCHAR also returns the wrong user for such user names.", "id": "3160"}, "3165": {"ground_truth": "0", "bug_report": "Updating Building.txt\nWe (Svein Erik Lvland and Henrik Holum) have updated the building.txt document for Derby Trunk. We built the code following every step of the document  and here are our suggested changes. A review of the changes would be appresiated.Removed the empty subsections  and updated the section and subsection numbers. We also updated the references according to the new subsection numbers.Removed 2.2.3 and 2.2.4Renamed 2.2.5 -&gt; 2.2.3  2.2.6 -&gt; 2.2.4 and 2.2.7 -&gt; 2.2.52.1Added 3 directories2.2.1 (1)Updated the text to indicate that any newer version than 1.6.3 can be used. Old text indicated that you could only use 1.6.x versions  not 1.7.2.2.2 (2) and (4) (Windows)Updated the URLs to point directly to download pages for the desired java versions2.2.3 (Previous 2.2.5)Can we use Junit 3.8.2 or does it have to be 3.8.1? if Junit 3.8.2 can be used the link can be replaced with http://kent.dl.sourceforge.net/sourceforge/junit/junit3.8.2.zip. Also update the text to indicate these changes (3.8.*)2.2.5 (Previous 2.2.7)Moved the Optional tag to be consistent with 2.2.4 (Previous 2.2.6) We updated references in the note to reflect the new subsection number.3.3 (3)Updated the number of jar files with local support to 13 instead of 9.We have used Windows XP  so we have not checked the *nix or Mac settings.Hope this is helpfull-Henrik and Svein Erik", "id": "3165"}, "3174": {"ground_truth": "1", "bug_report": "NetworkServerControlApiTest fails with java.security.AccessControlException if not run as first test\nThere appears to be a problem loading the test specific policy file for NetworkServerControlApiTest if it is not run as the first test in the suite.Failure in the derby.log is:Trace directory changed to C:/test/system.access denied (java.io.FilePermission C:/test/system/Server3.trace write)java.security.AccessControlException: access denied (java.io.FilePermission C:/test/system/Server3.trace write) at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323) at java.security.AccessController.checkPermission(AccessController.java:546) at java.lang.SecurityManager.checkPermission(SecurityManager.java:532) at java.lang.SecurityManager.checkWrite(SecurityManager.java:962) at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:169) at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:70) at java.io.FileWriter.&lt;init&gt;(FileWriter.java:46) at org.apache.derby.impl.drda.DssTrace$1.run(DssTrace.java:181) at java.security.AccessController.doPrivileged(Native Method) at org.apache.derby.impl.drda.DssTrace.startComBufferTrace(DssTrace.java:178) at org.apache.derby.impl.drda.Session.initTrace(Session.java:138) at org.apache.derby.impl.drda.Session.setTraceOn(Session.java:152) at org.apache.derby.impl.drda.NetworkServerControlImpl.setTrace(NetworkServerControlImpl.java:3372) at org.apache.derby.impl.drda.NetworkServerControlImpl.processCommands(NetworkServerControlImpl.java:1422) at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(DRDAConnThread.java:630) at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:264)", "id": "3174"}, "3175": {"ground_truth": "1", "bug_report": "NullPointerException on INSERT after ALTER TABLE ... DROP COLUMN\nij version 10.3ij&gt; connect 'jdbc:derby:bugdb;create=true';ij&gt; create table t ( x varchar(12)  y varchar(12)  id int primary key generated by default as identity);0 rows inserted/updated/deletedij&gt; alter table t drop column y;0 rows inserted/updated/deletedij&gt; insert into t values 'a';ERROR XJ001: Java exception: ': java.lang.NullPointerException'.java.sql.SQLException: Java exception: ': java.lang.NullPointerException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source) at org.apache.derby.iapi.tools.run.main(Unknown Source)Caused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source) ... 18 moreCaused by: java.lang.NullPointerException at org.apache.derby.impl.sql.compile.ResultColumn.columnTypeAndLengthMatch(Unknown Source) at org.apache.derby.impl.sql.compile.ResultColumnList.columnTypesAndLengthsMatch(Unknown Source) at org.apache.derby.impl.sql.compile.InsertNode.bindStatement(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ... 11 more", "id": "3175"}, "3178": {"ground_truth": "0", "bug_report": "DataSourceTest uses ConnectionEventListener but never verifies that events are getting fired\nDerby has a junit test called DataSourceTest in jdbcapi package. This test registers ConnectionEventListener for various Connection objects but never verifies that events from those Connection objects are getting delivered to the listeners. Prior to this test's conversion to junit  there were System.out.println in the test but since this test is not cannon based anymore  those printlns have been commented out. I will soon submit a patch where this test will have asserts to make sure that Connection events are getting fired.", "id": "3178"}, "3190": {"ground_truth": "0", "bug_report": "New simple demo suitable for supported Java ME platforms\nDERBY-2216 added J2ME (Java ME) support in the simple demo (SimpleApp)  but broke the basic client functionality of the demo (at least in some VMs). Since DERBY-3187 fixes this by removing Java ME support from SimpleApp  a separate simple demo for Java ME should be included along with the other demos available in Derby distributions.Currently supported Java ME platforms are Java ME Virtual Machines with Connected Device Configuration (CDC) support and the Foundation Profile 1.1 or better  with the optional package for JDBC (JSR-169).The new demo should be easy to use and understand  and should be well commented. The demo code should demonstrate how to create and connect to a Derby database in a valid Java ME environment  and perform some basic database operations (insert  update  query). A readme file describing the demo (and instructions for building and running it) should be included.", "id": "3190"}, "3194": {"ground_truth": "0", "bug_report": "LOCALIZEDDISPLAY of CURRENT_TIMESTAMP returns only the TIME\nIn IJ - LOCALIZEDDISPLAY ON causes VALUES CURRENT_TIMESTAMP to display on the TIMEij&gt; values current_timestamp;1--------------------------2007-11-09 10:37:58.8281 row selectedij&gt; localizeddisplay on;ij&gt; values current_timestamp;1---------------10:38:10 AM PST1 row selected", "id": "3194"}, "3198": {"ground_truth": "0", "bug_report": "Using setQueryTimeout will leak sections\nThe implementation of setQueryTimeout relies on NetStatementReply.writeSetSpecialRegister() which will allocate a dynamic section when called. No reference to this Section object is kept  and so Section.free() never gets called on it. Executing the same statment repeatedly with a query timeout set results in the client driver throwing an exception because the number of Sections exceeding 32000.", "id": "3198"}, "3202": {"ground_truth": "1", "bug_report": "'AccessControlException: access denied (java.io.FilePermission C:/..../file-2.log read)' in ErrorStreamTest.\nSeen on Windows only.See e.g. http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/Limited/testSummary-594211.html : vista  w2003.suitesAll fail *************************************************************1) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/file-2.log read)2) testWrongFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/foo/file-3.log read)3) testFileOverMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/file-8.log read)4) testFileOverField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/file-9.log read)5) testFileOverMethodAndField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/file-10.log read)1) testDefault(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: File C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/derby.log could not be deleted2) testMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: assertNotEmpty failed:C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/method-4.logsuitesAll fail *************************************************************1) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:/cludev/jagtmp/autoderbyN_regression/suitesAll_30/log/system/file-2.log read) at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323) at java.security.AccessController.checkPermission(AccessController.java:546) at java.lang.SecurityManager.checkPermission(SecurityManager.java:532) at java.lang.SecurityManager.checkRead(SecurityManager.java:871) at java.io.File.exists(File.java:731) at java.io.Win32FileSystem.canonicalize(Win32FileSystem.java:402) at java.io.File.getCanonicalPath(File.java:559) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFile(ErrorStreamTest.java:140) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)++", "id": "3202"}, "3214": {"ground_truth": "0", "bug_report": "Optimizer can see negative cost estimates when pulling Optimizables from the join order.\nWhen iterating through join order permutations for a query the optimizer places 'Optimizables' (FromTables) into a join order  estimates the cost  then 'pulls' Optimizables out of the join order and re-places them in different positions. For details see: http://wiki.apache.org/db-derby/JoinOrderPermutationsAs optimizables are added to the join order the optimizer keeps track of the accumulated cost estimate for the join order. Then when an Optimizable is removed ('pulled') from the join order  the optimizer substracts that Optimizable's cost from the total accumulated cost.In certain cases (esp. with very large queries) it's possible that the cost for some Optimizable OPT_A is so large that adding it to the accumulated cost of the join order leads to loss of the previous sum. This happens due to normal Java addition of double values  see 'doubleAdd.java' attached.As an example  assume our current join order is: { OPT_0  OPT_1  -- }and that the estimated costs for OPT_0 and OPT_1 are 700 and 800  respectively. The accumulated cost for OPT_0 and OPT_1 is then 700 + 800 = 1500. Then assume we place OPT_A into the final position in the join order: { OPT_0  OPT_1  OPT_A }If the cost of OPT_A is something that is orders of magnitude larger than 1500  then by adding it to 1500 we will effectively 'lose' the 1500. Let's say the cost of OPT_A is estimated to be 3.14E50 (which is actually possible  esp. as a result of DERBY-1905). The size of OPT_A's cost makes the cost of OPT_0 + OPT_1 insignificant when using Java doubles (see attached doubleAdd.java): 1500 + 3.14E50 = 3.14E50So the total accumulated cost for the join order is now 3.14E50. Later  when we go to pull OPT_A from the join order  we'll subtract its cost from the accumulated cost  yielding: 3.14E50 - 3.14E50 = 0Notice how the accumulated cost  which is supposed to represent the cost of OPT_0 plus the cost of OPT_1  is now ZERO. And our join order goes back to: { OPT_0  OPT_1  -- }Next we pull OPT_1 from the join order  which means we have to subtract it's cost from the accumulated cost: 0 - 800 = -800So we end up with a negative accumulated cost  which is WRONG. (Actually  the ZERO accumulated cost in the previous step was wrong; this is just a side effect).As it turns out  there is code in OptimizerImpl that tries to account for negative costs when the negative value comes from normal imprecise arithmetic. In particular we see the following in the code that pulls Optimizables: double newCost = currentCost.getEstimatedCost(); if (pullCostEstimate != null) { pullCost = pullCostEstimate.getEstimatedCost(); newCost -= pullCost; /* ** It's possible for newCost to go negative here due to ** loss of precision. */ if (newCost &lt; 0.0) newCost = 0.0; ... }This code hides the error mentioned above because when it sees '-800' it assumes that the negative stems from normal loss of precision. So the cost for the plan is incorrectly set to '0'  which makes it cheaper than any other plan thus far (and probably cheaper than anything to come)  and therefore the optimizer will probably choose the wrong plan.I think the check for negative newCost is only valid if the join position that we're pulling is 0-i.e. if we just pulled the first optimizable in the join order. In that case the accumulated cost should be zero  so checking for a negative value and setting it to zero is fine-we're just accounting for the loss of precision that is mentioned in the current code comments.Note that the same issue also exists for 'sort avoidance costs'  but in that code there is (currently) no check for negative costs. So if a situation as described above occurs in the current code when the cost of OPT_A is for a sort avoidance plan  the code will throw an ASSERTION failure because the cost should be non-negative.I noticed this behavior somewhat accidentally while testing out a fix for DERBY-3023: with my attempted fix applied  the query 'new-style-sql.txt' was failing with an ASSERTION failure due to the negative cost estimate. Hence this jira.", "id": "3214"}, "3217": {"ground_truth": "0", "bug_report": "ErrorStreamTest failing on ibm j9 jvm\nGetting the following junit tests failures on just on the j9 jvm platform running on windows:There were 11 failures:1) testDefault(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testDefault(ErrorStreamTest.java:128) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)2) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFile(ErrorStreamTest.java:141) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)3) testWrongFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testWrongFile(ErrorStreamTest.java:160) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)4) testMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testMethod(ErrorStreamTest.java:179) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)5) testWrongMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testWrongMethod(ErrorStreamTest.java:198) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)6) testField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testField(ErrorStreamTest.java:217) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)7) testWrongField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testWrongField(ErrorStreamTest.java:236) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)8) testFileOverMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFileOverMethod(ErrorStreamTest.java:257) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)9) testFileOverField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFileOverField(ErrorStreamTest.java:278) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)10) testFileOverMethodAndField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFileOverMethodAndField(ErrorStreamTest.java:302) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)11) testMethodOverField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: shutdown engine not implemened at org.apache.derbyTesting.junit.DataSourceConnector.shutEngine(DataSourceConnector.java:130) at org.apache.derbyTesting.junit.TestConfiguration.shutdownEngine(TestConfiguration.java:1091) at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testMethodOverField(ErrorStreamTest.java:326) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at &lt;unknown class&gt;.&lt;unknown method&gt;(Unknown Source) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)", "id": "3217"}, "3219": {"ground_truth": "0", "bug_report": "Group by query with many aggregate columns and case statements fails with: ERROR XSDA7: Restore of a serializable or SQLData object of class   attempted to read more data than was originally stored\nusing the attached database (v10.3) - ' select * from pivotview ' fails with the stack trace below. A view (pivotview_ok) created on a subset of the columns in pivotview executes fine. Adding one column back into pivotview_ok causes failures most of the time. See attached for view definitions.2007-11-21 00:58:49.421 GMT Thread&#91;main 5 main&#93; (XID = 2734422)  (SESSIONID = 0)  (DATABASE = pivotview)  (DRDAID = null)  Failed Statement is: select * from pivotviewERROR XSDA7: Restore of a serializable or SQLData object of class   attempted to read more data than was originally stored at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source) at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source) at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)Caused by: java.io.EOFException at java.io.DataInputStream.readBoolean(DataInputStream.java:248) at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source) at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source) at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source) ... 22 more============= begin nested exception  level (1) ===========java.io.EOFException at java.io.DataInputStream.readBoolean(DataInputStream.java:248) at org.apache.derby.impl.sql.execute.MaxMinAggregator.readExternal(Unknown Source) at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source) at org.apache.derby.iapi.types.UserType.readExternal(Unknown Source) at org.apache.derby.impl.store.raw.data.StreamFileContainer.fetchNext(Unknown Source) at org.apache.derby.impl.store.raw.data.StreamFileContainerHandle.fetchNext(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeScan.mergeARow(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeScan.init(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeSort.openSortScan(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.openSortScan(Unknown Source) at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.GroupedAggregateResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)============= end nested exception  level (1) ===========Cleanup action completed", "id": "3219"}, "3221": {"ground_truth": "0", "bug_report": "'java.sql.SQLException: The conglomerate (-5) requested does not exist.' from Derby 10.3.1.4 embedded within Eclipse 3.3 and RAD 7.0\nWe are getting an SQLException when several prepared statement deletes are done upon an existing database. As far as we can tell this exception should never occur unless (evil) things like deleting the database or editing files occurs. This is using the embedded driver within a plug-in inside RAD 7.0 (and Eclipse 3.3).I'm not sure what else to submit that might be helpful.java.sql.SQLException: The conglomerate (-5) requested does not exist. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(Unknown Source) at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at com.surelogic.sierra.jdbc.LazyPreparedStatementConnection$LazyPreparedStatement.invoke(Unknown Source) at $Proxy1.execute(Unknown Source) at com.surelogic.sierra.jdbc.finding.FindingManager.delete(Unknown Source) at com.surelogic.sierra.jdbc.finding.ClientFindingManager.updateLocalFindings(Unknown Source) at com.surelogic.sierra.jdbc.project.ClientProjectManager.synchronizeProject(Unknown Source) at com.surelogic.sierra.client.eclipse.jobs.SynchronizeJob.synchronize(Unknown Source) at com.surelogic.sierra.client.eclipse.jobs.SynchronizeJob.run(Unknown Source) at org.eclipse.core.internal.jobs.Worker.run(Unknown Source)Caused by: ERROR XSAI2: The conglomerate (-5) requested does not exist. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.findExistingConglomerate(Unknown Source) at org.apache.derby.impl.store.access.RAMTransaction.openScan(Unknown Source) at org.apache.derby.impl.sql.execute.TemporaryRowHolderResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.TemporaryRowHolderResultSet.getNextRow(Unknown Source) at org.apache.derby.impl.sql.execute.IndexChanger.finish(Unknown Source) at org.apache.derby.impl.sql.execute.IndexSetChanger.finish(Unknown Source) at org.apache.derby.impl.sql.execute.RowChangerImpl.finish(Unknown Source) at org.apache.derby.impl.sql.execute.UpdateResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) ... 14 more", "id": "3221"}, "3222": {"ground_truth": "0", "bug_report": "'CollationTest' fails with ' expected: but was:' in testPolishCollation(CollationTest.java:402)\nSee http://dbtg.thresher.com/derby/test/10.3Branch/jvm1.6/testing/Limited/testSummary-597152.html : sol.There was 1 failure:1) testPolishCollation(org.apache.derbyTesting.functionTests.tests.lang.CollationTest)junit.framework.AssertionFailedError: expected:&lt;1&gt; but was:&lt;0&gt; at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.commonTestingForTerritoryBasedDB(CollationTest.java:1141) at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.testPolishCollation(CollationTest.java:402) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24) at junit.extensions.TestSetup$1.protect(TestSetup.java:21) at junit.extensions.TestSetup.run(TestSetup.java:25)", "id": "3222"}, "3229": {"ground_truth": "0", "bug_report": "testSysinfoLocale fails if derbyTools.jar is first in the classpath\n) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;false&gt; but was:&lt;true&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:209) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)3) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;false&gt; but was:&lt;true&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:209) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)4) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;true&gt; but was:&lt;false&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:204) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)5) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;true&gt; but was:&lt;false&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:204) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)6) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;false&gt; but was:&lt;true&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:209) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)7) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest)junit.framework.AssertionFailedError: expected:&lt;true&gt; but was:&lt;false&gt; at org.apache.derbyTesting.functionTests.tests.tools.SysinfoLocaleTest.testSysinfoLocale(SysinfoLocaleTest.java:204) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)", "id": "3229"}, "3230": {"ground_truth": "0", "bug_report": "Selecting data from a Table raises Error XN008: Query processing has been terminated due to an error on the server\nI got a table (PCLASS) in my database where I cannot select the data via a simple select statement: If I execute 'select * from PCLASS': XN008: Query processing has been terminated due to an error on the server If I execute 'select * from PCLASS order by CLASSNAME': it works If I add or remove only one row to/from the table: it worksIf I use the embedded driver everything works fine. But as soon as I use the derby network client to access the database  this problem occurs.This is very odd. I spent a lot of time to do some research on this behavior because I could not believe that the network client produces errors depending on the data contained in a table. But after all it looks like I managed to fill the table with an exact amount of data that causes this error to arise.To reproduce the problem download the attached file and follow these instructions: extract test.rar to $derby.system.home$ start derby network server start ji utility and execute the following commands:  connect to database test using client driver: connect 'jdbc:derby://localhost/test;user=ZOL;password=zol'; select content of table PCLASS select * from PCLASS;--&gt; Error XN008: Query processing has been terminated due to an error on the server      disconnect from database disconnect; shutdown database 'test' connect 'jdbc:derby://localhost/test;user=ZOL;password=zol;shutdown=true'; connect to database 'test' using embedded driver: connect 'jdbc:derby:test;user=ZOL;password=zol'; select content of table PCLASS select * from PCLASS;--&gt; everything o.k.", "id": "3230"}, "3244": {"ground_truth": "1", "bug_report": "NullPointerException in ....B2IRowLocking3.searchLeftAndLockPreviousKey\nThe last week(48) we have seen a large number of this failure.It was categorized as DERBY-2589 but these instances all have the NPE.Exception while trying to insert row number: 52ERROR XJ001: Java exception: ': java.lang.NullPointerException'.java.sql.SQLException: Java exception: ': java.lang.NullPointerException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source) at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(Unknown Source) at org.apache.derbyTesting.functionTests.tests.store.OnlineCompressTest.createAndLoadTable(OnlineCompressTest.java:140) at org.apache.derbyTesting.functionTests.tests.store.OnlineCompressTest.deleteAllRows(OnlineCompressTest.java:494) at org.apache.derbyTesting.functionTests.tests.store.OnlineCompressTest.test1(OnlineCompressTest.java:913) at org.apache.derbyTesting.functionTests.tests.store.OnlineCompressTest.testList(OnlineCompressTest.java:1500) at org.apache.derbyTesting.functionTests.tests.store.OnlineCompressTest.main(OnlineCompressTest.java:1520)Caused by: java.lang.NullPointerException at org.apache.derby.impl.store.access.btree.index.B2IRowLocking3.searchLeftAndLockPreviousKey(Unknown Source) at org.apache.derby.impl.store.access.btree.index.B2IRowLocking3.lockNonScanPreviousRow(Unknown Source) at org.apache.derby.impl.store.access.btree.BTreeController.doIns(Unknown Source) at org.apache.derby.impl.store.access.btree.BTreeController.insert(Unknown Source) at org.apache.derby.impl.store.access.btree.index.B2IController.insert(Unknown Source) at org.apache.derby.impl.sql.execute.IndexChanger.insertAndCheckDups(Unknown Source) at org.apache.derby.impl.sql.execute.IndexChanger.doInsert(Unknown Source) at org.apache.derby.impl.sql.execute.IndexChanger.insert(Unknown Source) at org.apache.derby.impl.sql.execute.IndexSetChanger.insert(Unknown Source) at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(Unknown Source) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(Unknown Source) at org.apache.derby.impl.sql.execute.InsertResultSet.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) ... 8 moreThe error statistics shows the occurrences:(http://dbtg.thresher.com/derby/test/stats_today.html / http://dbtg.thresher.com/derby/test/stats_newest.html )http://dbtg.thresher.com/derby/test/statistics/2589_48.html :JIRA: 2589  Week: 48 600335-598009598009 Daily jvm1.4 vista598009 Daily jvm1.6 lin598341 Daily jvm1.6 solN+1598341 Daily jvm1.6 sparc598354 10.3Branch jvm1.5 lin598376 trunk16 jvmAll JDK16Jvm1.5SunOS-5.10_i86pc-i386598692 Daily jvm1.6 sol598729 trunk16 jvmAll JDK16Jvm1.6SunOS-5.10_i86pc-i386599062 Daily jvm1.5 lin599088 trunk15 jvm1.5 SunOS-5.10_i86pc-i386599088 trunk15 jvm1.5 SunOS-5.10_sun4u-sparc599088 trunk16 jvmAll JDK16Jvm1.5SunOS-5.10_i86pc-i386600335 Daily jvm1.4 linMon Dec 3 09:36:11 CET 2007http://dbtg.thresher.com/derby/test/statistics/2589_47.html seems to be the first occurence:JIRA: 2589  Week: 47 597885-597885597885 Daily jvm1.6 linMon Dec 3 09:36:13 CET 2007All are seen on trunk except one on the 10.3 branch (598354 10.3Branch jvm1.5 lin).", "id": "3244"}, "3246": {"ground_truth": "0", "bug_report": "Minor cleanup in the Derby JUnit classes\nSeveral of the JUnit classes have grown/developed and need various types of cleanup; remove unused imports improve/add JavaDoc remove unused methods etc...This issue is basically a placeholder for the patches.", "id": "3246"}, "3253": {"ground_truth": "1", "bug_report": "NullPointer Exception (NPE) from query with IN predicate containing two values and joining a view with a large table.  ERROR 38000: The exception 'java.lang.NullPointerException' was thrown while evaluating an expression.\nWith a single value in the IN clause the query does not fail. &gt; Run the following query in the attached database (v 10.3 db). SELECT A.TIMESTAMP  B.F_NAMEADDR  B.TOTAL_F B.TOTAL_FS  B.TOTAL_FT  B.TOTAL_FXFROM TIME A  THE_VIEW BWHERE B.T_ID = A.T_ID AND B.F_NAMEADDR IN ('one.two.three.oscar' 'one.two.three.kathy')ORDER BY A.TIMESTAMP ASC;&gt; resultERROR 38000: The exception 'java.lang.NullPointerException' was thrown while evaluating an expression.ERROR XJ001: Java exception: ': java.lang.NullPointerException'.Stack trace: Failed Statement is: SELECT A.TIMESTAMP  B.F_NAMEADDR  B.TOTAL_F B.TOTAL_FS  B.TOTAL_FT  B.TOTAL_FXFROM TIME A  THE_VIEW BWHERE B.T_ID = A.T_ID AND B.F_NAMEADDR IN ('one.two.three.oscar' 'one.two.three.kathy')ORDER BY A.TIMESTAMP ASCERROR 38000: The exception 'java.lang.NullPointerException' was thrown while evaluating an expression. at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) at org.apache.derby.iapi.error.StandardException.unexpectedUserException(Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.NestedLoopJoinResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.getRowFromResultSet(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.getNextRowFromRS(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)Caused by: java.lang.NullPointerException at org.apache.derby.exe.ac601a400fx0116xa813xc2f7x00000010a3602.e8(Unknown Source) ... 21 more============= begin nested exception  level (1) ===========java.lang.NullPointerException at org.apache.derby.exe.ac601a400fx0116xa813xc2f7x00000010a3602.e8(Unknown Source) at org.apache.derby.impl.services.reflect.DirectCall.invoke(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.NestedLoopJoinResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.getRowFromResultSet(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.getNextRowFromRS(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source) at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.go(Unknown Source) at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source) at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source) at org.apache.derby.tools.ij.main(Unknown Source)============= end nested exception  level (1) ===========Schema info:CREATE TABLE TIME ('T_ID' BIGINT NOT NULL  'TIMESTAMP' TIMESTAMP NOT NULL  'DAY' INTEGER NOT NULL  'WEEK' INTEGER NOT NULL  'MONTH' INTEGER NOT NULL  'YEAR_COL' INTEGER NOT NULL);CREATE TABLE F ('F_ID' BIGINT NOT NULL  'T_ID' BIGINT NOT NULL  'F_NAMEADDR' VARCHAR(250) NOT NULL  'TOTAL_F' BIGINT NOT NULL  'TOTAL_FS' BIGINT NOT NULL  'TOTAL_FT' BIGINT NOT NULL  'TOTAL_FX' BIGINT NOT NULL);CREATE VIEW the_view AS SELECT T.T_ID AS T_ID   T.F_NAMEADDR AS F_NAMEADDR  T.TOTAL_F AS TOTAL_F  T.TOTAL_FS AS TOTAL_FS  T.TOTAL_FT AS TOTAL_FT   T.TOTAL_FX AS TOTAL_FX  FROM F AS T  WHERE T.T_ID = (SELECT MAX(T_ID) FROM F);", "id": "3253"}, "3260": {"ground_truth": "1", "bug_report": "NullPointerException caused by race condition in GenericActivationHolder\nI have a stress test using Derby 10.3.1.4 which is executing the same PreparedStatement using multiple threads concurrently and I consistently get the following NPE after several hours of running:2007-12-07 00:48:10.914 GMT Thread&#91;pool-5-thread-25 5 main&#93; (XID = 1219661)  (SESSIONID = 377)  (DATABASE = /usr/ironhide/var/db/opera/derby)  (DRDAID = null)  Failed Statement is: select rdbmsvaria0_.GUID_AND_INDEX as GUID1_3_0_  rdbmsvaria0_.VALUE2 as VALUE2_3_0_  rdbmsvaria0_.HOLDER_GUID as HOLDER3_3_0_  rdbmsvaria0_.VALUE_TYPE as VALUE4_3_0_  rdbmsvaria0_.VALUE_GUID as VALUE5_3_0_  rdbmsvaria0_.DELETED as DELETED3_0_ from VARIABLE rdbmsvaria0_ where rdbmsvaria0_.GUID_AND_INDEX=? with 1 parameters begin parameter #1: 9C202AB9E8356288A9320C9C383A4D2F-11 :end parameterjava.lang.NullPointerException at org.apache.derby.impl.sql.GenericActivationHolder.execute(GenericActivationHolder.java:271) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:368) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(EmbedPreparedStatement.java:275) at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186) at org.hibernate.loader.Loader.getResultSet(Loader.java:1787) at org.hibernate.loader.Loader.doQuery(Loader.java:674) at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236) at org.hibernate.loader.Loader.loadEntity(Loader.java:1860) at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:48) at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:42) at org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3044) at org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:395) at org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:375) at org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:139) at org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:179) at org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:103) at org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:878) at org.hibernate.impl.SessionImpl.get(SessionImpl.java:815) at org.hibernate.impl.SessionImpl.get(SessionImpl.java:808) at sun.reflect.GeneratedMethodAccessor69.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:301) at $Proxy41.get(Unknown Source) at com.approuter.maestro.opera.rdbms.RdbmsContextHolder.getRdbmsVariable(RdbmsContextHolder.java:108) at com.approuter.maestro.opera.rdbms.RdbmsContextHolder.getVariable(RdbmsContextHolder.java:94) at com.approuter.maestro.vm.Frame.getParameter(Frame.java:218) at com.approuter.maestro.vm.Task.getParameter(Task.java:1267) at com.approuter.maestro.vm.CallContextImpl.setOutputParameter(CallContextImpl.java:195) at com.approuter.maestro.vm.CallContextImpl.getOutputParameterWriter(CallContextImpl.java:264) at com.approuter.maestro.sdk.mpi.DynamicExecutableActivity$3$1.getWriter(DynamicExecutableActivity.java:249) at com.approuter.module.xml.XmlSerializeTextActivity$XmlSerializeTextActivityInstance.serialize(XmlSerializeTextActivity.java:43) at sun.reflect.GeneratedMethodAccessor161.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at com.approuter.maestro.sdk.mpi.DynamicExecutableActivity.execute(DynamicExecutableActivity.java:332) at com.approuter.maestro.activities.Invoke.call(Invoke.java:199) at sun.reflect.GeneratedMethodAccessor157.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at com.approuter.maestro.activities.Instruction.call(Instruction.java:22) at com.approuter.maestro.vm.Program.call(Program.java:456) at com.approuter.maestro.vm.Task.run(Task.java:580) at com.approuter.maestro.vm.Task.run(Task.java:531) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) at java.util.concurrent.FutureTask.run(FutureTask.java:138) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:98) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:207) at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907) at java.lang.Thread.run(Thread.java:619)Cleanup action completedHere is the relevant code from GenericActivationHolder.java // synchronized (ps) { /* Has the activation class changed? */ if (gc != ps.getActivationClass()) { // ensure the statement is valid by rePreparing it. ps.rePrepare(getLanguageConnectionContext()); // &lt;-- line 260 /*   If we get here  it means the PreparedStatement has been recompiled. Get a new Activation and check whether the parameters are compatible. If so  transfer the parameters from the old Activation to the new one  and make that the current Activation. If not  throw an exception. */ GeneratedClass newGC = ps.getActivationClass();   BaseActivation newAC = (BaseActivation) newGC.newInstance(lcc); // &lt;-- line 271 DataTypeDescriptor[] newParamTypes = ps.getParameterTypes();As you can see  the activation class returned by the ExecPreparedStatement is null as of line 271  even after having called a rePrepare(...) on the prepared statement (line 260). This is most likely due to a race condition. Also note that the containing block was formerly synchronized  but has since been commented out. From browsing the source in previous versions  the synchronized statement appears to have been commented out since before 10.0.2.1. It appears the fix is to reintroduce the synchronized block  or at least make the block inside the if statement synchronized.", "id": "3260"}, "3266": {"ground_truth": "1", "bug_report": "Not possible for non-db-owner to create a temporary table. 'Get ERROR 42507: User 'USERB' can not perform the operation in schema 'SESSION'.'\nIt seems that only the owner of a database may create tempoary tables in that db.This is not helpful as many other users may want to run a query on that db that relies upon the creation of temporary tables.I would expect non-db-owners to be able create temporay tables.The problem is demonstrated with:derby.properties like this:derby.connection.requireAuthentication=truederby.authentication.provider=BUILTINderby.database.sqlAuthorization=TRUEderby.user.usera=pwdderby.fullAccessUsers=useraderby.drda.host=192.168.1.50Start the network server and run up 'ij'.ij&gt;connect 'jdbc:derby://192.168.1.50:1527/TEST1;user=usera;password=pwd;create=true;';ij&gt; declare global temporary table t11(a int) on commit preserve rowsnot logged;0 rows inserted/updated/deletedAll good so far.Now try this (while still connected as usera):ij&gt; call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.user.userb' 'pwd');Statement executed.ij&gt; call SYSCS_UTIL.SYSCS_SET_USER_ACCESS('userb' 'FULLACCESS');Statement executed.ij&gt; disconnect;ij&gt; connect 'jdbc:derby://192.168.1.50:1527/TEST1;user=userb;password=pwd;';ij&gt; declare global temporary table t1(a int) on commit preserve rows not logged;ERROR 42507: User 'USERB' can not perform the operation in schema 'SESSION'.SYSINFO:========------------------ Java Information ------------------Java Version: 1.6.0_02-eaJava Vendor: Sun Microsystems Inc.Java home: /usr/java/jdk1.6.0_02/jreJava classpath: /home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derby.jar:/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbynet.jar:/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbytools.jar:/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbyclient.jar:/home/ajvok/derby/local/sp1.jarOS name: LinuxOS architecture: i386OS version: 2.6.17-5mdvJava user name: ajvokJava user home: /home/ajvokJava user dir: /home/ajvok/derby/localjava.specification.name: Java Platform API Specificationjava.specification.version: 1.6--------- Derby Information --------JRE - JDBC: Java SE 6 - JDBC 4.0&#91;/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derby.jar&#93; 10.3.1.4 - (561794)&#91;/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbytools.jar&#93; 10.3.1.4 - (561794)&#91;/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbynet.jar&#93; 10.3.1.4 - (561794)&#91;/home/ajvok/derby/db-derby-10.3.1.4-bin/lib/derbyclient.jar&#93; 10.3.1.4 - (561794)----------------------------------------------------------------------- Locale Information -----------------Current Locale : [English/United Kingdom &#91;en_GB&#93;]Found support for locale: &#91;cs&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;de_DE&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;es&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;fr&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;hu&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;it&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;ja_JP&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;ko_KR&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;pl&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;pt_BR&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;ru&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;zh_CN&#93; version: 10.3.1.4 - (561794)Found support for locale: &#91;zh_TW&#93; version: 10.3.1.4 - (561794)------------------------------------------------------", "id": "3266"}, "3270": {"ground_truth": "0", "bug_report": "Delayed (on-demand) creation of current user schema makes select from view belonging to other schema fail.\nThe enclosed repro fails with error 42Y07 'Schema BILL does not exist'  even thoughthe query does not reference that schema; it selects from joe.myview.", "id": "3270"}, "3279": {"ground_truth": "0", "bug_report": "Derby 10.3.X ignores ORDER BY DESC when target column has an index and is used in an OR clause or an IN list.\nRunning the following produces the error seen in Derby 10.3.X but not in 10.2.X nor in 10.1.X.Don't know if this related to DERBY-3231.First query is incorrectly sorted whereas the second one is okay when there is an index on the table. If the table is not indexed  the sort works correctly in DESC order.------create table CHEESE ( CHEESE_CODE VARCHAR(5)  CHEESE_NAME VARCHAR(20)  CHEESE_COST DECIMAL(7 4));create index cheese_index on CHEESE (CHEESE_CODE DESC  CHEESE_NAME DESC  CHEESE_COST DESC);INSERT INTO CHEESE ( CHEESE_CODE  CHEESE_NAME  CHEESE_COST)VALUES ('00000'  'GOUDA'  001.1234)  ('00000'  'EDAM'  002.1111)  ('54321'  'EDAM'  008.5646)  ('12345'  'GORGONZOLA'  888.2309)  ('AAAAA'  'EDAM'  999.8888)  ('54321'  'MUENSTER'  077.9545);SELECT * FROM CHEESE WHERE (CHEESE_CODE='00000' OR CHEESE_CODE='54321') AND CHEESE_NAME='EDAM'ORDER BY CHEESE_CODE DESC  CHEESE_NAME DESC  CHEESE_COST DESC;SELECT * FROM CHEESE WHERE (CHEESE_CODE='AAAAA' OR CHEESE_CODE='54321') AND CHEESE_NAME='EDAM'ORDER BY CHEESE_CODE DESC  CHEESE_NAME DESC  CHEESE_COST DESC;", "id": "3279"}, "3299": {"ground_truth": "0", "bug_report": "Uniqueness violation error (23505) occurs after dropping a PK constraint if there exists a foreign key on the same columns.\nWhen there are multiple constraints on a single table and the constraints have the same set of columns (in the same order)  Derby tries to optimize things by re-using a single backing index for all of the relevant constraints. See the 'executeConstantAction()' method of CreateIndexConstantAction.java (search for 'duplicate').But there is a bug in Derby where  if one of the constraints is unique and is dropped  the uniqueness 'attribute' of the backing index is not updated accordingly. This means that uniqueness may be incorrectly enforced where it is not required.Take the following example ('Case 2' from DERBY-2204): ALTER TABLE NEWORDERS ADD CONSTRAINT NEWORDERS_PK PRIMARY KEY(NO_W_ID  NO_D_ID  NO_O_ID); ALTER TABLE NEWORDERS ADD CONSTRAINT NO_O_FK FOREIGN KEY (NO_W_ID  NO_D_ID  NO_O_ID) REFERENCES ORDERS;For these statements Derby will use a single backing index for both the primary constraint NEWORDERS_PK and the foreign key constraint NO_O_FK. That backing index will be unique because the primary key must itself be unique.If later we drop the primary key: ALTER TABLE NEWORDERS DROP CONSTRAINT NEWORDERS_PK;then the backing index needs to be converted from a unique index to a non-unique index (because a foreign key is not inherently unique). But in Derby the uniqueness attribute remains unchanged  so attempts to insert a duplicate (NO_W_ID  NO_D_ID  NO_O_ID) row into NEWORDERS will fail with error 23505  when it should really succeed.I tried this out on 10.1.3.1 and the same behavior occurs there  so marking 'Affects' versions for everything back to that...", "id": "3299"}, "3301": {"ground_truth": "0", "bug_report": "Incorrect result from query with nested EXIST\nDerby returns unexpected results from a query with embedded EXIST clauses. The query SQL is generated by the JPOX jdo implementation and is supposed to return all of the PERSONS and PROJECTS where there is an entry in the join table. This query works as expected when using MySQL.Here's the query:SELECT UNBOUND_E.PERSONID  UNBOUND_P.PROJID FROM applicationidentity0.DEPARTMENTS THIS   applicationidentity0.PERSONS UNBOUND_E   applicationidentity0.PROJECTS UNBOUND_P WHERE EXISTS (  SELECT 1 FROM applicationidentity0.PERSONS THIS_EMPLOYEES_E  WHERE EXISTS (  SELECT 1 FROM applicationidentity0.PROJECT_MEMBER THIS_EMPLOYEES_E_PROJECTS_P  WHERE THIS_EMPLOYEES_E_PROJECTS_P.'MEMBER' = THIS_EMPLOYEES_E.PERSONID  AND THIS_EMPLOYEES_E_PROJECTS_P.'MEMBER' = THIS_EMPLOYEES_E.PERSONID  AND THIS_EMPLOYEES_E.DEPARTMENT = THIS.ID  AND THIS_EMPLOYEES_E.DEPARTMENT = THIS.ID  AND UNBOUND_P.PROJID = THIS_EMPLOYEES_E_PROJECTS_P.PROJID  AND UNBOUND_E.PERSONID = THIS_EMPLOYEES_E.PERSONID)  );PERSONID |PROJID -----------------------3 |1 5 |3 4 |3 2 |1 1 |1 5 rows selectedI'm expecting 7 rows to be returned here  one row for each row in the join table. Here's the schema:CREATE TABLE departments ( ID INTEGER NOT NULL  NAME VARCHAR(32) NOT NULL  EMP_OF_THE_MONTH INTEGER  COMPANYID INTEGER  DISCRIMINATOR VARCHAR(255)  CONSTRAINT DEPTS_COMP_FK FOREIGN KEY (COMPANYID) REFERENCES companies  CONSTRAINT DEPTS_PK PRIMARY KEY (ID));CREATE TABLE persons ( PERSONID INTEGER NOT NULL  FIRSTNAME VARCHAR(32) NOT NULL  LASTNAME VARCHAR(32) NOT NULL  MIDDLENAME VARCHAR(32)  BIRTHDATE TIMESTAMP NOT NULL  ADDRID INTEGER  STREET VARCHAR(64)  CITY VARCHAR(64)  STATE CHAR(2)  ZIPCODE CHAR(5)  COUNTRY VARCHAR(64)  HIREDATE TIMESTAMP  WEEKLYHOURS REAL  DEPARTMENT INTEGER  FUNDINGDEPT INTEGER  MANAGER INTEGER  MENTOR INTEGER  HRADVISOR INTEGER  SALARY REAL  WAGE REAL  DISCRIMINATOR varchar(255) NOT NULL  CONSTRAINT PERS_DEPT_FK FOREIGN KEY (DEPARTMENT) REFERENCES departments  CONSTRAINT PERS_FUNDDEPT_FK FOREIGN KEY (FUNDINGDEPT) REFERENCES departments  CONSTRAINT PERS_MANAGER_FK FOREIGN KEY (MANAGER) REFERENCES persons  CONSTRAINT PERS_MENTOR_FK FOREIGN KEY (MENTOR) REFERENCES persons  CONSTRAINT PERS_HRADVISOR_FK FOREIGN KEY (HRADVISOR) REFERENCES persons  CONSTRAINT EMPS_PK PRIMARY KEY (PERSONID));CREATE TABLE projects ( PROJID INTEGER NOT NULL  NAME VARCHAR(32) NOT NULL  BUDGET DECIMAL(11 2) NOT NULL  DISCRIMINATOR VARCHAR(255)  CONSTRAINT PROJS_PK PRIMARY KEY (PROJID));CREATE TABLE project_member ( PROJID INTEGER REFERENCES projects NOT NULL  MEMBER INTEGER REFERENCES persons NOT NULL);ij&gt; connect 'jdbc:derby:/Users/clr/apache/jdo/trunk/tck2/target/database/derby/jdotckdb';ij&gt; set schema applicationidentity0;0 rows inserted/updated/deletedij&gt; select * from persons;PERSONID |FIRSTNAME |LASTNAME |MIDDLENAME |BIRTHDATE |ADDRID |STREET |CITY |STA&amp;|ZIPC&amp;|COUNTRY |HIREDATE |WEEKLYHOURS |DEPARTMENT |FUNDINGDEPT|MANAGER |MENTOR |HRADVISOR |SALARY |WAGE |DISCRIMINATOR -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------1 |emp1First |emp1Last |emp1Middle |1970-06-09 21:00:00.0 |NULL |NULL |NULL |NULL|NULL |NULL |1998-12-31 21:00:00.0 |40.0 |NULL |NULL |NULL |NULL |NULL |20000.0 |NULL |org.apache.jdo.tck.pc.company.FullTimeEmployee 2 |emp2First |emp2Last |emp2Middle |1975-12-21 21:00:00.0 |NULL |NULL |NULL |NULL|NULL |NULL |2003-06-30 21:00:00.0 |40.0 |NULL |NULL |NULL |NULL |NULL |10000.0 |NULL |org.apache.jdo.tck.pc.company.FullTimeEmployee 3 |emp3First |emp3Last |emp3Middle |1972-09-04 21:00:00.0 |NULL |NULL |NULL |NULL|NULL |NULL |2002-08-14 21:00:00.0 |19.0 |NULL |NULL |NULL |NULL |NULL |NULL |15.0 |org.apache.jdo.tck.pc.company.PartTimeEmployee 4 |emp4First |emp4Last |emp4Middle |1973-09-05 21:00:00.0 |NULL |NULL |NULL |NULL|NULL |NULL |2001-04-14 21:00:00.0 |0.0 |NULL |NULL |NULL |NULL |NULL |NULL |13.0 |org.apache.jdo.tck.pc.company.PartTimeEmployee 5 |emp5First |emp5Last |emp5Middle |1962-07-04 21:00:00.0 |NULL |NULL |NULL |NULL|NULL |NULL |1998-08-14 21:00:00.0 |0.0 |NULL |NULL |NULL |NULL |NULL |45000.0 |NULL |org.apache.jdo.tck.pc.company.FullTimeEmployee 5 rows selectedij&gt; select * from projects;PROJID |NAME |BUDGET |DISCRIMINATOR -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------1 |orange |2500000.99 |org.apache.jdo.tck.pc.company.Project 2 |blue |50000.00 |org.apache.jdo.tck.pc.company.Project 3 |green |2000.99 |org.apache.jdo.tck.pc.company.Project 3 rows selectedij&gt; select * from project_member;PROJID |MEMBER -----------------------2 |3 1 |3 2 |2 3 |5 3 |4 1 |2 1 |1 7 rows selected", "id": "3301"}, "3302": {"ground_truth": "1", "bug_report": "NullPointerException during recovery of database with territory-based collation\nWhen logical undo is performed on a database with territory-based collation  you may get a NullPointerException in SQLChar.getCollationKey() because SQLChar.getLocaleFinder() returns null.This bug was reported on derby-user: http://thread.gmane.org/gmane.comp.apache.db.derby.user/8253", "id": "3302"}, "3303": {"ground_truth": "1", "bug_report": "ArrayIndexOutOfBoundsException at MergeSort.compare\nDerby throws ArrayIndexOutOfBoundsException when I try to execute SQL query shown below.This is a regression  since Derby 10.2.2.0 executes this query without problems.Attached are DDL statements to create DB tables  and database itself (with data).2008-01-08 12:32:34.461 GMT Thread&#91;DRDAConnThread_5 6 derby.daemons&#93; (XID = 1497)  (SESSIONID = 0)  (DATABASE = InventorizacijaDB)  (DRDAID = NF000001.G46A-666250070078662256{1})  Failed Statement is: select MAX(preke0_.BARKODAS) as col_0_0_  MAX(preke0_.PAVADINIMAS) as col_1_0_  MAX(preke0_.KIEKIS) as col_2_0_  SUM(irasas1_.FAKTINIS_KIEKIS) as col_3_0_ from PREKE preke0_  IRASAS irasas1_  IRASU_BLOKAS irasubloka2_ where irasas1_.IRASU_BLOKAS=irasubloka2_.ID and preke0_.UNIKALUS_KODAS=irasas1_.UNIKALUS_KODAS and irasubloka2_.INVENTORIZACIJA=? group by irasas1_.UNIKALUS_KODAS order by abs(SUM(irasas1_.FAKTINIS_KIEKIS)-MAX(preke0_.KIEKIS)) DESC with 1 parameters begin parameter #1: 1 :end parameter java.lang.ArrayIndexOutOfBoundsException: 5 at org.apache.derby.impl.store.access.sort.MergeSort.compare(Unknown Source) at org.apache.derby.impl.store.access.sort.SortBuffer.insert(Unknown Source) at org.apache.derby.impl.store.access.sort.MergeInserter.insert(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.loadSorter(Unknown Source) at org.apache.derby.impl.sql.execute.SortResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.openCore(Unknown Source) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.open(Unknown Source) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(Unknown Source) at org.apache.derby.impl.drda.DRDAStatement.execute(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source) at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)", "id": "3303"}, "3304": {"ground_truth": "0", "bug_report": "Explicit commit inside a java procedure makes a dynamic result sets passed out unavailable\nRepro (Main.java) that shows changed behavior after svn 602991(the patch committed for this issue). It seems a regression: (originally from Dag H. Wanvik attached to DERBY-1585)An explicit commit inside a stored procedure makes a dynamic result sets passed out unavailable  even if the commit is executed prior to the result set; as in the repro.", "id": "3304"}, "3305": {"ground_truth": "0", "bug_report": "Embedded ResultSet.getStatement() returns incorrect reference for dynamic result sets\nResultSets returned as dynamic results sets  ie. those created in a java procedure and returned via the java.sql.Statement that executed the call of the procedure  do not return the correct statement reference for getStatement. Need to return reference to statement that executed the CALL and returned the ResultSet instead of the statement that performed the executeQuery.", "id": "3305"}, "3311": {"ground_truth": "0", "bug_report": "Client ResultSet.getHoldabilty will return incorrect value when the ResultSet is obtained from a procedure call\nFixing DERBY-3305 (aka DERBY-1111) exposes that the holdability for a result set sent over DRDA is being obtained from the Statement that created the JDBC ResultSet  not its actual holdability. The two can be different when the result set is dynamic result set from a procedure.jdbc4.ResultSetTest.getHoldability fails in client mode.", "id": "3311"}, "3316": {"ground_truth": "1", "bug_report": "Leak in client if ResultSet not closed\nIf I run the attached program RepeatStatement.java with 32M of heap I will get an OutOfMemory error in the client.java -Xmx32M RepeatStatementException in thread 'main' java.lang.OutOfMemoryError: Java heap space at org.apache.derby.client.am.Cursor.allocateCharBuffer(Cursor.java:1260) at org.apache.derby.client.net.NetStatementReply.parseSQLDTARDarray(NetStatementReply.java:1356) at org.apache.derby.client.net.NetStatementReply.parseQRYDSC(NetStatementReply.java:1207) at org.apache.derby.client.net.NetStatementReply.parseOpenQuery(NetStatementReply.java:479) at org.apache.derby.client.net.NetStatementReply.parseOPNQRYreply(NetStatementReply.java:223) at org.apache.derby.client.net.NetStatementReply.readOpenQuery(NetStatementReply.java:64) at org.apache.derby.client.net.StatementReply.readOpenQuery(StatementReply.java:50) at org.apache.derby.client.net.NetStatement.readOpenQuery_(NetStatement.java:153) at org.apache.derby.client.am.Statement.readOpenQuery(Statement.java:1396) at org.apache.derby.client.am.Statement.flowExecute(Statement.java:2001) at org.apache.derby.client.am.Statement.executeQueryX(Statement.java:421) at org.apache.derby.client.am.Statement.executeQuery(Statement.java:406) at RepeatStatement.testInsertAndSelect(RepeatStatement.java:31) at RepeatStatement.main(RepeatStatement.java:10)If I close the ResultSet or Statement it does not leak. This occurs on trunk and 10.2.1.6. It does however not run out of memory on 10.1.3.1  so appears to be a regression.", "id": "3316"}, "3319": {"ground_truth": "0", "bug_report": "Logical connections do not check if a transaction is active on close\nIf you call close on a logical connection  for instance as obtained through a PooledConnection  it does not check if there is an active transaction.The close of the logical connection is allowed  and even the close of the parent PooledConnection is allowed in the client driver. This can/will cause resources to be left on the server  and later operations might fail (typically with lock timeouts because the 'closed' transaction is still holding locks).I do not know if gc will solve this eventually  but I would say the current behavior of the client driver is wrong in any case.There is difference in the behavior between the embedded and the client driver  and there also seems to be a bug in the embedded driver.The analysis above is a bit sketchy  so it might be required to look into the issue a bit more...I will attach a repro (JDBC usage should be verified as well  is it legal / as intended?)", "id": "3319"}, "3320": {"ground_truth": "0", "bug_report": "Database creation and boot should fail if collation=TERRITORY_BASED and the selected locale is not supported\nA problem I've discovered when testing with the phoneME advanced platform is that the collationtests expect other locales than Locale.US to be available on the platform that is used for the test  and for phoneME advanced (when compiled as foundation profile) only Locale.US is available. From the jdk1.6 javadoc of Collator.getAvailableLocales() I see that only Locale.US is strictly required:public static Locale[] getAvailableLocales() Returns an array of all locales for which the getInstance methods of this class can return localized instances. The returned array represents the union of locales supported by the Java runtime and by installed CollatorProvider implementations. It must contain at least a Locale instance equal to Locale.US. Returns: An array of locales for which localized Collator instances are available.This led me to thinking about how Derby should behave if created/booted with collation=TERRITORY_BASED and territory=&lt;some unsupported locale&gt;. I'm not sure what the consequences could be if the database is first created on a platform that supports whatever locale is set and later booted with one that doesn't  or created on a platform missing support and later booted with one that has. In any case I think it may confuse a user needlessly to see the database boot successfully with his collation setting and later behave in a way he does not expect.Opinions voiced on the derby-dev list are that both database creation and boot should fail if collation=TERRITORY_BASED and the selected locale is not supported.If a change like this is implemented  the collationtests should be changed to verify correct behavior also if they are executed in an environment were some of the tested locales are not supported.", "id": "3320"}, "3330": {"ground_truth": "0", "bug_report": "provide support for unique constraint over keys that include one or more nullable columns.\nAllow unique constraint over keys which include one or more nullable fields. Prior to this change Derby only supported unique constraints on keys that included no nullable columns. The new constraint will allow unlimited inserts of any key with one more null columns  but will limit insert of keys with no null columns to 1 unique value per table.There is no change to existing or newly created unique indexes on null columns (as opposed to unique constraints on null columns). Also there is no change to existing or newly created constraints on keys with no nullable columns.", "id": "3330"}, "3336": {"ground_truth": "1", "bug_report": "jdbcapi/derbyStress.java no longer runs with low memory heap so does not provide testing for leak scenarios\nThis was raised as an issue in DERBY-3316  but it seems to make most sense to raise it as a separate issue. When derbyStress ran in derbyall it ran with 64MB heap so that it could test fixes for various memory leaks. When moved to JDBCHarnessJavaTest it started running with the full 512MB heap used for suites.All so no longer tests for those leaks. There are two options presented so far1) Move it back to derbyall 2) add it to the junit-all target For the adding it to the junit-all target option I think a few things have to happen for it to be run as part of the nightlies. 1) Convert derbyStress.java to junit. 2) create a junit-lomem target and make it part of junit-all. 3) Fix junit-all so that it can run with the nightlies. DERBY-2045 + distribute ant to the testing machines make nightly script changes etc.Myrna expressed some misgivings to relying on junit-all because ant is not available on all the platforms where she tests. I think the best course of action is to at least temporarily move the test back to derbyall and then open separate task(s) for the junit conversion effort.", "id": "3336"}, "3349": {"ground_truth": "0", "bug_report": "Nested WHERE EXISTS queries need improved testing\nDERBY-3301 reported an error in subquery flattening of nested WHERE EXISTS clauses  or WHERE EXISTS subqueries. The query returned the wrong number of rows. There is currently some tests for WHERE EXISTS  but none for nested WHERE EXISTS clauses.See DERBY-3301 for a full sql repro.", "id": "3349"}, "3360": {"ground_truth": "1", "bug_report": "Invalid method java.lang.Integer >> void (short) because java.lang.NoSuchMethodException: java.lang.Integer.(short)\nInvalid method java.lang.Integer &gt;&gt; void &lt;init&gt;(short) because java.lang.NoSuchMethodException: java.lang.Integer.&lt;init&gt;(short)True  but I believe  not a helpful observation FN_MATCHES(A.f  C.d) returns short/SMALLINTrelated to DERBY-3310 ? But this is on the 10.3 branch &#91;10.3.2.2 - (616244M)&#93;DEBUG 68421 &#91;Main&#93; (Template.java:69) - SQL: SELECT A.a  D.b  B.c  C.d FROM C JOIN A ON C.e = 'I' AND A.f IS NOT NULL AND A.g = C.g AND FN_MATCHES(A.f  C.d) &lt;&gt; 1 JOIN B ON B.h = A.g JOIN D ON D.h = URID.hjava.lang.NoSuchMethodException: java.lang.Integer.&lt;init&gt;(short) at java.lang.Class.getConstructor0(Class.java:2706) at java.lang.Class.getConstructor(Class.java:1657) at org.apache.derby.impl.services.bytecode.d_BCValidate.checkMethod(d_BCValidate.java:115) at org.apache.derby.impl.services.bytecode.BCMethod.callMethod(BCMethod.java:745) at org.apache.derby.impl.services.bytecode.BCMethod.pushNewComplete(BCMethod.java:779) at org.apache.derby.impl.sql.compile.StaticMethodCallNode.generateExpression(StaticMethodCallNode.java:995) at org.apache.derby.impl.sql.compile.JavaToSQLValueNode.generateExpression(JavaToSQLValueNode.java:167) at org.apache.derby.impl.sql.compile.BinaryOperatorNode.generateExpression(BinaryOperatorNode.java:599) at org.apache.derby.impl.sql.compile.BinaryLogicalOperatorNode.generateExpression(BinaryLogicalOperatorNode.java:157) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(ProjectRestrictNode.java:1484) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(ProjectRestrictNode.java:1302) at org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1579) at org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555) at org.apache.derby.impl.sql.compile.JoinNode.generate(JoinNode.java:1479) at org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1577) at org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555) at org.apache.derby.impl.sql.compile.JoinNode.generate(JoinNode.java:1479) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(ProjectRestrictNode.java:1440) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(ProjectRestrictNode.java:1302) at org.apache.derby.impl.sql.compile.ScrollInsensitiveResultSetNode.generate(ScrollInsensitiveResultSetNode.java:109) at org.apache.derby.impl.sql.compile.CursorNode.generate(CursorNode.java:564) at org.apache.derby.impl.sql.compile.StatementNode.generate(StatementNode.java:347) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:447) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:746) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&lt;init&gt;(EmbedPreparedStatement.java:129) at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&lt;init&gt;(EmbedPreparedStatement20.java:82) at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&lt;init&gt;(EmbedPreparedStatement30.java:63) at org.apache.derby.impl.jdbc.EmbedPreparedStatement40.&lt;init&gt;(EmbedPreparedStatement40.java:40) at org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Driver40.java:105) at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:923) at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:751) &#91;..&#93; at org.apache.derby.exe.ac12564092x0117xc525x43e4xffffbce342b018.g0(Unknown Source) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.apache.derby.impl.services.reflect.ReflectMethod.invoke(ReflectMethod.java:46) at org.apache.derby.impl.sql.execute.CallStatementResultSet.open(CallStatementResultSet.java:74) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:101) at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:745) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:538) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:739) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:797) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:801) at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.update(NamedParameterJdbcTemplate.java:218)Invalid method java.lang.Integer &gt;&gt; void &lt;init&gt;(short) because java.lang.NoSuchMethodException: java.lang.Integer.&lt;init&gt;(short)DEBUG 70472 &#91;Main&#93; (Template.java:120) - java.sql.SQLException: Java exception: 'ASSERT FAILED Invalid method java.lang.Integer &gt;&gt; void &lt;init&gt;(short) because java.lang.NoSuchMethodException: java.lang.Integer.&lt;init&gt;(short): org.apache.derby.shared.common.sanity.AssertFailure'.ERROR 70500 &#91;Main&#93; (TransactionTemplate.java:163) - Application exception overridden by rollback exceptionorg.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [ &lt;Statement that fires trigger removed&gt; ]; SQL state &#91;XJ001&#93;; error code &#91;0&#93;; Java exception: ': java.lang.NullPointerException'.; nested exception is java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.Caused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:245) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1573) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1294) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:101) at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:745) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:538) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:739) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:797) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:801) at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.update(NamedParameterJdbcTemplate.java:218)Caused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:135) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70) ... 29 moreCaused by: java.lang.NullPointerException at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:217) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) ... 22 moreFATAL 70508 &#91;Main&#93; (Start.java:153) - Start FAILEDorg.springframework.transaction.TransactionSystemException: Could not roll back JDBC transaction; nested exception is java.sql.SQLNonTransientConnectionException: No current connection.Caused by: java.sql.SQLNonTransientConnectionException: No current connection. at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:76) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:104) at org.apache.derby.impl.jdbc.Util.noCurrentConnection(Util.java:208) at org.apache.derby.impl.jdbc.EmbedConnection.checkIfClosed(EmbedConnection.java:1548) at org.apache.derby.impl.jdbc.EmbedConnection.setupContextStack(EmbedConnection.java:1759) at org.apache.derby.impl.jdbc.EmbedConnection.rollback(EmbedConnection.java:1142) at org.apache.commons.dbcp.DelegatingConnection.rollback(DelegatingConnection.java:265) at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.rollback(PoolingDataSource.java:288) at org.springframework.jdbc.datasource.DataSourceTransactionManager.doRollback(DataSourceTransactionManager.java:259) at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:742) at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:719) at org.springframework.transaction.support.TransactionTemplate.rollbackOnException(TransactionTemplate.java:160) at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:138) Caused by: java.sql.SQLException: No current connection. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:135) at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70) ... 21 morederby.logorg.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED Invalid method java.lang.Integer &gt;&gt; void &lt;init&gt;(short) because java.lang.NoSuchMethodException: java.lang.Integer.&lt;init&gt;(short) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162) at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147) at org.apache.derby.impl.services.bytecode.d_BCValidate.checkMethod(d_BCValidate.java:190) at org.apache.derby.impl.services.bytecode.BCMethod.callMethod(BCMethod.java:745) at org.apache.derby.impl.services.bytecode.BCMethod.pushNewComplete(BCMethod.java:779) at org.apache.derby.impl.sql.compile.StaticMethodCallNode.generateExpression(StaticMethodCallNode.java:995) at org.apache.derby.impl.sql.compile.JavaToSQLValueNode.generateExpression(JavaToSQLValueNode.java:167) at org.apache.derby.impl.sql.compile.BinaryOperatorNode.generateExpression(BinaryOperatorNode.java:599) at org.apache.derby.impl.sql.compile.BinaryLogicalOperatorNode.generateExpression(BinaryLogicalOperatorNode.java:157) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(ProjectRestrictNode.java:1484) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(ProjectRestrictNode.java:1302) at org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1579) at org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555) at org.apache.derby.impl.sql.compile.JoinNode.generate(JoinNode.java:1479) at org.apache.derby.impl.sql.compile.JoinNode.getJoinArguments(JoinNode.java:1577) at org.apache.derby.impl.sql.compile.JoinNode.generateCore(JoinNode.java:1555) at org.apache.derby.impl.sql.compile.JoinNode.generate(JoinNode.java:1479) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generateMinion(ProjectRestrictNode.java:1440) at org.apache.derby.impl.sql.compile.ProjectRestrictNode.generate(ProjectRestrictNode.java:1302) at org.apache.derby.impl.sql.compile.ScrollInsensitiveResultSetNode.generate(ScrollInsensitiveResultSetNode.java:109) at org.apache.derby.impl.sql.compile.CursorNode.generate(CursorNode.java:564) at org.apache.derby.impl.sql.compile.StatementNode.generate(StatementNode.java:347) at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:447) at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88) at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:746) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&lt;init&gt;(EmbedPreparedStatement.java:129) at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&lt;init&gt;(EmbedPreparedStatement20.java:82) at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&lt;init&gt;(EmbedPreparedStatement30.java:63) at org.apache.derby.impl.jdbc.EmbedPreparedStatement40.&lt;init&gt;(EmbedPreparedStatement40.java:40) at org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Driver40.java:105) at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:923) at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:751)&#91;our trigger stored proc java code&#93; at org.apache.derby.exe.ac12564092x0117xc525x43e4xffffbce342b018.g0(Unknown Source) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.apache.derby.impl.services.reflect.ReflectMethod.invoke(ReflectMethod.java:46) at org.apache.derby.impl.sql.execute.CallStatementResultSet.open(CallStatementResultSet.java:74) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:101) at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:745) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:538) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:739) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:797) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:801) at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.update(NamedParameterJdbcTemplate.java:218)Cleanup action completed2008-01-29 10:44:58.980 GMT Thread&#91;Main 5 main&#93; Cleanup action startingjava.lang.NullPointerException at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:217) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.sql.execute.GenericTriggerExecutor.executeSPS(GenericTriggerExecutor.java:173) at org.apache.derby.impl.sql.execute.StatementTriggerExecutor.fireTrigger(StatementTriggerExecutor.java:80) at org.apache.derby.impl.sql.execute.TriggerEventActivator.notifyEvent(TriggerEventActivator.java:278) at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1163) at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:497) at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:370) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1203) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:101) at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:745) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:538) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:739) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:797) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:801) at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.update(NamedParameterJdbcTemplate.java:218)2008-01-29 10:44:58.987 GMT Thread&#91;Main 5 main&#93; Equally severe exception raised during cleanup (ignored) nulljava.lang.NullPointerException at org.apache.derby.impl.sql.compile.CompilerContextImpl.initRequiredPriv(CompilerContextImpl.java:698) at org.apache.derby.impl.sql.compile.CompilerContextImpl.resetContext(CompilerContextImpl.java:158) at org.apache.derby.impl.sql.compile.CompilerContextImpl.cleanupOnError(CompilerContextImpl.java:107) at org.apache.derby.iapi.services.context.ContextManager.cleanupOnError(ContextManager.java:327) at org.apache.derby.impl.jdbc.TransactionResourceImpl.cleanupOnError(TransactionResourceImpl.java:419) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:337) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1573) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1294) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1652) at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:299) at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:101) at org.springframework.jdbc.core.JdbcTemplate$2.doInPreparedStatement(JdbcTemplate.java:745) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:538) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:739) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:797) at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:801) at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.update(NamedParameterJdbcTemplate.java:218)Cleanup action completed", "id": "3360"}, "3364": {"ground_truth": "0", "bug_report": "Replication failover implementation must be modified to fail at the master after slave has been stopped\nJorgen says...I tried to run the failover command on the master  which seems to work fine as long as the master and slave are still connected. If the slave has been stopped for some reason  however  failover hangs on MasterController#startFailover here: ack = transmitter.readMessage();", "id": "3364"}, "3366": {"ground_truth": "0", "bug_report": "Various formatting erros in L10N property files\nThere are a number of formatting errors in the localization property files: DRDA_InvalidValue.U appears twice in the drda property files (english and translations) Spurious linefeed for XCL21.S in messages_zh_TW.properties Quadruple single quote rather than double single quote for contraction apostrophes in messages_it.properties", "id": "3366"}, "3372": {"ground_truth": "0", "bug_report": "Adjust demos build.xml to avoid re-compiling SimpleApp and SimpleMobileApp\nI propose to adjust the java/demo/build.xml file to change the 'srcdir' and 'includes'values on the javac task that compiles SimpleApp.java and SimpleMobileApp.java.Since these two Java programs are not inside of a package  Ant is happiest ifwe specify their srcdir directories directly  see:http://ant.apache.org/faq.html#always-recompiles The change to java/demo/build.xml will beIndex: java/demo/build.xml===================================================================&#8212; java/demo/build.xml (revision 616784)+++ java/demo/build.xml (working copy)@@ -86 9 +86 8 @@ optimize='${optimize}' proceed='${proceed}' verbose='${verbose}' srcdir='${derby.demo.src.dir}'- destdir='${out.dir}'- includes='simple/* simplemobile/*'&gt;+ srcdir='${derby.demo.src.dir}/simple:${derby.demo.src.dir}/simplemobile'+ destdir='${out.dir}'&gt; &lt;classpath&gt; &lt;pathelement location='${javasrc.dir};${jcc}'/&gt; &lt;pathelement path='${java14compile.classpath};${jcc}'/&gt;", "id": "3372"}, "3376": {"ground_truth": "0", "bug_report": "Test case in GrantRevokeDDLTest looks to be accidentally commented out...\nIn lang/GrantRevokeDDLTest.java  beginning at line 8057 (at time of writing)  there looks to be a test case that was inadvertently commented out: // set connection user1 //ij(USER3)&gt; &#8211; test multiple FKs DERBY-1589?set // connection user1drop table user3.rt3drop table // user2.rt2drop table user1.rt1create table rt1 (c1 int // primary key not null  c2 int)insert into rt1 values // (1 1)  (2 2)grant references on rt1 to PUBLIC  user2  // user3set connection user2 XJ001 occurred at create table // rt2...create table rt2 (c1 int primary key not null  // constraint rt2fk foreign key(c1) references // user1.rt1)insert into rt2 values (1)  (2)grant // references on rt2 to PUBLIC  user3set connection // user3create table rt3 (c1 int primary key not null  // constraint rt3fk1 foreign key(c1) references // user1.rt1  constraint rt3fk2 foreign key(c1) references // user1.rt2)insert into rt3 values (1)  (2)set connection // user1 rt3fk1 should get dropped.revoke references on rt1 // from PUBLICrevoke references on rt1 from user3set // connection user2revoke references on rt2 from PUBLIC // expect errorinsert into rt2 values (3)set connection // user3 expect error  use user3 references privilege  // rt3fk2 still in effectinsert into rt3 values (3)set // connection user2revoke references on rt2 from user3set // connection user3 ok  rt3fk2 should be dropped.insert // into rt3 values (3)Based on the format of the comment  my guess is that this JUnit test was created using the conversion script attached to DERBY-2151  and that the script somehow messed up the conversion.The first line of the comment mentions DERBY-1589  but a) there is a question mark after it  and b) the commit for that issue does not appear to include the aforementioned lines.If the test case is supposed to be commented out  then some explanatory comments explaining why might be nice...", "id": "3376"}, "3382": {"ground_truth": "0", "bug_report": "Replication: Slave must inform master if DBs are out of sync.\nIf I copy the database to the slave before booting the master  slave will be out of sync with the master since new log records are created during booting. The slave will then stop replication  but the master will not be notified.If I then try to stop or failover the master the master will hang.", "id": "3382"}, "3420": {"ground_truth": "0", "bug_report": "The -ca option should be removed from ij and from the ij command usage line\nThe ij tool gives the following help output:Usage: java org.apache.derby.tools.ij &#91;-p propertyfile&#93; &#91;-ca connectionAttributePropertyFile&#93; &#91;inputfile&#93;The -ca connectionAttributePropertyFile option is no longer needed and is deprecated  so it is not documented in the Tools Guide. The option should also be removed from the usage statement.", "id": "3420"}, "3430": {"ground_truth": "0", "bug_report": "Inconsistency in JDBC autogen APIs between Connection.prepareStatement(...) and Statement.execute(...)\nIn EmbedStatement.java the execute(String  String[])  execute(String  int[])  executeUpdate(String  String[])  and executeUpdate(String  int[]) methods treat a 0-length array to mean NO_GENERATED_KEYS. But in EmbedConnection.java the prepareStatement(String  String[]) and prepareStatement(String  int[]) methods treat a 0-length array to mean RETURN_GENERATED_KEYS. For the sake of consistency  the two classes should treat 0-length arrays in the same way--which probably means changing EmbedConnection to match EmbedStatement.", "id": "3430"}, "3431": {"ground_truth": "0", "bug_report": "DatabaseMetaData.getConnection returns the wrong connection when using connection pooling\nThe connection returned from DatabaseMetaData.getConnection is not the same as the connection used to create the meta data object when the client driver is used with connection pooling enabled.For trunk  the embedded driver/ds does the right thing.", "id": "3431"}, "3433": {"ground_truth": "0", "bug_report": "Register a network port for replication\nRegister a network port at IANA which will be the default port for Derby Replication.", "id": "3433"}, "3438": {"ground_truth": "0", "bug_report": "Allow SQL query text to be null in StatementKey\nBecause the SQL isn't checked before the cache is queried  StatementKey should allow the SQL query text to be null.This simplifies handling this exceptional situations  hopefully without complications.What will happen is  the cache is queried  null is returned (no match) and then prepare will fail in the driver. Because the statement is never prepared  it will never be inserted into the cached  nor (incorrectly) fetched from the cache in the first step.Of course  one could also explicitly check for null in either the Logical(Prepared|Callable)Statement&#91;40&#93;  StatementKeyFactory or StatementCacheInteractor.However  the proposed change is small  isolated to one class and makes the exceptional case be handled by the normal code path.", "id": "3438"}, "3455": {"ground_truth": "0", "bug_report": "Move replication methods from org.apache.derby.database.Database to org.apache.derby.iapi.db.Database\nMove replication methods from org.apache.derby.database.Database to org.apache.derby.iapi.db.Database", "id": "3455"}, "3478": {"ground_truth": "0", "bug_report": "Simple column names specified as part of 'AS' clause in a table expression are ignored if the table expression is a view.\nSimple repro as follows:create table t1 (i int  j int);insert into t1 values (1  1)  (1  -1)  (2  2)  (3  -3)  (4  4);create view v1 as select j  i from t1;create view v2 (x y z) as select j  i  i+j from t1;&#8211; OK: Returns column names specified in AS clause.select * from t1 as x(a b);&#8211; OK: Returns column names for the viewsselect * from v1;select * from v2;&#8211; WRONG: Ignores column names specified in AS clause for the views.select * from v1 x(a b);select * from v2 as x(a b c);I observed this as far back as 10.0.2.1  so this is not a regression.", "id": "3478"}, "3479": {"ground_truth": "0", "bug_report": "Changed/unexpected query plan when running test 'lang/predicatePushdown.sql'\nSeen in tinderbox since r631930.See e.g. http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/631932-derbyall_diff.txt :     Start: predicatePushdown jdk1.6.0_04 derbyall:derbylang 2008-02-28 14:02:49 ***9285 del&lt; Rows seen from the left = 209285a9285&gt; Rows seen from the left = 109297 del&lt; Rows seen from the right = 209297a9297&gt; Rows seen from the right = 109299 del&lt; Rows returned = 209299a9299&gt; Rows returned = 10...", "id": "3479"}, "3489": {"ground_truth": "0", "bug_report": "Error message XRE04 does not include the right port number.\nIf the master is not able to connect to the slave  the error messages does not include the right port number:ij&gt; connect 'jdbc:derby:masterDB;user=oystein;password=pass;startMaster=true;slaveHost=localhost;slavePort=9901';ERROR XRE04: Could not establish a connection to the peer of the replicated database 'masterDB' on address 'localhost:-1'.", "id": "3489"}, "3492": {"ground_truth": "0", "bug_report": "When the replication log buffer becomes full  the chunk of log that should be appended is to the buffer is discarded\nIn MasterController#appendLog  log is force-sent to the slave if the replication log buffer becomes full. However  the log chunk that should have been appended is discarded:try { logBuffer.appendLog(greatestInstant  log  logOffset  logLength);} catch (LogBufferFullException lbfe) { try { logShipper.forceFlush(); } catch (IOException ioe) {...}The log chunk must be added after freeing a log buffer by calling forceFlush", "id": "3492"}, "3494": {"ground_truth": "0", "bug_report": "Move the setup of NormalizeResultSetNode into the NormalizeResultSetNode\nIn DERBY-3310 Dan suggested ...Setting up a NormalizeResultSetNode is spread over three locations  the class itself (very little  it's almost acting like a C struct) the genNormalizeResultSetNode method and then copyLengthsAndTypesToSource. A good O-O implementation would havethe logic to create a NormalizeResultSetNode self-contained in NormalizeResultSetNode.Since the ResultColumnList of the original ResultSetNode correctly describes the desired outcome  it's not clear tome why NormalizeResultSetNode can't just refer to the same list and use it for its processing. They may be some chancethat this would cause recursion at some point  where a NormalizeResultSetNode would think it needed to be wrappedin a NormalizeResultSetNode since the types of its columns and expression don't match (i.e. when it is handled as a regular ResultSetNode).I think moving the setup of a NormalizeResultSetNode into the class itself  so that its inputs are just the ResultSetNode to wrapwould help clear up the code  especially if comments were added indicating why certain actions were being taken.I am separating this task out into a separate issue  so that it can be worked on independently of DERBY-3310.", "id": "3494"}, "3496": {"ground_truth": "0", "bug_report": "CallableStatement with output parameter leaves cursor open after execution\nWhen executing a CallableStatement which has an output parameter  the language result set is left open and makes subsequent calls to Connection.setTransactionIsolation() fail with 'ERROR X0X03: Invalid transaction state - held cursor requires same isolation level'.", "id": "3496"}, "3497": {"ground_truth": "1", "bug_report": "OOME at slave during replication\nAfter deleting and inserting more than 1 million records during replication  I got java.lang.OutOfMemoryError: Java heap space.The heap dump shows that almost the entire heap is byte arrays  and it seems most of them are referred to by ReplicationMessage objects. An inspection of the heap dump in VisualVM it seems that it is references rooted in SocketConnection#objInputStream that keeps them from being garbage collected.", "id": "3497"}, "3507": {"ground_truth": "0", "bug_report": "startNetworkServer and stopNetworkServer don't pass arguments\nThe help scripts $DERBY_HOME/bin/startNetworkServer and $DERBY_HOME/bin/stopNetworkServer don't pass arguments (as '-h' or '-p') to class org.apache.derby.drda.NetworkServerControl.Solution: append command line with '$@'before:derby_exec_command='exec /'$JAVACMD/' $DERBY_OPTS -classpath /'$LOCALCLASSPATH/' org.apache.derby.drda.NetworkServerControl start'after:derby_exec_command='exec /'$JAVACMD/' $DERBY_OPTS -classpath /'$LOCALCLASSPATH/' org.apache.derby.drda.NetworkServerControl start $@'", "id": "3507"}, "3509": {"ground_truth": "0", "bug_report": "The replication log shipper is not notified when a new replication transmitter is instantiated in MC#handleException.\nIn MasterController#handleException  a new ReplicationMessageTransmit object is created if the exception is IOException. However  the logShipper is not notified that the new transmitter should be used. A possible solution would be to add a setTransmitter method to AsynchronousLogShipper. Note that the logShipper may contain state information that cannot be discarded  so it cannot be reinstantiated.", "id": "3509"}, "3536": {"ground_truth": "0", "bug_report": "specialCollation() and noSpecialCollation() in TableFunctionTest fail with weme6.1.\nThe 'specialCollation()' and 'noSpecialCollation()' fixtures in TableFunctionTest fail when run with weme6.1. I have not explicitly confirmed but it looks like this may be related to svn # 636004. The stack trace is:noSpecialCollation(o.a.dTesting.functionTests.tests.lang.TableFunctionTest)java.sql.SQLException: An attempt was made to get a data value of type 'java.lang.Object' from a data value of type 'DECIMAL'. at o.a.d.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) at o.a.d.impl.jdbc.Util.generateCsSQLException(Unknown Source) at o.a.d.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) at o.a.d.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) at o.a.d.impl.jdbc.EmbedConnection.handleException(Unknown Source) at o.a.d.impl.jdbc.ConnectionChild.handleException(Unknown Source) at o.a.d.impl.jdbc.EmbedResultSet.closeOnTransactionError(Unknown Source) at o.a.d.impl.jdbc.EmbedResultSet.movePosition(Unknown Source) at o.a.d.impl.jdbc.EmbedResultSet.next(Unknown Source) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1935) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1776) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1762) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.allLegalDatatypesVTIResults(TableFunctionTest.java:1178) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.tableFunctionTest(TableFunctionTest.java:921) at o.a.dTesting.functionTests.tests.lang.TableFunctionTest.noSpecialCollation(TableFunctionTest.java:897) at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:205) at o.a.dTesting.junit.BaseTestCase.runBare(BaseTestCase.java:101)Caused by: ERROR 22005: An attempt was made to get a data value of type 'java.lang.Object' from a data value of type 'DECIMAL'. at o.a.d.iapi.error.StandardException.newException(Unknown Source) at o.a.d.iapi.types.DataType.dataTypeConversion(Unknown Source) at o.a.d.iapi.types.DataType.getObject(Unknown Source) at o.a.d.impl.sql.execute.VTIResultSet.cast(Unknown Source) at o.a.d.impl.sql.execute.VTIResultSet.populateFromResultSet(Unknown Source) at o.a.d.impl.sql.execute.VTIResultSet.getNextRowCore(Unknown Source) at o.a.d.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(Unknown Source)Comments from RIck on derby-dev (in response to DERBY-3341 inquiry): 'The handling of DECIMAL on the small device platform is different. The test may need some special logic so that it calls the correct method for the small device environment.'", "id": "3536"}, "3538": {"ground_truth": "1", "bug_report": "NullPointerException during execution for query with LEFT OUTER JOIN whose inner table selects all constants.\nFor a query having a LEFT OUTER JOIN such that the right  or 'inner'  table is a SELECT subquery whose result column list consists entirely of constants  Derby may throw an execution-time NPE while trying to apply the join predicate. I say 'may' because it depends on which join strategy the optimizer chooses.Using optimizer overrides I was able to reproduce this problem against trunk with the following (admittedly nonsense) query: create table t1 (i int  j int); insert into t1 values (-1  -2)  (-2  -4)  (-3  -9); select * from t1 left outer join (select -1 a  1 b from t1) x0 --DERBY-PROPERTIES joinStrategy=NESTEDLOOP on x0.a = t1.i;I |J |A |B------------------------------------------------1 |-2 |-1 |1-1 |-2 |-1 |1-1 |-2 |-1 |1ERROR 38000: The exception 'java.lang.NullPointerException' was thrown while evaluating an expression.ERROR XJ001: Java exception: ': java.lang.NullPointerException'.Running the same query also failed with the same NPE on 10.0.2.1  even though optimizer overrides don't exist there. So I'm marking all known releases to be affected by this issue.Note: while this particular query may not make much sense  I have seen a user with a very large  auto-generated query that  when executed  fails due to this problem. So it is worth investigating...", "id": "3538"}, "3544": {"ground_truth": "0", "bug_report": "If NetworkServer fails to shutdown when run as a separate process by NetworkServerTestSetup  test run will hang\nIf the NetworkServer fails to shutdown for some reason  we do not clean up the process but will just hang the tests. We should kill off the process if the server fails to shutdown and continue. To reproduce try runnning the test derbynet.SecureServerTest with 10.3 derbyTesting.jar and 10.4 jars. See DERBY-3534 for details.", "id": "3544"}, "3549": {"ground_truth": "1", "bug_report": "Unable to start slave mode after authentication failure on a previous startSlave attempt\nTrying a startSlave after an initial startSlave fails due to an authentication failure throws an errorsaying that the database has already been bootedvn@vn-laptop:~/work/workspaces/freshworkspace/slave$ java org.apache.derby.tools.ijij version 10.5ij&gt; connect 'jdbc:derby:mydb;startSlave=true;slaveHost=localhost;slavePort=8001';ERROR 08004: Connection authentication failure occurred. Reason: Invalid authentication..ij&gt; connect 'jdbc:derby:mydb;startSlave=true;user=oystein;password=pass;slaveHost=localhost;slavePort=8001';ERROR XRE09: Cannot start replication slave mode for database 'mydb'. The database has already been booted. ij&gt;", "id": "3549"}, "3554": {"ground_truth": "0", "bug_report": "Change Collation test to run DatabaseMetaDataTest  BatchUpdateTest GroupByExpressionTest  and UpdateableResultSetTest for only one locale\nCurrently CollationTest runs DatabaseMetaDataTest  BatchUpdateTest GroupByExpressionTest  and UpdateableResultSetTest for multiple locales and territory based collation. It would be sufficient for these to run with a single locale and would save some time running tests.", "id": "3554"}, "3558": {"ground_truth": "1", "bug_report": "regression test failure in testDerbyJarAttributeAlpha - Security Exception\nI am getting 41 errors in this test of the following form  all security exceptions from the management test suite. I can post othersif necessary.2) testDerbyJarAttributeAlpha(org.apache.derbyTesting.functionTests.tests.management.VersionMBeanTest)javax.management.RuntimeMBeanException: java.lang.SecurityException: Access denied (org.apache.derby.security.SystemPermission engine monitor) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.rethrow(DefaultMBeanServerInterceptor.java:856) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.rethrowMaybeMBeanException(DefaultMBeanServerInterceptor.java:869) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:670) at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:638) at org.apache.derbyTesting.functionTests.tests.management.MBeanTest$4.run(MBeanTest.java:382) at java.security.AccessController.doPrivileged(AccessController.java:251) at org.apache.derbyTesting.functionTests.tests.management.MBeanTest.getAttribute(MBeanTest.java:379) at org.apache.derbyTesting.functionTests.tests.management.MBeanTest.checkBooleanAttributeValue(MBeanTest.java:431) at org.apache.derbyTesting.functionTests.tests.management.VersionMBeanTest.testDerbyJarAttributeAlpha(VersionMBeanTest.java:120) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:45) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:101) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)Caused by: java.lang.SecurityException: Access denied (org.apache.derby.security.SystemPermission engine monitor) at org.apache.derby.iapi.services.info.Version.checkMonitor(Version.java:70) at org.apache.derby.iapi.services.info.Version.isAlpha(Version.java:121) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:45) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:93) at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:27) at com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:208) at com.sun.jmx.mbeanserver.PerInterface.getAttribute(PerInterface.java:65) at com.sun.jmx.mbeanserver.MBeanSupport.getAttribute(MBeanSupport.java:216) at javax.management.StandardMBean.getAttribute(StandardMBean.java:358) at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:666) ... 40 more", "id": "3558"}, "3566": {"ground_truth": "0", "bug_report": "Alter column set data type not allowed in soft upgrade with unique constraint\nIn 10.3 I can do this:ij&gt; create table t0 (i int not null  v varchar(1) not null  constraint uq unique(v i));0 rows inserted/updated/deletedij&gt; alter table t0 alter v set data type varchar(2);0 rows inserted/updated/deletedij&gt;In 10.4 soft upgrade mode I cannot:ij&gt; create table t0 (i int not null  v varchar(1) not null  constraint uq unique(v i));0 rows inserted/updated/deletedij&gt; alter table t0 alter v set data type varchar(2);ERROR 42Z20: Column 'V' cannot be made nullable. It is part of a primary key or unique constraint  which cannot have anynullable columns.ij&gt;", "id": "3566"}, "3571": {"ground_truth": "1", "bug_report": "LOB locators are not released if the LOB columns are not accessed by the client\nIf the client creates a result set containing LOB locator columns and iterates through it without actually accessing the LOB columns  the locators are not released.The amount of locators and their associated LOB objects causes the server to consume large amounts of memory and it eventually gets an OOME.There are a few workarounds for this bug: a) Access and/or properly close the LOBs (i.e. Blob.free). This is partly dependent on DERBY-2892. b) Invoke Connection.commit (or rollback) periodically  which causes all locators on the connection to be released.", "id": "3571"}, "3580": {"ground_truth": "0", "bug_report": "Remove unused method Connection.resetConnection(LogWriter  String  Properties)\nThe method Connection.resetConnection(LogWriter  String  Properties) in package org.apache.derby.client.am isn't used and can be removed.There is another resetConnection-method that is being used.", "id": "3580"}, "3581": {"ground_truth": "0", "bug_report": "Changing certain properties on client DataSource objects causes existing connections to reflect the new values\nThe client driver has code propagating changes made to the DataSource to existing connections created by that DataSource.There is some discussion of this in the thread http://www.nabble.com/ConnectionPoolDataSource-properties-td15740457.html  and there is also an example of what can happen due to this 'feature'.Besides from being a bug with the potential to cause strange errors in deployment  the issue also makes the client driver code harder to read and understand.As far as I can see  there is also some related code in other parts of the client driver  for instance for 'fully' resetting statements. There is mention of dynamic versus static sections in the comments (this one from am.Statement): // If a dataSource is passed into resetClientConnection()  then we will assume // properties on the dataSource may have changed  and we will need to go through // the open-statement list on the connection and do a full reset on all statements  // including preparedStatement's and callableStatement's. This is because property // change may influence the section we allocate for the preparedStatement  and // also the cursor attributes  i.e. setCursorSensitivity(). // If no dataSource is passed into resetClientConnection()  then we will do the // minimum reset required for preparedStatement's and callableStatement's.Note that the reset code for statements is also invoked when ClientPooledConnection.getConnection() is invoked. I do not understand why we should reset statements when we get a new logical connection.Further  I also suspect the concept of a deferred reset has been introduced because of the feature/bug described by this Jira issue. A deferred reset seems to be a mechanism to avoid a round-trip to validate the newly changed DataSource properties (typically user  password and security mechanism).I will look into removing code related to deferred resets as well. If you have historic information about these parts of the driver  I would appreciate if you share it with the community if possible.Just to be clear  it is my opinion that changed DataSource properties should take effect when one of the following methods is invoked: DataSource.getConnection() ConnectionPoolDataSource.getPooledConnection() XADataSource.getXAConnection()All of the methods above returns a physical connection. Properties like user name and password are associated with the physical connection  and thus requests to obtain a logical connection should not cause any of these properties to change.", "id": "3581"}, "3586": {"ground_truth": "0", "bug_report": "Remove am.Connection.reset(LogWriter,ClientBaseDataSource,boolean) and called methods\nam.Connection.reset(LogWriter,ClientBaseDataSource,boolean) isn't called and can be removed.", "id": "3586"}, "3588": {"ground_truth": "0", "bug_report": "suites.All fails to run on Jvm 1.5 when built with JDK 1.5 (Failed to invoke suite(): .jdbc4._Suite)\nFurther,the following methods are only called from the reset(3):", "id": "3588"}, "3595": {"ground_truth": "0", "bug_report": "TableFunctionTest.SpecialCollation and NoSpecialCollation fail with IBM iseries in checkGetXXXCalls\nabstract Connection.reset_(3) and impl NetConnection.reset_(3)", "id": "3595"}, "3596": {"ground_truth": "0", "bug_report": "Creation of logical connections from a pooled connection causes resource leak on the server\nNetConnection.resetNetConnection(3)", "id": "3596"}, "3603": {"ground_truth": "0", "bug_report": "'IN' clause ignores valid results  incorrect qualifier handling suspected\nAll these methods have cousins taking 4 arguments,which are being used by on one occasion: ClientPooledConnection.getConnection().", "id": "3603"}, "3613": {"ground_truth": "0", "bug_report": "SELECT DISTINCT field FROM TABLE_NAME GROUP BY field   field2\n?\u001f??????????????????", "id": "3613"}, "3616": {"ground_truth": "0", "bug_report": "TableFunctionTest fails under Ubuntu 7.10\nWhen running the test org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest  it fails with the output shown below. This test blocks the proper execution of suites.All and it was tested under Ubuntu 7.10 (also tested on Windows Vista and it doesn't throw an error there).There were 2 errors:1) noSpecialCollation(org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest)java.sql.SQLException: The exception 'java.lang.ClassNotFoundException: ERROR XBM0U: No class was registered for identifier 495.' was thrown while evaluating an expression. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:87) at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:223) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:398) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2125) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4320) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:463) at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:367) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1935) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1776) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1762) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.simpleVTIResults(TableFunctionTest.java:1079) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.tableFunctionTest(TableFunctionTest.java:920) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.noSpecialCollation(TableFunctionTest.java:897) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:103)Caused by: java.sql.SQLException: Java exception: 'ERROR XBM0U: No class was registered for identifier 495.: java.lang.ClassNotFoundException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:87) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:244) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) ... 29 moreCaused by: java.lang.ClassNotFoundException: ERROR XBM0U: No class was registered for identifier 495. at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:129) at org.apache.derby.catalog.types.TypeDescriptorImpl.readExternal(TypeDescriptorImpl.java:491) at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:126) at org.apache.derby.impl.sql.execute.VTIResultSet.thawReturnType(VTIResultSet.java:696) at org.apache.derby.impl.sql.execute.VTIResultSet.getReturnColumnTypes(VTIResultSet.java:670) at org.apache.derby.impl.sql.execute.VTIResultSet.populateFromResultSet(VTIResultSet.java:559) at org.apache.derby.impl.sql.execute.VTIResultSet.getNextRowCore(VTIResultSet.java:347) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:460) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:423) ... 23 more2) specialCollation(org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest)java.sql.SQLException: The exception 'java.lang.ClassNotFoundException: ERROR XBM0U: No class was registered for identifier 495.' was thrown while evaluating an expression. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:87) at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:223) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:398) at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346) at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2125) at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81) at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4320) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:463) at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:367) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1935) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1776) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.assertResults(TableFunctionTest.java:1762) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.simpleVTIResults(TableFunctionTest.java:1079) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.tableFunctionTest(TableFunctionTest.java:920) at org.apache.derbyTesting.functionTests.tests.lang.TableFunctionTest.specialCollation(TableFunctionTest.java:907) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:103) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23) at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57) at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22) at junit.extensions.TestSetup$1.protect(TestSetup.java:19) at junit.extensions.TestSetup.run(TestSetup.java:23)Caused by: java.sql.SQLException: Java exception: 'ERROR XBM0U: No class was registered for identifier 495.: java.lang.ClassNotFoundException'. at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45) at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:87) at org.apache.derby.impl.jdbc.Util.javaException(Util.java:244) at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403) ... 45 moreCaused by: java.lang.ClassNotFoundException: ERROR XBM0U: No class was registered for identifier 495. at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:129) at org.apache.derby.catalog.types.TypeDescriptorImpl.readExternal(TypeDescriptorImpl.java:491) at org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:126) at org.apache.derby.impl.sql.execute.VTIResultSet.thawReturnType(VTIResultSet.java:696) at org.apache.derby.impl.sql.execute.VTIResultSet.getReturnColumnTypes(VTIResultSet.java:670) at org.apache.derby.impl.sql.execute.VTIResultSet.populateFromResultSet(VTIResultSet.java:559) at org.apache.derby.impl.sql.execute.VTIResultSet.getNextRowCore(VTIResultSet.java:347) at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:460) at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:423) ... 39 moreFAILURES!!!Tests run: 2  Failures: 0  Errors: 2", "id": "3616"}, "3624": {"ground_truth": "0", "bug_report": "testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing\nI saw this fail once; a couple of reruns didn't duplicate the problem.The only difference appears to be that one of the deadlock messages is missing from the output.4 del&lt; Got a Deadlock.", "id": "3624"}}}